---
entity_type: Task
entity_id: tsk-022-13
entity_name: 리워드 발송 - 2년 구독권 생성(2건), 1년 구독권 생성(4건)
created: '2026-01-07'
updated: '2026-01-09'
status: done
closed: '2026-01-07'
project_id: prj-002
parent_id: prj-002
assignee: 김은향
priority: medium
start_date: '2026-01-07'
due: '2026-01-07'
pr_url: https://github.com/Eunhyang/sosi-flutter/pull/5
merged_commit: 35e76b982df33baeb5bbb53a76a3fa1f71f635d1
aliases:
- tsk-022-13
tags: []
notes: '총 6명 결제, 그 중 2명은 72시간 안에 결제하신 분들로 1년 구독권 추가로 제공(총 2년 구독권)


  ---


  # 상품 발송 - 2년 구독권 생성(2건), 1년 구독권 생성(4건)


  ## 설명


  ## 체크리스트


  - \[ \]


  ## 참고'
type: dev
---
# 상품 발송 - 2년 구독권 생성(2건), 1년 구독권 생성(4건)

## 설명

RevenueCat 구독권 생성 시스템 개선 - 2년 구독권 지원 및 API 호출 안정성 강화

## 체크리스트

- [x] RevenueCat 2년 구독권 end_time_ms 지원 구현
- [x] API 호출 안정성 개선 (Bearer 토큰, 에러 핸들링)
- [x] PR 생성 및 merge 완료

## 참고

### 작업 로그

#### 2026-01-07
**개요**: Task 완료 - PR merge 완료

**구현 내용**:
- RevenueCat 2년 구독권 end_time_ms 지원 추가
  - RevenueCatPayload 타입 추가 (duration | end_time_ms)
  - convertToDuration() → convertToPayload() 변경
  - 12개월 초과 시 end_time_ms 사용 (정확한 캘린더 기준 만료일)
  - calculateEndTimeMs() 함수 추가 (월말 롤오버 방지 포함)
  - 24개월 구독권이 정확히 2년 후 만료되도록 수정

- RevenueCat API 호출 안정성 개선
  - Authorization 헤더에 Bearer 접두사 자동 추가
  - API 키 미설정 시 success:false 반환 (데이터 불일치 방지)
  - 404 에러 시 success:false 반환 (조용한 실패 방지)

**결과**:
- PR #5 merge 완료 (https://github.com/Eunhyang/sosi-flutter/pull/5)
- Commits: 2개
- Changes: +265 additions, 0 deletions
- Merged at: 2026-01-07T04:42:39Z
- Merged commit: 35e76b982df33baeb5bbb53a76a3fa1f71f635d1

**최종 상태**: done
