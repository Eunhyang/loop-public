---
entity_type: Task
entity_id: "tsk-022-20"
entity_name: "Dashboard v2 - í”„ë¡œì íŠ¸ ì´ˆê¸°í™”"
created: 2026-01-07
updated: 2026-01-07
status: doing

# === ê³„ì¸µ ===
parent_id: "prj-023"
project_id: "prj-023"
aliases: ["tsk-022-20", "Dashboard v2 - í”„ë¡œì íŠ¸ ì´ˆê¸°í™”"]

# === ê´€ê³„ ===
outgoing_relations: []
validates: []
validated_by: []

# === Task ì „ìš© ===
assignee: "ê¹€ì€í–¥"
start_date: 2026-01-07
due: 2026-01-07
priority: high
estimated_hours: 4
actual_hours: null

# === Task ìœ í˜• ===
type: dev
target_project: loop

# === ë¶„ë¥˜ ===
tags: ["dev", "dashboard", "react", "typescript", "setup"]
priority_flag: high
---

# Dashboard v2 - í”„ë¡œì íŠ¸ ì´ˆê¸°í™”

> Task ID: `tsk-022-20` | Project: [[prj-023]] | Status: doing

## ğŸ“Š ì•„í‚¤í…ì²˜ ë„ì‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Dashboard v2 - React+TS í”„ë¡œì íŠ¸ êµ¬ì¡°                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Pages Layer (routes/)                                     â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  /kanban â”€â”€â†’ Kanban Page                                 â”‚   â”‚
â”‚  â”‚  /projects/:id â”€â”€â†’ Project Detail Page                    â”‚   â”‚
â”‚  â”‚  /pending â”€â”€â†’ Pending Review Page                        â”‚   â”‚
â”‚  â”‚  /calendar â”€â”€â†’ Calendar Page (lazy)                       â”‚   â”‚
â”‚  â”‚  /graph â”€â”€â†’ Graph Page (lazy)                            â”‚   â”‚
â”‚  â”‚  /program â”€â”€â†’ Program Admin Page                         â”‚   â”‚
â”‚  â”‚  /login â”€â”€â†’ Login Page                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚       â”‚                                                          â”‚
â”‚       â†“                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Features Layer (features/)                                â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  tasks/ â”€â”€â†’ Task CRUD + components                        â”‚   â”‚
â”‚  â”‚  projects/ â”€â”€â†’ Project CRUD + components                  â”‚   â”‚
â”‚  â”‚  pending/ â”€â”€â†’ Pending review logic                        â”‚   â”‚
â”‚  â”‚  strategy/ â”€â”€â†’ Tracks/Conditions/Hypotheses              â”‚   â”‚
â”‚  â”‚  auth/ â”€â”€â†’ Login/JWT management                           â”‚   â”‚
â”‚  â”‚  attachments/ â”€â”€â†’ File upload/preview                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚       â”‚                                                          â”‚
â”‚       â†“                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Data Layer (queries/ + services/)                         â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  queries/                                                 â”‚   â”‚
â”‚  â”‚    â”œâ”€â”€ keys.ts (queryKey ìƒìˆ˜)                            â”‚   â”‚
â”‚  â”‚    â”œâ”€â”€ useDashboardInit.ts â”€â”€â†’ React Query hook          â”‚   â”‚
â”‚  â”‚    â”œâ”€â”€ useTasks.ts                                        â”‚   â”‚
â”‚  â”‚    â””â”€â”€ useProjects.ts                                     â”‚   â”‚
â”‚  â”‚        â”‚                                                   â”‚   â”‚
â”‚  â”‚        â†“                                                   â”‚   â”‚
â”‚  â”‚  services/                                                â”‚   â”‚
â”‚  â”‚    â”œâ”€â”€ http.ts (baseURL, auth, error handling)           â”‚   â”‚
â”‚  â”‚    â””â”€â”€ api.ts (endpoint functions)                        â”‚   â”‚
â”‚  â”‚            â”‚                                               â”‚   â”‚
â”‚  â”‚            â†“                                               â”‚   â”‚
â”‚  â”‚      /api/dashboard-init                                  â”‚   â”‚
â”‚  â”‚      /api/tasks, /api/projects, /api/pending             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚       â”‚                                                          â”‚
â”‚       â†“                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ UI Components (components/)                               â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  layout/ â”€â”€â†’ Sidebar, Header, Shell                       â”‚   â”‚
â”‚  â”‚  ui/ â”€â”€â†’ Button, Modal, Select, Badge (ìˆœìˆ˜ ì»´í¬ë„ŒíŠ¸)     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ í”„ë¡œì íŠ¸ ì»¨í…ìŠ¤íŠ¸

### í˜„ì¬ ë¬¸ì œì  (v1)
- **ìœ„ì¹˜**: `public/_dashboard/`
- **ê¸°ìˆ **: ë°”ë‹ë¼ HTML + JS (47KB index.html, 35KB state.js)
- **ë¬¸ì œ**:
  - í•œ í˜ì´ì§€ì— ëª¨ë“  ê¸°ëŠ¥ í˜¼ì¬ (Kanban+Calendar+Graph+Pending+Admin)
  - state.js í­ë°œ (ì„œë²„ ë°ì´í„°+ì •ê·œí™”+UI ìƒíƒœ+ë Œë” ëª¨ë‘ ì„ì„)
  - pending-panel.js 82KB, task-panel.js 59KB ë¹„ëŒ€í™”
  - ì´ˆê¸° ë¡œë”© 62ì´ˆ (cold cache)

### ëª©í‘œ (v2)
- **ìœ„ì¹˜**: `public/dashboard-v2/` (ìƒˆ í´ë”, ê¸°ì¡´ê³¼ ë³‘í–‰ ìš´ì˜)
- **ê¸°ìˆ **: React + TypeScript + Vite
- **ì² í•™**:
  - **ì„œë²„ ìƒíƒœ**: React Query (ìºì‹œ)
  - **ì •ê·œí™”**: utils/ (ìˆœìˆ˜ í•¨ìˆ˜)
  - **UI ìƒíƒœ**: í˜ì´ì§€ local state ë˜ëŠ” URL params
  - **í˜ì´ì§€ ê²½ê³„**: ë¼ìš°íŠ¸ë¡œ ëª…í™•íˆ ë¶„ë¦¬

---

## ğŸ¯ êµ¬í˜„ ë²”ìœ„

### ì£¼ìš” ê¸°ëŠ¥
1. âœ… Vite + React + TypeScript í”„ë¡œì íŠ¸ ìŠ¤ìºí´ë“œ
2. âœ… React Router ì„¤ì • (7ê°œ ë¼ìš°íŠ¸)
3. âœ… React Query ì„¤ì • (ì„œë²„ ìƒíƒœ ê´€ë¦¬)
4. âœ… í´ë” êµ¬ì¡° ìƒì„± (features/ + queries/ + types/)
5. âœ… API í´ë¼ì´ì–¸íŠ¸ ê¸°ë³¸ ì„¤ì • (services/http.ts + api.ts)
6. âœ… ê³µí†µ ì»´í¬ë„ŒíŠ¸ ê¸°ì´ˆ (Layout, Button, Modal)
7. âœ… ê¸°ì¡´ _dashboard/ì™€ ê³µì¡´ ê°€ëŠ¥í•œ ë¹Œë“œ ì„¤ì •

### ê¶Œì¥ í´ë” êµ¬ì¡° (v2)

```
public/dashboard-v2/
â”œâ”€â”€ package.json
â”œâ”€â”€ vite.config.ts
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ index.html
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.tsx                 # ğŸ”¥ React Query / Router / AuthProvider ê°ì‹¸ê¸°
â”‚   â”œâ”€â”€ App.tsx                  # ğŸ”¥ Layout + Routes
â”‚   â”œâ”€â”€ routes/                  # ğŸ”¥ ë¼ìš°íŠ¸ ì •ì˜ (í˜ì´ì§€ ê²½ê³„ì˜ SSOT)
â”‚   â”‚   â””â”€â”€ index.tsx
â”‚   â”œâ”€â”€ pages/                   # í˜ì´ì§€ ì»´í¬ë„ŒíŠ¸ (ë¼ìš°íŠ¸ ë‹¨ìœ„)
â”‚   â”‚   â”œâ”€â”€ Kanban/
â”‚   â”‚   â”œâ”€â”€ Project/
â”‚   â”‚   â”œâ”€â”€ Pending/
â”‚   â”‚   â”œâ”€â”€ Calendar/            # lazy load
â”‚   â”‚   â”œâ”€â”€ Graph/               # lazy load
â”‚   â”‚   â”œâ”€â”€ Program/
â”‚   â”‚   â””â”€â”€ Login/
â”‚   â”œâ”€â”€ features/                # ğŸ”¥ ë„ë©”ì¸ ë‹¨ìœ„ ëª¨ë“ˆ (ê°•ì¶”)
â”‚   â”‚   â”œâ”€â”€ tasks/
â”‚   â”‚   â”œâ”€â”€ projects/
â”‚   â”‚   â”œâ”€â”€ pending/
â”‚   â”‚   â”œâ”€â”€ strategy/            # tracks/conditions/hypotheses
â”‚   â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â””â”€â”€ attachments/
â”‚   â”œâ”€â”€ components/              # ì¬ì‚¬ìš© UI ì»´í¬ë„ŒíŠ¸ (ìˆœìˆ˜)
â”‚   â”‚   â”œâ”€â”€ layout/              # Sidebar/Header/Shell
â”‚   â”‚   â””â”€â”€ ui/                  # Button/Modal/Select/Badge ë“±
â”‚   â”œâ”€â”€ services/                # ğŸ”¥ API í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ http.ts              # baseURL, auth header, error handling
â”‚   â”‚   â””â”€â”€ api.ts               # endpoint functions
â”‚   â”œâ”€â”€ hooks/                   # ê³µìš© hooks
â”‚   â”‚   â”œâ”€â”€ useDebounce.ts
â”‚   â”‚   â””â”€â”€ useHotkeys.ts
â”‚   â”œâ”€â”€ queries/                 # ğŸ”¥ react-query queryKey + hooks (ê°•ì¶”)
â”‚   â”‚   â”œâ”€â”€ keys.ts
â”‚   â”‚   â”œâ”€â”€ useDashboardInit.ts
â”‚   â”‚   â”œâ”€â”€ useTasks.ts
â”‚   â”‚   â”œâ”€â”€ useProjects.ts
â”‚   â”‚   â””â”€â”€ usePendingReviews.ts
â”‚   â”œâ”€â”€ types/                   # ğŸ”¥ TS íƒ€ì… (ì„œë²„ DTO)
â”‚   â”‚   â”œâ”€â”€ task.ts
â”‚   â”‚   â”œâ”€â”€ project.ts
â”‚   â”‚   â”œâ”€â”€ pending.ts
â”‚   â”‚   â””â”€â”€ strategy.ts
â”‚   â”œâ”€â”€ utils/                   # pure functions (ì •ê·œí™” ë¡œì§ ì—¬ê¸°ë¡œ)
â”‚   â”‚   â”œâ”€â”€ normalize.ts
â”‚   â”‚   â””â”€â”€ date.ts
â”‚   â””â”€â”€ styles/                  # ì „ì—­ ìŠ¤íƒ€ì¼
â”‚       â””â”€â”€ globals.css
â””â”€â”€ public/
```

---

## ğŸ“ ìƒì„¸ ìš”êµ¬ì‚¬í•­

### 1. í”„ë¡œì íŠ¸ ì´ˆê¸°í™” (Vite + React + TS)

**ëª©ì **: í”„ë¡œì íŠ¸ ìŠ¤ìºí´ë“œ ìƒì„±

**êµ¬í˜„ ë‚´ìš©**:
```bash
cd /Users/gim-eunhyang/dev/loop/public
npm create vite@latest dashboard-v2 -- --template react-ts
cd dashboard-v2
npm install
```

**dependencies**:
```json
{
  "dependencies": {
    "react": "^18.3.0",
    "react-dom": "^18.3.0",
    "react-router-dom": "^6.22.0",
    "@tanstack/react-query": "^5.20.0",
    "@tanstack/react-query-devtools": "^5.20.0",
    "axios": "^1.6.0"
  },
  "devDependencies": {
    "@types/react": "^18.2.0",
    "@types/react-dom": "^18.2.0",
    "@typescript-eslint/eslint-plugin": "^6.0.0",
    "@typescript-eslint/parser": "^6.0.0",
    "@vitejs/plugin-react": "^4.2.0",
    "eslint": "^8.0.0",
    "eslint-plugin-react-hooks": "^4.6.0",
    "eslint-plugin-react-refresh": "^0.4.5",
    "typescript": "^5.0.0",
    "vite": "^5.0.0"
  }
}
```

---

### 2. í´ë” êµ¬ì¡° ìƒì„±

**ëª©ì **: ê¶Œì¥ êµ¬ì¡°ëŒ€ë¡œ í´ë” ìƒì„±

**êµ¬í˜„ ë‚´ìš©**:
```bash
mkdir -p src/{routes,pages/{Kanban,Project,Pending,Calendar,Graph,Program,Login},features/{tasks,projects,pending,strategy,auth,attachments},components/{layout,ui},services,hooks,queries,types,utils,styles}
```

**í´ë”ë³„ ì—­í• **:
- `routes/`: ë¼ìš°íŠ¸ ì •ì˜ (í˜ì´ì§€ ê²½ê³„ì˜ SSOT)
- `pages/`: ê° ë¼ìš°íŠ¸ì˜ í˜ì´ì§€ ì»´í¬ë„ŒíŠ¸
- `features/`: ë„ë©”ì¸ë³„ ëª¨ë“ˆ (CRUD + ì»´í¬ë„ŒíŠ¸)
- `components/`: ì¬ì‚¬ìš© UI (ìˆœìˆ˜ ì»´í¬ë„ŒíŠ¸)
- `services/`: API í´ë¼ì´ì–¸íŠ¸
- `queries/`: React Query hooks
- `types/`: TypeScript íƒ€ì… ì •ì˜
- `utils/`: ìˆœìˆ˜ í•¨ìˆ˜ (ì •ê·œí™” ë¡œì§)

---

### 3. React Router ì„¤ì •

**íŒŒì¼**: `src/routes/index.tsx`

**ëª©ì **: 7ê°œ ë¼ìš°íŠ¸ ì •ì˜ + lazy loading

**êµ¬í˜„ ë‚´ìš©**:
```tsx
import { lazy } from 'react';
import { createBrowserRouter } from 'react-router-dom';

// Eager load (ì´ˆê¸° í•„ìˆ˜)
import LoginPage from '@/pages/Login';
import KanbanPage from '@/pages/Kanban';
import ProjectPage from '@/pages/Project';
import PendingPage from '@/pages/Pending';
import ProgramPage from '@/pages/Program';

// Lazy load (ë¬´ê±°ìš´ í˜ì´ì§€)
const CalendarPage = lazy(() => import('@/pages/Calendar'));
const GraphPage = lazy(() => import('@/pages/Graph'));

export const router = createBrowserRouter([
  {
    path: '/login',
    element: <LoginPage />,
  },
  {
    path: '/',
    element: <AppLayout />,
    children: [
      { index: true, element: <Navigate to="/kanban" replace /> },
      { path: 'kanban', element: <KanbanPage /> },
      { path: 'projects/:id', element: <ProjectPage /> },
      { path: 'pending', element: <PendingPage /> },
      { path: 'calendar', element: <CalendarPage /> },
      { path: 'graph', element: <GraphPage /> },
      { path: 'program', element: <ProgramPage /> },
    ],
  },
]);
```

**ì¤‘ìš”**: Calendar/GraphëŠ” `lazy()`ë¡œ ë¡œë“œí•´ì•¼ ì´ˆê¸° ë²ˆë“¤ í¬ê¸° ìœ ì§€

---

### 4. React Query ì„¤ì •

**íŒŒì¼**: `src/main.tsx`

**ëª©ì **: ì„œë²„ ìƒíƒœ ìºì‹œ ì„¤ì •

**êµ¬í˜„ ë‚´ìš©**:
```tsx
import { QueryClient, QueryClientProvider } from '@tanstack/react-query';
import { ReactQueryDevtools } from '@tanstack/react-query-devtools';

const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      staleTime: 5 * 60 * 1000, // 5ë¶„
      cacheTime: 10 * 60 * 1000, // 10ë¶„
      retry: 1,
      refetchOnWindowFocus: false,
    },
  },
});

<QueryClientProvider client={queryClient}>
  <RouterProvider router={router} />
  <ReactQueryDevtools initialIsOpen={false} />
</QueryClientProvider>
```

---

### 5. API í´ë¼ì´ì–¸íŠ¸ ì„¤ì •

**íŒŒì¼**: `src/services/http.ts`

**ëª©ì **: baseURL, auth header, 401 ì²˜ë¦¬, ê³µí†µ ì—ëŸ¬ í•¸ë“¤ë§

**êµ¬í˜„ ë‚´ìš©**:
```tsx
import axios, { AxiosError } from 'axios';

const API_BASE_URL = import.meta.env.VITE_API_URL || 'https://mcp.sosilab.synology.me';

export const httpClient = axios.create({
  baseURL: API_BASE_URL,
  timeout: 30000,
  headers: {
    'Content-Type': 'application/json',
  },
});

// Request interceptor: JWT í† í° ì¶”ê°€
httpClient.interceptors.request.use((config) => {
  const token = localStorage.getItem('LOOP_API_TOKEN');
  if (token) {
    config.headers.Authorization = `Bearer ${token}`;
  }
  return config;
});

// Response interceptor: 401 ì²˜ë¦¬
httpClient.interceptors.response.use(
  (response) => response,
  (error: AxiosError) => {
    if (error.response?.status === 401) {
      // í† í° ë§Œë£Œ â†’ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ
      localStorage.removeItem('LOOP_API_TOKEN');
      window.location.href = '/login';
    }
    return Promise.reject(error);
  }
);
```

---

**íŒŒì¼**: `src/services/api.ts`

**ëª©ì **: endpoint functions (ì–‡ê²Œ ìœ ì§€)

**êµ¬í˜„ ë‚´ìš©**:
```tsx
import { httpClient } from './http';
import type { DashboardInitResponse, Task, Project } from '@/types';

export const dashboardApi = {
  // ì´ˆê¸° ë¡œë”© í†µí•© ì—”ë“œí¬ì¸íŠ¸
  getDashboardInit: () =>
    httpClient.get<DashboardInitResponse>('/api/dashboard-init'),

  // Tasks
  getTasks: (params?: { status?: string; assignee?: string }) =>
    httpClient.get<Task[]>('/api/tasks', { params }),

  // Projects
  getProjects: () =>
    httpClient.get<Project[]>('/api/projects'),

  // Pending
  getPendingReviews: () =>
    httpClient.get('/api/pending'),
};
```

**ì›ì¹™**:
- `api.ts`ëŠ” endpoint í•¨ìˆ˜ë§Œ ì •ì˜
- ë°ì´í„° ì¡°í•©/ì •ê·œí™”ëŠ” `queries/` í›…ì—ì„œ ì²˜ë¦¬
- ì´ë ‡ê²Œ í•˜ë©´ `api.js`ê°€ 600ì¤„ë¡œ ì»¤ì§€ì§€ ì•ŠìŒ

---

### 6. Query Hooks (í•µì‹¬)

**íŒŒì¼**: `src/queries/keys.ts`

**ëª©ì **: queryKey ìƒìˆ˜ ê´€ë¦¬ (SSOT)

**êµ¬í˜„ ë‚´ìš©**:
```tsx
export const queryKeys = {
  dashboardInit: ['dashboard', 'init'] as const,
  tasks: (filters?: object) => ['tasks', filters] as const,
  task: (id: string) => ['tasks', id] as const,
  projects: () => ['projects'] as const,
  project: (id: string) => ['projects', id] as const,
  pending: () => ['pending'] as const,
};
```

---

**íŒŒì¼**: `src/queries/useDashboardInit.ts`

**ëª©ì **: ì´ˆê¸° ë°ì´í„° ë¡œë”© í›… (ë‹¨ì¼ API í˜¸ì¶œ)

**êµ¬í˜„ ë‚´ìš©**:
```tsx
import { useQuery } from '@tanstack/react-query';
import { dashboardApi } from '@/services/api';
import { queryKeys } from './keys';

export const useDashboardInit = () => {
  return useQuery({
    queryKey: queryKeys.dashboardInit,
    queryFn: async () => {
      const { data } = await dashboardApi.getDashboardInit();
      return data;
    },
    staleTime: Infinity, // ì´ˆê¸° ë¡œë”© ë°ì´í„°ëŠ” ìƒˆë¡œê³ ì¹¨ ì „ê¹Œì§€ ìœ ì§€
  });
};
```

**v1ê³¼ì˜ ì°¨ì´**:
- v1: `State.loadAll()` â†’ 12ê°œ API ìˆœì°¨ í˜¸ì¶œ â†’ ëŠë¦¼
- v2: `useDashboardInit()` â†’ `/api/dashboard-init` ë‹¨ì¼ í˜¸ì¶œ â†’ ë¹ ë¦„
- React Query ìºì‹œë¡œ ì¤‘ë³µ ìš”ì²­ ìë™ ë°©ì§€

---

### 7. TypeScript íƒ€ì… ì •ì˜

**íŒŒì¼**: `src/types/task.ts`

**ëª©ì **: ì„œë²„ DTO íƒ€ì… (SSOT)

**êµ¬í˜„ ë‚´ìš©**:
```tsx
export interface Task {
  entity_id: string;
  entity_name: string;
  project_id: string;
  assignee: string;
  status: 'todo' | 'doing' | 'hold' | 'done' | 'blocked';
  priority: 'critical' | 'high' | 'medium' | 'low';
  type: 'dev' | 'bug' | 'strategy' | 'research' | 'ops' | 'meeting' | null;
  start_date: string;
  due: string;
  tags: string[];
  // ... ë‚˜ë¨¸ì§€ í•„ë“œ
}

export interface DashboardInitResponse {
  constants: Record<string, any>;
  members: Member[];
  tracks: Track[];
  conditions: Condition[];
  projects: Project[];
  tasks: Task[];
  pending_badge_count: number;
  user: User;
}
```

**ì›ì¹™**:
- ì„œë²„ ì‘ë‹µ í˜•ì‹ê³¼ ì •í™•íˆ ì¼ì¹˜
- `any` ì‚¬ìš© ìµœì†Œí™”
- ê³µí†µ íƒ€ì…ì€ ì¬ì‚¬ìš©

---

### 8. ê¸°ë³¸ Layout ì»´í¬ë„ŒíŠ¸

**íŒŒì¼**: `src/components/layout/AppLayout.tsx`

**ëª©ì **: Sidebar + Header + Main êµ¬ì¡°

**êµ¬í˜„ ë‚´ìš©**:
```tsx
import { Outlet } from 'react-router-dom';
import Sidebar from './Sidebar';
import Header from './Header';

export const AppLayout = () => {
  return (
    <div className="flex h-screen">
      <Sidebar />
      <div className="flex-1 flex flex-col">
        <Header />
        <main className="flex-1 overflow-auto p-6">
          <Outlet />
        </main>
      </div>
    </div>
  );
};
```

---

### 9. Vite ë¹Œë“œ ì„¤ì •

**íŒŒì¼**: `vite.config.ts`

**ëª©ì **: ë¹Œë“œ ì‚°ì¶œë¬¼ ê²½ë¡œ + alias ì„¤ì •

**êµ¬í˜„ ë‚´ìš©**:
```tsx
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';
import path from 'path';

export default defineConfig({
  plugins: [react()],
  resolve: {
    alias: {
      '@': path.resolve(__dirname, './src'),
    },
  },
  build: {
    outDir: 'dist',
    sourcemap: true,
    rollupOptions: {
      output: {
        manualChunks: {
          vendor: ['react', 'react-dom', 'react-router-dom'],
          query: ['@tanstack/react-query'],
        },
      },
    },
  },
  server: {
    port: 3000,
    proxy: {
      '/api': {
        target: 'https://mcp.sosilab.synology.me',
        changeOrigin: true,
      },
    },
  },
});
```

**ë¹Œë“œ ì „ëµ**:
- `dist/` â†’ NAS/ì›¹ ì„œë²„ê°€ `_dashboard_v2/`ë¡œ ì„œë¹™
- ê¸°ì¡´ `_dashboard/`ëŠ” ìœ ì§€ (ì ì§„ì  ì „í™˜)
- manualChunksë¡œ vendor/query ë¶„ë¦¬ (ìºì‹± ìµœì í™”)

---

## âœ… ì„±ê³µ ê¸°ì¤€

- [ ] âœ… `npm create vite` ì‹¤í–‰ ì™„ë£Œ
- [ ] âœ… ê¶Œì¥ í´ë” êµ¬ì¡° ìƒì„± ì™„ë£Œ
- [ ] âœ… React Router 7ê°œ ë¼ìš°íŠ¸ ì„¤ì •
- [ ] âœ… React Query ì„¤ì • (QueryClientProvider)
- [ ] âœ… API í´ë¼ì´ì–¸íŠ¸ ì„¤ì • (http.ts + api.ts)
- [ ] âœ… queryKeys + useDashboardInit í›… ì‘ì„±
- [ ] âœ… TypeScript íƒ€ì… ì •ì˜ (Task, Project, DashboardInitResponse)
- [ ] âœ… AppLayout ê¸°ë³¸ êµ¬ì¡° ì‘ì„±
- [ ] âœ… `npm run dev` ì‹¤í–‰ â†’ ë¡œì»¬ 3000ë²ˆ í¬íŠ¸ ë™ì‘
- [ ] âœ… ë¹Œë“œ ì„¤ì • (dist/ â†’ _dashboard_v2/ ì¤€ë¹„)
- [ ] âœ… ê¸°ì¡´ `_dashboard/`ì™€ ê³µì¡´ ê°€ëŠ¥í•œ ë…ë¦½ ì‹¤í–‰

---

## ğŸ” í™•ì¸ ì‚¬í•­

**ì§ˆë¬¸**:
1. âœ… API ì—”ë“œí¬ì¸íŠ¸ `/api/dashboard-init`ê°€ ì´ë¯¸ ì¡´ì¬í•˜ë‚˜ìš”?
   - ì—†ìœ¼ë©´ ì´ Task ì™„ë£Œ í›„ ë³„ë„ ë°±ì—”ë“œ Task í•„ìš”
2. âœ… ìŠ¤íƒ€ì¼ë§ì€ ì–´ë–»ê²Œ í• ê¹Œìš”?
   - Tailwind CSS (ì¶”ì²œ)
   - CSS Modules
   - styled-components
3. âœ… ë¡œê·¸ì¸ í˜ì´ì§€ëŠ” ë°”ë¡œ êµ¬í˜„?
   - ì•„ë‹ˆë©´ ë¨¼ì € Kanbanë§Œ êµ¬í˜„?

---

## ğŸš€ ë°°í¬/ì—°ë™ ê³„íš

### ë‹¨ê³„ì  ì „í™˜ ì „ëµ

**Phase 1 (ì´ë²ˆ Task)**:
```
public/
â”œâ”€â”€ _dashboard/          # ê¸°ì¡´ (ìœ ì§€)
â”‚   â””â”€â”€ index.html
â””â”€â”€ dashboard-v2/        # ì‹ ê·œ (ë³‘í–‰ ìš´ì˜)
    â”œâ”€â”€ dist/
    â””â”€â”€ src/
```

**Phase 2 (êµ¬í˜„ ì™„ë£Œ í›„)**:
```bash
# ë¹Œë“œ
cd public/dashboard-v2
npm run build

# NAS/ì›¹ ì„œë²„ ì„¤ì •
# _dashboard_v2/ â†’ dist/ ì‹¬ë³¼ë¦­ ë§í¬ or ë³µì‚¬
```

**Phase 3 (ê²€ì¦ ì™„ë£Œ í›„)**:
```bash
# ê¸°ì¡´ _dashboard/ ì‚­ì œ
rm -rf public/_dashboard/

# dashboard-v2/dist/ â†’ _dashboard/ë¡œ rename
mv public/_dashboard_v2 public/_dashboard
```

---

## ì²´í¬ë¦¬ìŠ¤íŠ¸

### í”„ë¡œì íŠ¸ ì…‹ì—…
- [ ] Vite í”„ë¡œì íŠ¸ ìƒì„±
- [ ] package.json ì˜ì¡´ì„± ì„¤ì¹˜
- [ ] í´ë” êµ¬ì¡° ìƒì„±

### ë¼ìš°í„° & ìƒíƒœ ê´€ë¦¬
- [ ] React Router ì„¤ì •
- [ ] React Query ì„¤ì •
- [ ] API í´ë¼ì´ì–¸íŠ¸ ì„¤ì •

### íƒ€ì… & í›…
- [ ] TypeScript íƒ€ì… ì •ì˜
- [ ] queryKeys ì •ì˜
- [ ] useDashboardInit í›… ì‘ì„±

### ë ˆì´ì•„ì›ƒ & ìŠ¤íƒ€ì¼
- [ ] AppLayout ì»´í¬ë„ŒíŠ¸
- [ ] Sidebar ê¸°ë³¸ êµ¬ì¡°
- [ ] ì „ì—­ ìŠ¤íƒ€ì¼ ì„¤ì •

### ë¹Œë“œ & ë°°í¬
- [ ] vite.config.ts ìµœì í™”
- [ ] ë¡œì»¬ ê°œë°œ ì„œë²„ ë™ì‘ í™•ì¸
- [ ] ë¹Œë“œ í…ŒìŠ¤íŠ¸ (npm run build)

---

## Notes

### êµ¬í˜„ ì™„ë£Œ (2026-01-07)

**ìƒíƒœ**: âœ… í”„ë¡œì íŠ¸ ì´ˆê¸°í™” ì™„ë£Œ
**ìœ„ì¹˜**: `/Users/gim-eunhyang/dev/loop/public/dashboard-v2/`
**ë¹Œë“œ**: ì„±ê³µ (223.79 kB main, 74.03 kB vendor, 33.67 kB query)

**ì™„ë£Œ í•­ëª©**:
1. âœ… Vite + React 19 + TypeScript í”„ë¡œì íŠ¸ ìƒì„±
2. âœ… í´ë” êµ¬ì¡° ìƒì„± (routes/, pages/, features/, components/, services/, queries/, types/, utils/)
3. âœ… React Router 7ê°œ ë¼ìš°íŠ¸ ì„¤ì • (lazy loading í¬í•¨)
4. âœ… React Query ì„¤ì • (staleTime: 5min, gcTime: 10min)
5. âœ… API í´ë¼ì´ì–¸íŠ¸ ì„¤ì • (http.ts with JWT interceptors, api.ts with endpoints)
6. âœ… TypeScript íƒ€ì… ì •ì˜ (Task, Project, DashboardInitResponse, APIError)
7. âœ… Query hooks (queryKeys, useDashboardInit)
8. âœ… Layout ì»´í¬ë„ŒíŠ¸ (AppLayout, Sidebar, Header)
9. âœ… Vite ì„¤ì • (path alias @/, manualChunks, API proxy)
10. âœ… í™˜ê²½ ë³€ìˆ˜ ì„¤ì • (.env.example)

**ë‹¤ìŒ ë‹¨ê³„** (Phase 2 - Pending ë¶„ë¦¬):
- Pending Review í˜ì´ì§€ êµ¬í˜„
- Task Drawer êµ¬í˜„
- Kanban ë³´ë“œ ê¸°ëŠ¥ êµ¬í˜„

**ì‹¤í–‰**:
```bash
cd /Users/gim-eunhyang/dev/loop/public/dashboard-v2
npm run dev  # http://localhost:3000
npm run build  # dist/ ìƒì„±
```

---

### í•µì‹¬ ì² í•™ (v1 â†’ v2 ë³€í™”)

**v1 ë¬¸ì œ**:
```
State.js (35KB)
â”œâ”€â”€ ì„œë²„ ë°ì´í„° (12ê°œ API í˜¸ì¶œ)
â”œâ”€â”€ ì •ê·œí™” ë¡œì§
â”œâ”€â”€ UI ìƒíƒœ
â””â”€â”€ ë Œë” ë¡œì§
â†’ ëª¨ë‘ ì„ì—¬ì„œ í„°ì§
```

**v2 í•´ê²°**:
```
ì„œë²„ ìƒíƒœ â†’ React Query (queries/)
ì •ê·œí™”    â†’ Utils (utils/normalize.ts)
UI ìƒíƒœ   â†’ í˜ì´ì§€ local state or URL params
ë Œë”      â†’ Pages + Features ë¶„ë¦¬
â†’ ì±…ì„ ë¶„ë¦¬ë¡œ ìœ ì§€ë³´ìˆ˜ ì‰¬ì›Œì§
```

### Query Hookì´ ë°ì´í„° ì£¼ì²´

**v1 ë°©ì‹** (ì•ˆí‹°íŒ¨í„´):
```js
// api.jsì—ì„œ ë°ì´í„° ì¡°í•© â†’ 600ì¤„ë¡œ ì»¤ì§
export async function loadAll() {
  const tasks = await getTasks();
  const projects = await getProjects();
  return { tasks, projects, normalized: normalize(...) };
}
```

**v2 ë°©ì‹** (ê¶Œì¥):
```tsx
// api.tsëŠ” ì–‡ê²Œ ìœ ì§€
export const dashboardApi = {
  getTasks: () => httpClient.get<Task[]>('/api/tasks'),
};

// queries/useTasks.tsì—ì„œ ë°ì´í„° ì¡°í•©
export const useTasks = (filters) => {
  return useQuery({
    queryKey: queryKeys.tasks(filters),
    queryFn: async () => {
      const { data } = await dashboardApi.getTasks();
      return normalizeTaskData(data); // ì •ê·œí™”ëŠ” utils/ì—ì„œ
    },
  });
};
```

â†’ `api.ts`ëŠ” endpoint ì •ì˜ë§Œ, ë¡œì§ì€ query hookì—ì„œ ì²˜ë¦¬

### Lazy Loading í•„ìˆ˜

**Calendar/GraphëŠ” ë¬´ê±°ì›€** (D3.js, FullCalendar):
```tsx
// âŒ ë‚˜ìœ ì˜ˆ
import CalendarPage from '@/pages/Calendar'; // ì¦‰ì‹œ ë¡œë“œ

// âœ… ì¢‹ì€ ì˜ˆ
const CalendarPage = lazy(() => import('@/pages/Calendar')); // ë¼ìš°íŠ¸ ì§„ì… ì‹œì—ë§Œ ë¡œë“œ
```

â†’ ì´ˆê¸° ë²ˆë“¤ í¬ê¸° ìœ ì§€, ì„±ëŠ¥ í–¥ìƒ

---

## ì°¸ê³  ë¬¸ì„œ

- [[prj-023]] - Dashboard - React+TS ë§ˆì´ê·¸ë ˆì´ì…˜ í”„ë¡œì íŠ¸
- [[pgm-vault-system]] - Vault System í”„ë¡œê·¸ë¨
- ê¸°ì¡´ ëŒ€ì‹œë³´ë“œ: `public/_dashboard/`
- React Query Docs: https://tanstack.com/query/latest
- Vite Docs: https://vitejs.dev

---

**Created**: 2026-01-07
**Assignee**: ê¹€ì€í–¥
**Due**: 2026-01-07
**Priority**: high
