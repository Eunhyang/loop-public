---
entity_type: Task
entity_id: tsk-023-28
entity_name: Pending - EntityPreview를 Form view 모드로 교체
created: 2026-01-09
updated: '2026-01-09'
status: done
parent_id: prj-023
project_id: prj-023
program_id: pgm-vault-system
aliases: []
assignee: 김은향
type: dev
priority: high
start_date: 2026-01-09
due: null
closed: 2026-01-09
target_project: loop
outgoing_relations: []
validates: []
validated_by: []
conditions_3y: []
tags:
- dashboard-v2
- pending
- refactor
- form-component
notes: "# Pending - EntityPreview를 Form view 모드로 교체\n\n> Task ID: `tsk-023-28` | Project:\
  \ \\[\\[prj-023\\]\\] | Status: done\n\n---\n\n## 목표\n\nPending Reviews 페이지의 오른쪽\
  \ 패널(`EntityPreview.tsx`)을 삭제하고, 기존 Form 컴포넌트들의 view 모드를 재사용하여 일관된 UX 제공\n\n---\n\
  \n## 배경\n\n### 현재 문제점\n\n- `EntityPreview.tsx`가 모든 엔티티 필드를 JSON처럼 단순 나열\n- 기존 Form\
  \ 컴포넌트(TaskForm, ProjectForm 등)와 UI 일관성 없음\n- 같은 엔티티를 다른 방식으로 표시 → UX 혼란\n\n###\
  \ 해결 방향\n\n- `EntityPreview.tsx` 삭제\n- 기존 Form 컴포넌트의 view 모드 재사용\n- Pending 오른쪽\
  \ 패널에서 entityType에 따라 적절한 Form 렌더링\n\n---\n\n## Tech Spec\n\n### 파일 구조 변경\n\n```\n\
  src/features/pending/components/\n├── EntityPreview.tsx      # ❌ 삭제\n├── ReviewList.tsx\
  \         # 유지\n├── ReviewDetail.tsx       # 유지\n├── FieldValue.tsx         # 유지\n\
  └── WorkflowFilters.tsx    # 유지\n\nsrc/features/tasks/components/\n└── TaskForm.tsx\
  \           # ✏️ view 모드 추가\n\nsrc/features/strategy/components/\n└── HypothesisForm.tsx\
  \     # ✏️ view 모드 구현\n\nsrc/pages/Pending/index.tsx  # ✏️ Form 컴포넌트 사용으로 변경\n```\n\
  \n### 1. TaskForm에 view 모드 추가\n\n**현재**: `mode: 'create' | 'edit'`**변경**: `mode:\
  \ 'create' | 'edit' | 'view'`\n\n```typescript\n// TaskForm.tsx\ninterface TaskFormProps\
  \ {\n  mode: 'create' | 'edit' | 'view';  // view 추가\n  id?: string;\n  prefill?:\
  \ Partial<Task>;\n}\n\n// view 모드 구현 (ProjectForm.tsx:47-133 패턴 따라)\nif (mode ===\
  \ 'view' && id) {\n  const task = dashboardData?.tasks?.find((t) => t.entity_id\
  \ === id);\n\n  return (\n    <div className=\"flex-1 overflow-y-auto\">\n     \
  \ {/* ID Badge */}\n      <div className=\"px-6 pt-4 pb-2\">\n        <span className=\"\
  font-mono text-xs text-zinc-400 px-2 py-1 bg-zinc-50 rounded\">\n          {task.entity_id}\n\
  \        </span>\n      </div>\n\n      {/* Title */}\n      <div className=\"px-6\
  \ pb-4\">\n        <h2 className=\"text-xl font-bold text-zinc-900\">{task.entity_name}</h2>\n\
  \      </div>\n\n      {/* Properties Grid (read-only) */}\n      <div className=\"\
  px-6 py-4 grid grid-cols-[100px_1fr] gap-y-3 gap-x-4 text-sm\">\n        {/* Status,\
  \ Priority, Assignee, Project, Dates 등 */}\n      </div>\n\n      {/* Notes (read-only)\
  \ */}\n      <div className=\"px-6 py-4\">\n        <h3 className=\"text-sm font-semibold\
  \ text-zinc-500 mb-2\">Notes</h3>\n        <div className=\"prose prose-sm\">{/*\
  \ markdown render */}</div>\n      </div>\n    </div>\n  );\n}\n```\n\n### 2. HypothesisForm\
  \ view 모드 구현\n\n**현재**: placeholder만 있음 (\"Hypothesis CRUD not yet implemented\"\
  ) **변경**: view 모드 구현 (TrackForm/ConditionForm 패턴 따라)\n\n```typescript\n// HypothesisForm.tsx\n\
  interface HypothesisFormProps {\n  mode: 'create' | 'edit' | 'view';\n  id?: string;\n\
  \  prefill?: Record<string, any>;\n}\n\nexport const HypothesisForm = ({ mode, id\
  \ }: HypothesisFormProps) => {\n  const { data: dashboardData } = useDashboardInit();\n\
  \n  // view 모드\n  if (mode === 'view' && id) {\n    const hypothesis = dashboardData?.hypotheses?.find((h)\
  \ => h.entity_id === id);\n\n    if (!hypothesis) {\n      return <div>Hypothesis\
  \ not found</div>;\n    }\n\n    return (\n      <div className=\"flex-1 overflow-y-auto\"\
  >\n        {/* View-only notice */}\n        <div className=\"px-6 pt-4 pb-3\">\n\
  \          <div className=\"bg-blue-50 border border-blue-200 rounded p-3 text-sm\
  \ text-blue-700\">\n            <strong>View Only:</strong> Hypotheses cannot be\
  \ edited from the dashboard.\n          </div>\n        </div>\n\n        {/* ID\
  \ Badge, Title, Properties Grid */}\n        {/* TrackForm/ConditionForm 패턴 따라 구현\
  \ */}\n      </div>\n    );\n  }\n\n  // create/edit 모드 - 기존 placeholder 유지\n  return\
  \ <div>Hypothesis CRUD not yet implemented...</div>;\n};\n```\n\n### 3. PendingPage\
  \ 오른쪽 패널 변경\n\n**현재**: `EntityPreview` 컴포넌트 사용 **변경**: entityType에 따라 Form 컴포넌트\
  \ view 모드 렌더링\n\n```typescript\n// pages/Pending/index.tsx\nimport { TaskForm }\
  \ from '@/features/tasks/components/TaskForm';\nimport { ProjectForm } from '@/features/projects/components/ProjectForm';\n\
  import { TrackForm } from '@/features/strategy/components/TrackForm';\nimport {\
  \ ConditionForm } from '@/features/strategy/components/ConditionForm';\nimport {\
  \ HypothesisForm } from '@/features/strategy/components/HypothesisForm';\n\n// Right\
  \ Pane 렌더링 부분\nconst renderEntityPreview = () => {\n  if (!previewEntityId || !previewEntityType)\
  \ {\n    return (\n      <div className=\"flex items-center justify-center h-full\
  \ text-gray-500 p-4 text-center\">\n        Click an entity ID to preview\n    \
  \  </div>\n    );\n  }\n\n  switch (previewEntityType) {\n    case 'Task':\n   \
  \   return <TaskForm mode=\"view\" id={previewEntityId} />;\n    case 'Project':\n\
  \      return <ProjectForm mode=\"view\" id={previewEntityId} />;\n    case 'Track':\n\
  \      return <TrackForm id={previewEntityId} />;\n    case 'Condition':\n     \
  \ return <ConditionForm id={previewEntityId} />;\n    case 'Hypothesis':\n     \
  \ return <HypothesisForm mode=\"view\" id={previewEntityId} />;\n    default:\n\
  \      return <div>Unknown entity type</div>;\n  }\n};\n\n// JSX에서\n<div className=\"\
  w-80 border-l min-h-0 overflow-y-auto\">\n  {renderEntityPreview()}\n</div>\n```\n\
  \n### 4. EntityPreview.tsx 삭제\n\n- 파일 삭제: `src/features/pending/components/EntityPreview.tsx`\n\
  - index.ts에서 export 제거\n\n---\n\n## Todo\n\n- [ ] TaskForm.tsx에 view 모드 추가 (ProjectForm\
  \ 패턴)\n\n- [ ] HypothesisForm.tsx view 모드 구현 (TrackForm/ConditionForm 패턴)\n\n- [\
  \ ] PendingPage에서 EntityPreview 대신 Form 컴포넌트 사용\n\n- [ ] EntityPreview.tsx 삭제\n\n\
  - [ ] pending/components/index.ts에서 EntityPreview export 제거\n\n- [ ] 테스트: Pending\
  \ 페이지에서 각 엔티티 타입 클릭 시 올바른 Form 표시 확인\n\n---\n\n## 수용 기준\n\n1. Pending 오른쪽 패널에서 Task\
  \ 클릭 시 TaskForm view 모드 표시\n2. Project 클릭 시 ProjectForm view 모드 표시\n3. Track/Condition/Hypothesis\
  \ 클릭 시 해당 Form 표시\n4. EntityPreview.tsx 파일 완전 삭제\n5. 기존 UX 유지 (3-pane 레이아웃, 스크롤\
  \ 등)\n\n---\n\n## Codex Review 피드백 반영\n\n### 1. Hypothesis 필드 누락 (HIGH)\n\n- **이슈**:\
  \ Hypothesis view 모드에 notes/description 필드 누락 가능\n- **해결**: Hypothesis 타입에서 사용 가능한\
  \ 모든 필드 표시 (status, hypothesis_text, validates, validated_by 등)\n\n### 2. Unknown\
  \ entityType 처리 (HIGH)\n\n- **이슈**: 지원하지 않는 entityType에 대한 fallback 없음\n- **해결**:\
  \ `default` case에서 graceful한 에러 메시지 표시\n\n  ```typescript\n  default:\n    return\
  \ (\n      <div className=\"flex items-center justify-center h-full text-gray-500\
  \ p-4 text-center\">\n        <div>\n          <p>Unsupported entity type: {previewEntityType}</p>\n\
  \          <p className=\"text-sm mt-1\">This entity type cannot be previewed.</p>\n\
  \        </div>\n      </div>\n    );\n  ```\n\n### 3. 로딩/에러 상태 처리 (MEDIUM)\n\n\
  - **이슈**: 데이터 로딩 중/에러 시 상태 미정의\n- **해결**: 각 Form의 기존 로딩/에러 처리 재사용\n  - TaskForm:\
  \ `if (!task) return <div>Task not found</div>`\n  - 다른 Form도 동일 패턴\n\n### 4. 성능\
  \ 고려 (MEDIUM)\n\n- **이슈**: Form 컴포넌트가 EntityPreview보다 무거울 수 있음\n- **해결**:\n  - view\
  \ 모드에서는 validation/editor 로직 스킵\n  - `useDashboardInit()` 캐시 사용 (추가 API 호출 없음)\n\
  \  - 필요시 React.memo 적용\n\n### 5. 액션 버튼 유지 (LOW)\n\n- **이슈**: Copy ID 등 기존 EntityPreview\
  \ 기능 누락 가능\n- **해결**: view 모드에서 ID 클릭 시 복사 기능 유지 (기존 Form에 이미 있음)\n\n### 6. 접근성\
  \ (LOW)\n\n- **이슈**: read-only 컨트롤 접근성\n- **해결**: view 모드에서 input/select 대신 span/div\
  \ 사용 (기존 ProjectForm 패턴)\n\n---\n\n## 참고 파일\n\n- `src/features/projects/components/ProjectForm.tsx:47-133`\
  \ - view 모드 참고\n- `src/features/strategy/components/TrackForm.tsx` - view-only 패턴\n\
  - `src/features/strategy/components/ConditionForm.tsx` - view-only 패턴\n- `src/pages/Pending/index.tsx`\
  \ - 수정 대상\n\n---\n\n## 작업 로그\n\n### 2026-01-09\n\n**개요**: Task 완료 - EntityPreview\
  \ 삭제 및 Form view 모드 통합\n\n**구현 내역**:\n\n- TaskForm.tsx에 view 모드 추가 (readOnly pattern\
  \ 적용)\n- HypothesisForm.tsx view 모드 구현 (TrackForm 패턴 참고)\n- PendingPage에서 entityType별\
  \ Form 컴포넌트 렌더링으로 변경\n- EntityPreview.tsx 파일 삭제\n- pending/components/index.ts에서\
  \ EntityPreview export 제거\n- unknown entityType 처리 추가 (graceful error message)\n\
  \n**결과**:\n\n- 빌드 성공 (no errors, no warnings)\n- Pending 페이지에서 모든 엔티티 타입의 일관된 view\
  \ 모드 제공\n- UX 일관성 확보 (Form 컴포넌트 재사용)\n\n**최종 상태**: done"
---
# Pending - EntityPreview를 Form view 모드로 교체

> Task ID: `tsk-023-28` | Project: [[prj-023]] | Status: done

---

## 목표

Pending Reviews 페이지의 오른쪽 패널(`EntityPreview.tsx`)을 삭제하고, 기존 Form 컴포넌트들의 view 모드를 재사용하여 일관된 UX 제공

---

## 배경

### 현재 문제점

- `EntityPreview.tsx`가 모든 엔티티 필드를 JSON처럼 단순 나열
- 기존 Form 컴포넌트(TaskForm, ProjectForm 등)와 UI 일관성 없음
- 같은 엔티티를 다른 방식으로 표시 → UX 혼란

### 해결 방향

- `EntityPreview.tsx` 삭제
- 기존 Form 컴포넌트의 view 모드 재사용
- Pending 오른쪽 패널에서 entityType에 따라 적절한 Form 렌더링

---

## Tech Spec

### 파일 구조 변경

```
src/features/pending/components/
├── EntityPreview.tsx      # ❌ 삭제
├── ReviewList.tsx         # 유지
├── ReviewDetail.tsx       # 유지
├── FieldValue.tsx         # 유지
└── WorkflowFilters.tsx    # 유지

src/features/tasks/components/
└── TaskForm.tsx           # ✏️ view 모드 추가

src/features/strategy/components/
└── HypothesisForm.tsx     # ✏️ view 모드 구현

src/pages/Pending/index.tsx  # ✏️ Form 컴포넌트 사용으로 변경
```

### 1. TaskForm에 view 모드 추가

**현재**: `mode: 'create' | 'edit'`
**변경**: `mode: 'create' | 'edit' | 'view'`

```typescript
// TaskForm.tsx
interface TaskFormProps {
  mode: 'create' | 'edit' | 'view';  // view 추가
  id?: string;
  prefill?: Partial<Task>;
}

// view 모드 구현 (ProjectForm.tsx:47-133 패턴 따라)
if (mode === 'view' && id) {
  const task = dashboardData?.tasks?.find((t) => t.entity_id === id);

  return (
    <div className="flex-1 overflow-y-auto">
      {/* ID Badge */}
      <div className="px-6 pt-4 pb-2">
        <span className="font-mono text-xs text-zinc-400 px-2 py-1 bg-zinc-50 rounded">
          {task.entity_id}
        </span>
      </div>

      {/* Title */}
      <div className="px-6 pb-4">
        <h2 className="text-xl font-bold text-zinc-900">{task.entity_name}</h2>
      </div>

      {/* Properties Grid (read-only) */}
      <div className="px-6 py-4 grid grid-cols-[100px_1fr] gap-y-3 gap-x-4 text-sm">
        {/* Status, Priority, Assignee, Project, Dates 등 */}
      </div>

      {/* Notes (read-only) */}
      <div className="px-6 py-4">
        <h3 className="text-sm font-semibold text-zinc-500 mb-2">Notes</h3>
        <div className="prose prose-sm">{/* markdown render */}</div>
      </div>
    </div>
  );
}
```

### 2. HypothesisForm view 모드 구현

**현재**: placeholder만 있음 ("Hypothesis CRUD not yet implemented")
**변경**: view 모드 구현 (TrackForm/ConditionForm 패턴 따라)

```typescript
// HypothesisForm.tsx
interface HypothesisFormProps {
  mode: 'create' | 'edit' | 'view';
  id?: string;
  prefill?: Record<string, any>;
}

export const HypothesisForm = ({ mode, id }: HypothesisFormProps) => {
  const { data: dashboardData } = useDashboardInit();

  // view 모드
  if (mode === 'view' && id) {
    const hypothesis = dashboardData?.hypotheses?.find((h) => h.entity_id === id);

    if (!hypothesis) {
      return <div>Hypothesis not found</div>;
    }

    return (
      <div className="flex-1 overflow-y-auto">
        {/* View-only notice */}
        <div className="px-6 pt-4 pb-3">
          <div className="bg-blue-50 border border-blue-200 rounded p-3 text-sm text-blue-700">
            <strong>View Only:</strong> Hypotheses cannot be edited from the dashboard.
          </div>
        </div>

        {/* ID Badge, Title, Properties Grid */}
        {/* TrackForm/ConditionForm 패턴 따라 구현 */}
      </div>
    );
  }

  // create/edit 모드 - 기존 placeholder 유지
  return <div>Hypothesis CRUD not yet implemented...</div>;
};
```

### 3. PendingPage 오른쪽 패널 변경

**현재**: `EntityPreview` 컴포넌트 사용
**변경**: entityType에 따라 Form 컴포넌트 view 모드 렌더링

```typescript
// pages/Pending/index.tsx
import { TaskForm } from '@/features/tasks/components/TaskForm';
import { ProjectForm } from '@/features/projects/components/ProjectForm';
import { TrackForm } from '@/features/strategy/components/TrackForm';
import { ConditionForm } from '@/features/strategy/components/ConditionForm';
import { HypothesisForm } from '@/features/strategy/components/HypothesisForm';

// Right Pane 렌더링 부분
const renderEntityPreview = () => {
  if (!previewEntityId || !previewEntityType) {
    return (
      <div className="flex items-center justify-center h-full text-gray-500 p-4 text-center">
        Click an entity ID to preview
      </div>
    );
  }

  switch (previewEntityType) {
    case 'Task':
      return <TaskForm mode="view" id={previewEntityId} />;
    case 'Project':
      return <ProjectForm mode="view" id={previewEntityId} />;
    case 'Track':
      return <TrackForm id={previewEntityId} />;
    case 'Condition':
      return <ConditionForm id={previewEntityId} />;
    case 'Hypothesis':
      return <HypothesisForm mode="view" id={previewEntityId} />;
    default:
      return <div>Unknown entity type</div>;
  }
};

// JSX에서
<div className="w-80 border-l min-h-0 overflow-y-auto">
  {renderEntityPreview()}
</div>
```

### 4. EntityPreview.tsx 삭제

- 파일 삭제: `src/features/pending/components/EntityPreview.tsx`
- index.ts에서 export 제거

---

## Todo

- [ ] TaskForm.tsx에 view 모드 추가 (ProjectForm 패턴)
- [ ] HypothesisForm.tsx view 모드 구현 (TrackForm/ConditionForm 패턴)
- [ ] PendingPage에서 EntityPreview 대신 Form 컴포넌트 사용
- [ ] EntityPreview.tsx 삭제
- [ ] pending/components/index.ts에서 EntityPreview export 제거
- [ ] 테스트: Pending 페이지에서 각 엔티티 타입 클릭 시 올바른 Form 표시 확인

---

## 수용 기준

1. Pending 오른쪽 패널에서 Task 클릭 시 TaskForm view 모드 표시
2. Project 클릭 시 ProjectForm view 모드 표시
3. Track/Condition/Hypothesis 클릭 시 해당 Form 표시
4. EntityPreview.tsx 파일 완전 삭제
5. 기존 UX 유지 (3-pane 레이아웃, 스크롤 등)

---

## Codex Review 피드백 반영

### 1. Hypothesis 필드 누락 (HIGH)
- **이슈**: Hypothesis view 모드에 notes/description 필드 누락 가능
- **해결**: Hypothesis 타입에서 사용 가능한 모든 필드 표시 (status, hypothesis_text, validates, validated_by 등)

### 2. Unknown entityType 처리 (HIGH)
- **이슈**: 지원하지 않는 entityType에 대한 fallback 없음
- **해결**: `default` case에서 graceful한 에러 메시지 표시
  ```typescript
  default:
    return (
      <div className="flex items-center justify-center h-full text-gray-500 p-4 text-center">
        <div>
          <p>Unsupported entity type: {previewEntityType}</p>
          <p className="text-sm mt-1">This entity type cannot be previewed.</p>
        </div>
      </div>
    );
  ```

### 3. 로딩/에러 상태 처리 (MEDIUM)
- **이슈**: 데이터 로딩 중/에러 시 상태 미정의
- **해결**: 각 Form의 기존 로딩/에러 처리 재사용
  - TaskForm: `if (!task) return <div>Task not found</div>`
  - 다른 Form도 동일 패턴

### 4. 성능 고려 (MEDIUM)
- **이슈**: Form 컴포넌트가 EntityPreview보다 무거울 수 있음
- **해결**:
  - view 모드에서는 validation/editor 로직 스킵
  - `useDashboardInit()` 캐시 사용 (추가 API 호출 없음)
  - 필요시 React.memo 적용

### 5. 액션 버튼 유지 (LOW)
- **이슈**: Copy ID 등 기존 EntityPreview 기능 누락 가능
- **해결**: view 모드에서 ID 클릭 시 복사 기능 유지 (기존 Form에 이미 있음)

### 6. 접근성 (LOW)
- **이슈**: read-only 컨트롤 접근성
- **해결**: view 모드에서 input/select 대신 span/div 사용 (기존 ProjectForm 패턴)

---

## 참고 파일

- `src/features/projects/components/ProjectForm.tsx:47-133` - view 모드 참고
- `src/features/strategy/components/TrackForm.tsx` - view-only 패턴
- `src/features/strategy/components/ConditionForm.tsx` - view-only 패턴
- `src/pages/Pending/index.tsx` - 수정 대상

---

## 작업 로그

### 2026-01-09

**개요**: Task 완료 - EntityPreview 삭제 및 Form view 모드 통합

**구현 내역**:
- TaskForm.tsx에 view 모드 추가 (readOnly pattern 적용)
- HypothesisForm.tsx view 모드 구현 (TrackForm 패턴 참고)
- PendingPage에서 entityType별 Form 컴포넌트 렌더링으로 변경
- EntityPreview.tsx 파일 삭제
- pending/components/index.ts에서 EntityPreview export 제거
- unknown entityType 처리 추가 (graceful error message)

**결과**:
- 빌드 성공 (no errors, no warnings)
- Pending 페이지에서 모든 엔티티 타입의 일관된 view 모드 제공
- UX 일관성 확보 (Form 컴포넌트 재사용)

**최종 상태**: done
