---
entity_type: Task
entity_id: tsk-023-1768496364389
entity_name: Dashboard - Split Drawer (Cmd+클릭 시 좌우 분할)
created: '2026-01-16'
updated: '2026-01-16'
status: todo
project_id: prj-023
parent_id: prj-023
assignee: 김은향
priority: medium
start_date: '2026-01-16'
due: '2026-01-16'
aliases:
- tsk-023-1768496364389
tags: []
type: dev
---

# Dashboard - Split Drawer (Cmd+클릭 시 좌우 분할)

## 설명

Entity Drawer에서 관계 엔티티(→ 버튼) 클릭 시, Cmd+클릭하면 기존 drawer를 유지하면서 오른쪽에 새 drawer가 열리는 Split View 기능.

**트리거**: Cmd + 클릭 (일반 클릭은 기존처럼 drawer 교체)
**중첩 동작**: Split 상태에서 → 클릭 시 오른쪽 패널만 교체

## Notes

### Tech Spec

**Architecture Compliance:**
- Parent Project: prj-023
- Target: loop (dashboard-v2)
- 원칙 준수: Drawer 표준 2.1 (DrawerShell = 레이아웃만), UiContext SSOT

**File Structure:**
```
src/contexts/UiContext.tsx          # secondary drawer 상태 추가
src/components/common/entity/EntityChip.tsx  # onNavigate에 event 전달
src/components/layout/EntityDrawer.tsx       # pane prop 추가
src/components/layout/AppLayout.tsx          # dual drawer 렌더링
src/components/common/DrawerShell.tsx        # split 모드 width
src/features/tasks/components/TaskForm.tsx   # Cmd+클릭 분기
src/features/projects/components/ProjectForm.tsx  # Cmd+클릭 분기
```

**Implementation Details:**

1. **UiContext.tsx - Secondary Drawer 상태**
```typescript
// 기존 history 유지 + secondary 추가
const [secondaryDrawer, setSecondaryDrawer] = useState<ActiveEntityDrawer | null>(null);

const openSecondaryDrawer = (drawer: ActiveEntityDrawer) => {
  setSecondaryDrawer(drawer);
};

const closeSecondaryDrawer = () => {
  setSecondaryDrawer(null);
};

// Context value
secondaryDrawer,
openSecondaryDrawer,
closeSecondaryDrawer,
isSplitMode: secondaryDrawer !== null,
```

2. **EntityChip.tsx - Event 전달**
```typescript
// onNavigate 시그니처 변경
onNavigate?: (e: React.MouseEvent) => void;

const handleNavigate = (e: React.MouseEvent) => {
  e.stopPropagation();
  if (disabled) return;
  onNavigate?.(e);  // event 전달
};
```

3. **사용처 (TaskForm, ProjectForm 등)**
```typescript
onNavigate={(e) => {
  if (e.metaKey || e.ctrlKey) {
    openSecondaryDrawer({ type, mode: 'view', id });
  } else {
    handleRelationClickInternal(id, type);
  }
}}
```

4. **AppLayout.tsx - Dual Drawer**
```tsx
<EntityDrawer pane="primary" />
{secondaryDrawer && <EntityDrawer pane="secondary" />}
```

5. **EntityDrawer.tsx - Pane 분기**
```typescript
interface EntityDrawerProps {
  pane?: 'primary' | 'secondary';
}

const drawer = pane === 'secondary' ? secondaryDrawer : activeEntityDrawer;
const onClose = pane === 'secondary' ? closeSecondaryDrawer : closeEntityDrawer;
```

6. **DrawerShell.tsx - Split Width**
```typescript
// split 모드: 50% 폭, 단일 모드: 520px
const width = isSplitMode ? 'w-1/2' : 'w-[520px]';
```

**Edge Cases:**
- Primary drawer 닫으면 secondary도 함께 닫기
- ESC 키: 마지막으로 열린 drawer부터 닫기 (secondary → primary 순)
- Mobile/좁은 화면: split 비활성화 (단일 drawer만)

### Todo
- [ ] UiContext.tsx: secondaryDrawer 상태 + openSecondaryDrawer/closeSecondaryDrawer 함수
- [ ] EntityChip.tsx: onNavigate 시그니처 (e: React.MouseEvent) 변경
- [ ] EntityDrawer.tsx: pane prop 추가, secondary 분기 처리
- [ ] AppLayout.tsx: secondary EntityDrawer 조건부 렌더링
- [ ] DrawerShell.tsx: isSplitMode에 따른 width 조정
- [ ] TaskForm.tsx: onNavigate에 Cmd+클릭 분기 추가
- [ ] ProjectForm.tsx: onNavigate에 Cmd+클릭 분기 추가
- [ ] npm run build 통과 확인
- [ ] 수동 테스트: Cmd+클릭 시 split, 일반 클릭 시 교체

## 참고
- 기존 Drawer 아키텍처: project.md 섹션 2 (Drawer 표준)
- UiContext: `src/contexts/UiContext.tsx`
- EntityChip: `src/components/common/entity/EntityChip.tsx`
