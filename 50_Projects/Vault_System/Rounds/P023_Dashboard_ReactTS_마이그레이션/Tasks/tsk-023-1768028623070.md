---
entity_type: Task
entity_id: tsk-023-1768028623070
entity_name: Dashboard - Comment Discord 알림 추가
created: '2026-01-10'
updated: '2026-01-10'
status: done
project_id: prj-023
parent_id: prj-023
assignee: 김은향
priority: medium
start_date: '2026-01-10'
due: '2026-01-10'
aliases:
- tsk-023-1768028623070
tags: []
type: dev
target_project: loop
---

# Dashboard - Comment Discord 알림 추가

## 설명

Comment 생성 시 Discord 알림 발송 (기존 Task/Project/Program 패턴 활용)

---

## Notes

### PRD - Comment Discord 알림 추가

#### 목표
Comment 생성 시 Discord 알림 발송 (기존 Task/Project/Program 패턴 활용)

---

### Tech Spec

#### 변경 파일 (3개)

##### 1. notification_service.py
**위치**: `public/api/services/notification_service.py` 줄 13-20 (COLORS dict)
**변경**: Comment 색상 추가
```python
COLORS = {
    ...
    "Comment": 0xf1c40f,  # Yellow (새 댓글 강조)
}
```

##### 2. audit.py
**위치**: `public/api/routers/audit.py` 줄 112-113
**변경**: Comment 타입 추가
```python
if action == "create" and entity_type in ("Task", "Project", "Program", "Comment"):
```

##### 3. comments.py
**위치**: `public/api/routers/comments.py` 줄 269 (db.commit() 직후)
**변경**: log_entity_action() 호출 추가
```python
from api.routers.audit import log_entity_action

log_entity_action(
    action="create",
    entity_type="Comment",
    entity_id=str(comment.id),
    entity_name=f"Comment on {data.entity_type} {data.entity_id}",
    details={
        "target_entity": data.entity_id,
        "target_type": data.entity_type,
        "parent_id": data.parent_id
    },
    actor=f"api:{author_email}"
)
```

---

### Todo Checklist

- [ ] notification_service.py에 Comment 색상 추가
- [ ] audit.py 조건문에 Comment 타입 추가
- [ ] comments.py에 log_entity_action() 호출 추가
- [ ] /mcp-server rebuild (Docker 재배포)
- [ ] Discord 알림 수신 확인

---

### 검증 단계

1. Docker 배포: `/mcp-server rebuild`
2. API 테스트: POST /api/comments
3. Discord 알림 수신 확인

---

## 참고

- 기존 Task/Project/Program Discord 알림 패턴 참고
