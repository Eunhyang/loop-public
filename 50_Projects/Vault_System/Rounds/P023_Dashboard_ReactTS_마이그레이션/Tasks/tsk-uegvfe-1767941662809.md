---
entity_type: Task
entity_id: tsk-uegvfe-1767941662809
entity_name: Dashboard - Task Drawer PR/Commit 필드 추가
created: '2026-01-09'
updated: '2026-01-09'
status: doing
project_id: prj-023
parent_id: prj-023
assignee: 김은향
priority: medium
start_date: '2026-01-09'
due: '2026-01-09'
aliases:
- tsk-uegvfe-1767941662809
tags: []
type: dev
---

# Dashboard - Task Drawer PR/Commit 필드 추가

## 설명

dev 타입 Task의 PR/commit 연동 정보를 Dashboard Task Drawer에서 볼 수 있도록 `pr_url`, `merged_commit` 필드를 추가한다.

### 현재 문제
1. `pr_url`, `merged_commit` 필드가 Task frontmatter에는 존재하나
2. API 모델(`entities.py`)에 정의 안 됨
3. Dashboard UI(`task-panel.js`)에서 렌더링 안 됨

## Tech Spec

### 수정 대상 파일

| 파일 | 역할 | 수정 내용 |
|------|------|----------|
| `api/models/entities.py` | API 데이터 모델 | TaskUpdate, TaskCreate에 pr_url, merged_commit 추가 |
| `_dashboard/js/components/task-panel.js` | Task Drawer UI | View/Edit 모드에 필드 렌더링 |

### API 모델 수정 (`api/models/entities.py`)

**TaskCreate** (line ~17):
```python
pr_url: Optional[str] = Field(default=None, description="GitHub PR URL")
merged_commit: Optional[str] = Field(default=None, description="Merged commit SHA")
```

**TaskUpdate** (line ~35):
```python
pr_url: Optional[str] = Field(default=None, description="GitHub PR URL")
merged_commit: Optional[str] = Field(default=None, description="Merged commit SHA")
```

### Task Panel View 모드 수정 (`task-panel.js`)

**renderReadOnlyHTML()** (line ~1520)에 PR/Commit 섹션 추가:
- 모든 Task에서 값이 있을 때만 표시
- pr_url: 클릭 가능한 링크로 렌더링
- merged_commit: 짧은 해시(7자) + 복사 버튼

### Task Panel Edit 모드 수정 (`task-panel.js`)

**open()** (line ~416)과 **save()** (line ~994)에 필드 추가:
- pr_url: URL input (editable, optional)
- merged_commit: text input (editable, optional)

### UI 디자인

**View 모드:**
```
┌─────────────────────────────────┐
│ GitHub Integration              │
│ ├─ PR: #5 (클릭 시 GitHub 열림) │
│ └─ Commit: 35e76b9 [복사]       │
└─────────────────────────────────┘
```

**Edit 모드:**
```
┌─────────────────────────────────┐
│ PR URL      [https://github...] │
│ Commit SHA  [35e76b9...]        │
└─────────────────────────────────┘
```

### 결정 사항
- **Edit 권한**: 수정 가능 (사용자가 직접 입력/수정)
- **표시 조건**: 모든 Task (타입 상관없이 값이 있으면 표시)

### Codex Review 보완 사항
- **PR URL 보안**: `rel="noopener noreferrer"` 속성 필수
- **URL 검증**: UI에서 `https://` 또는 `http://` 시작 검증 (기존 `isSafeUrl()` 활용)
- **merged_commit 표시**: 7자 미만이어도 그대로 표시, 툴팁으로 전체 SHA
- **placeholder**: PR URL: "https://github.com/...", Commit SHA: "e.g., abc1234..."
- **후방 호환성**: Optional[str]이므로 자동 호환

## 체크리스트

- [ ] API 모델 수정 - TaskCreate, TaskUpdate에 pr_url, merged_commit 추가
- [ ] task-panel.js View 모드 - renderReadOnlyHTML()에 GitHub 섹션 추가
- [ ] task-panel.js Edit 모드 - open(), save()에 필드 추가
- [ ] task-panel.js Relations - GitHub 링크 표시
- [ ] 검증 - API 테스트 및 UI 확인

## 참고

- Plan 파일: `/Users/gim-eunhyang/.claude/plans/starry-meandering-babbage.md`
