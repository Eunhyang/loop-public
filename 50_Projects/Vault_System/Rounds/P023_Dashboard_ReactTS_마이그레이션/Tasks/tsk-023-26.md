---
entity_type: Task
entity_id: "tsk-023-26"
entity_name: "Dashboard - 필터 버튼 Drawer 아이콘 추가"
created: 2026-01-08
updated: 2026-01-08
status: todo

# === 계층 ===
parent_id: "prj-023"
project_id: "prj-023"
aliases: ["tsk-023-26"]

# === 관계 ===
outgoing_relations: []
validates: []
validated_by: []

# === Task 전용 ===
assignee: "김은향"
start_date: 2026-01-08
due: 2026-01-09
priority: medium
estimated_hours: 2
actual_hours: null

# === Task 유형 (dev Task 연동용) ===
type: dev
target_project: loop

# === 분류 ===
tags: ["dashboard", "filter", "drawer", "react", "ux"]
priority_flag: medium
---

# Dashboard - 필터 버튼 Drawer 아이콘 추가

> Task ID: `tsk-023-26` | Project: `prj-023` | Status: todo

## 목표

**완료 조건**:
1. Program 필터 버튼에 작은 아이콘(i) 추가 → 클릭 시 Program Drawer 열림 (view 모드)
2. Child Project 필터 버튼에 아이콘 추가 → 클릭 시 Project Drawer 열림
3. Independent Project 필터 버튼에 아이콘 추가 → 클릭 시 Project Drawer 열림
4. 버튼 클릭(필터링)과 아이콘 클릭(Drawer 열기) 동작 분리

---

## 상세 내용

### 배경

대시보드 필터 바에서 Program/Project 버튼을 클릭하면 필터링만 동작합니다. 사용자가 해당 엔티티의 상세 정보를 보려면 별도로 검색하거나 다른 경로로 접근해야 합니다.

**요청사항**:
- 필터 버튼에 작은 아이콘을 추가하여 클릭 시 해당 Program/Project의 Drawer를 바로 열 수 있게 함
- 기존 필터링 동작은 유지

### 기술 설계

**UiContext 활용**:
- `openEntityDrawer({ type: 'program' | 'project', mode: 'view', id: string })` 사용
- Drawer 시스템은 이미 구현되어 있음 (EntityDrawer, ProgramForm, ProjectForm)

**이벤트 분리**:
- 아이콘 클릭 시 `e.stopPropagation()`으로 버튼 클릭 이벤트 방지
- 버튼 본체 클릭 = 필터링, 아이콘 클릭 = Drawer 열기

---

## 체크리스트

- [ ] TaskFilterBar.tsx에 useUi import 추가
- [ ] handleOpenDrawer 핸들러 함수 추가
- [ ] Program 버튼에 drawer-icon 추가
- [ ] Child Project 버튼에 drawer-icon 추가
- [ ] Independent Project 버튼에 drawer-icon 추가
- [ ] index.css에 .drawer-icon 스타일 추가
- [ ] 빌드 확인 (npm run build)
- [ ] 기능 테스트 (필터링 vs Drawer 열기 분리 동작)

---

## Notes

### Tech Spec

```
파일 변경 목록:
├── src/features/filters/components/TaskFilterBar.tsx (수정)
├── src/index.css (수정)
└── src/styles/globals.css (수정) - btn-filter에 position: relative 추가
```

#### TaskFilterBar.tsx 수정사항

**1. Import 추가 (line 1 근처)**
```tsx
import { useUi } from '@/contexts/UiContext';
```

**2. Hook 추가 (line 40 근처)**
```tsx
const { openEntityDrawer } = useUi();
```

**3. Handler 추가 (line 152 근처)**
```tsx
// NOTE: Program/Project 모두 'edit' 모드 사용 (ProgramForm이 'view' 모드 미지원)
const handleOpenDrawer = (e: React.MouseEvent | React.KeyboardEvent, type: 'program' | 'project', id: string) => {
  e.stopPropagation();
  openEntityDrawer({ type, mode: 'edit', id });
};
```

**4. 버튼 수정 패턴 (Program/Child/Independent 동일)**
```tsx
<button className={`btn-filter ... pr-7`}>
  {name}
  <span className="filter-count">{count}</span>
  <span
    role="button"
    tabIndex={0}
    className="drawer-icon"
    onClick={(e) => handleOpenDrawer(e, 'program', id)}
    onKeyDown={(e) => e.key === 'Enter' && handleOpenDrawer(e, 'program', id)}
    aria-label={`Edit ${name}`}
    title="Edit"
  >
    i
  </span>
</button>
```

#### index.css 스타일 추가 (line 140 뒤)

```css
/* Drawer icon on filter buttons */
.drawer-icon {
  position: absolute;
  right: 4px;
  top: 50%;
  transform: translateY(-50%);
  font-size: 9px;
  font-style: italic;
  font-weight: 600;
  opacity: 0.3;
  cursor: pointer;
  padding: 1px 4px;
  border-radius: 50%;
  transition: opacity 0.15s ease, background-color 0.15s ease;
  line-height: 1;
}

.drawer-icon:hover {
  opacity: 1;
  background-color: rgba(0, 0, 0, 0.15);
}

.btn-filter-active .drawer-icon {
  opacity: 0.5;
}

.btn-filter-active .drawer-icon:hover {
  opacity: 1;
  background-color: rgba(255, 255, 255, 0.25);
}

.drawer-icon:focus-visible {
  opacity: 1;
  outline: 2px solid rgb(99, 102, 241);
  outline-offset: 1px;
}
```

#### globals.css 수정 (line 57-63)

**btn-filter에 position: relative 추가:**
```css
.btn-filter {
  @apply px-3 py-1 text-xs rounded-md transition-all duration-100 ease-in-out;
  position: relative;  /* 추가: drawer-icon 위치 기준 */
  background-color: white !important;
  /* ... 나머지 동일 ... */
}
```

### Codex Review Summary (2026-01-08)

**Critical Issues Found**: 3 (모두 해결됨)

1. **Program drawer 'view' 모드 미지원**
   - `ProgramForm`은 `mode: 'create' | 'edit'`만 지원
   - 참조: `EntityDrawer.tsx:106-114`, `ProgramForm.tsx:7-66`
   - **해결**: `mode: 'edit'` 사용으로 변경

2. **접근성 문제 (버튼 내 클릭 가능한 span)**
   - 키보드 포커스 불가, aria-label 없음
   - 참조: `TaskFilterBar.tsx:265-337`
   - **해결**: `role="button"`, `tabIndex={0}`, `aria-label`, `onKeyDown` 추가

3. **CSS 위치 지정 문제**
   - `.btn-filter`에 `position: relative` 없음
   - 참조: `globals.css:57-63`
   - **해결**: `position: relative` 추가

### Todo

- [ ] Step 1: index.css에 스타일 추가
- [ ] Step 2: TaskFilterBar.tsx에 useUi import 및 hook 추가
- [ ] Step 3: handleOpenDrawer 핸들러 추가
- [ ] Step 4: Program 버튼 수정
- [ ] Step 5: Child Project 버튼 수정
- [ ] Step 6: Independent Project 버튼 수정
- [ ] Step 7: 빌드 및 테스트

### Verification

```bash
cd /Users/gim-eunhyang/dev/loop/public/dashboard-v2 && npm run build
```

테스트 항목:
- Program 버튼 클릭 → 필터링 동작
- Program 버튼의 i 아이콘 클릭 → Program Drawer 열림 (view 모드)
- Child Project 버튼 클릭 → 필터링 동작
- Child Project 버튼의 i 아이콘 클릭 → Project Drawer 열림
- Independent Project 버튼의 i 아이콘 클릭 → Project Drawer 열림
- Active 상태 버튼에서도 아이콘 잘 보이는지 확인

### 작업 로그
<!--
작업 완료 시 아래 형식으로 기록 (workthrough 스킬 자동 생성)

#### YYYY-MM-DD HH:MM
**개요**: 2-3문장 요약

**변경사항**:
- 개발:
- 수정:
- 개선:

**핵심 코드**: (필요시)

**결과**: ✅ 빌드 성공 / ❌ 실패

**다음 단계**:
-->


---

## 참고 문서

- [[prj-023]] - 소속 Project
- `/Users/gim-eunhyang/.claude/plans/luminous-swimming-naur.md` - Plan Mode 계획
- `src/contexts/UiContext.tsx` - Drawer 제어 Context
- `src/components/layout/EntityDrawer.tsx` - Drawer 라우터 컴포넌트

---

**Created**: 2026-01-08
**Assignee**: 김은향
**Due**: 2026-01-09
