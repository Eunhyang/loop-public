---
entity_type: Task
entity_id: "tsk-023-35"
entity_name: "Dashboard - ChipSelectExpand 구현 (assignee, owner, project)"
created: 2026-01-09
updated: 2026-01-09
status: doing

# === 계층 ===
parent_id: "prj-023"
project_id: "prj-023"
aliases: ["tsk-023-35"]

# === 관계 ===
outgoing_relations: []
validates: []
validated_by: []

# === Task 전용 ===
assignee: "김은향"
start_date: 2026-01-09
due: null
priority: high
estimated_hours: null
actual_hours: null

# === Task 유형 (dev Task 연동용) ===
type: dev
target_project: loop

# === 분류 ===
tags: ["dashboard", "react", "component", "ui", "chip", "form"]
priority_flag: high
---

# Dashboard - ChipSelectExpand 구현 (assignee, owner, project)

> Task ID: `tsk-023-35` | Project: `prj-023` | Status: todo

---

## 목표

tsk-023-32에서 누락된 assignee, owner, project 필드의 Chip 구현을 완료한다.

**완료 조건**:
1. ChipSelectExpand 공통 컴포넌트 구현 (Core 멤버 Chip + 더보기 패턴)
2. TaskForm의 assignee, project 필드에 적용
3. ProjectForm의 owner 필드에 적용
4. 빌드 에러 없음

---

## Tech Spec

### 변경 파일

| 파일 | 작업 |
|------|------|
| `components/common/ChipSelectExpand.tsx` | **신규** - 더보기 패턴 컴포넌트 |
| `components/common/chipColors.ts` | 수정 - memberColor, projectColor, unassignedColor 추가 |
| `features/tasks/selectors.ts` | 수정 - CORE_ROLES export |
| `features/tasks/components/TaskForm.tsx` | 수정 - assignee, project 적용 |
| `features/projects/components/ProjectForm.tsx` | 수정 - owner 적용 |

### ChipSelectExpand Props

```typescript
interface ChipSelectExpandProps {
  primaryOptions: ChipOption[];  // Core 멤버 (항상 표시)
  allOptions: ChipOption[];      // 전체 옵션
  value: string;
  onChange: (value: string) => void;
  disabled?: boolean;
  label?: string;
  allowUnassigned?: boolean;
  unassignedLabel?: string;
  'aria-label'?: string;
}
```

### 렌더링 로직

1. Primary chips (Core 멤버) - 항상 표시
2. 선택된 Non-primary - 자동 Chip 표시
3. "+N 더보기" 버튼 - Non-primary 옵션 있을 때
4. 드롭다운 - 더보기 클릭 시 확장

### 색상 추가 (chipColors.ts)

```typescript
export const memberColor: ChipColor = {
  bg: 'bg-indigo-100',
  text: 'text-indigo-700',
  selected: 'bg-indigo-300 border-indigo-500',
};

export const projectColor: ChipColor = {
  bg: 'bg-cyan-100',
  text: 'text-cyan-700',
  selected: 'bg-cyan-300 border-cyan-500',
};

export const unassignedColor: ChipColor = {
  bg: 'bg-gray-50',
  text: 'text-gray-400',
  selected: 'bg-gray-200 border-gray-400',
};
```

### Core 멤버 정의

```typescript
export const CORE_ROLES = ['Founder', 'Cofounder', 'Member'];
```

### TaskForm vs ProjectForm 값 형식

| Form | 필드 | 저장 값 |
|------|------|---------|
| TaskForm | assignee | `m.name` (이름) |
| ProjectForm | owner | `m.id` (ID) |

---

## Todo

### Step 1: chipColors.ts 수정
- [ ] memberColor 추가
- [ ] projectColor 추가
- [ ] unassignedColor 추가

### Step 2: selectors.ts 수정
- [ ] CORE_ROLES export 추가

### Step 3: ChipSelectExpand.tsx 생성
- [ ] Props 인터페이스 정의
- [ ] Primary chips 렌더링
- [ ] 선택된 Non-primary 자동 표시
- [ ] "+N 더보기" 버튼
- [ ] 드롭다운 확장/닫힘 (외부 클릭, Escape 키)
- [ ] 접근성 (radiogroup role, keyboard navigation)

### Step 4: TaskForm.tsx 수정
- [ ] Import 추가
- [ ] memberOptions, coreMemberOptions helper
- [ ] projectOptions, primaryProjectOptions helper
- [ ] Edit Mode assignee → ChipSelectExpand
- [ ] Edit Mode project → ChipSelectExpand (6개 초과 시)
- [ ] Create Mode 동일 패턴 적용

### Step 5: ProjectForm.tsx 수정
- [ ] Import 추가
- [ ] memberOptions, coreMemberOptions helper (id 사용)
- [ ] Edit Mode owner → ChipSelectExpand
- [ ] Create Mode owner → ChipSelectExpand

### Step 6: 검증
- [ ] 빌드 확인 (`npm run build`)
- [ ] Task Drawer assignee/project 동작 확인
- [ ] Project Drawer owner 동작 확인
- [ ] Edge cases (Core만, 6개 이하, Unassigned)

---

## 주의사항

1. **기존 값 형식 유지**: TaskForm은 name, ProjectForm은 id
2. **드롭다운 동작**: 외부 클릭/Escape로 닫힘
3. **접근성**: radiogroup role, Tab/Enter/Space 지원

---

## Codex Review Suggestions (2026-01-09)

| # | 이슈 | 해결 방안 |
|---|------|----------|
| 1 | Value shape mismatch (name vs id) | 컴포넌트는 value 비교만, 형식은 호출측에서 결정 (기존 유지) |
| 2 | Unassigned flow 미정의 | value="" (empty string), allowUnassigned=true면 별도 Chip 표시 |
| 3 | primaryOptions/allOptions 관계 | primary는 all의 subset, +N 계산 시 primary 제외 |
| 4 | Keyboard/a11y 상세 | radiogroup role, Tab으로 이동, Enter/Space 선택, ESC 닫기 |
| 5 | Dropdown lifecycle | 선택 후 자동 닫힘, focus는 trigger로 반환 |
| 6 | Disabled state | dropdown 안열림, chip 보이지만 클릭 불가 |
| 7 | +N counting | N=0이면 버튼 숨김, selected non-primary는 별도 표시 |
| 8 | Layout/overflow | label truncation, dropdown은 trigger 아래 왼쪽 정렬 |
| 9 | Single select | 단일 선택만 지원 (multi-select 없음) |
| 10 | Legacy data | value가 allOptions에 없으면 그대로 표시 (fallback) |

---

## 참고 문서

- [[tsk-023-32]] - 원본 태스크 (ChipSelect 공통 모듈)
- [[prj-023]] - 소속 Project
- `dashboard-v2/src/components/common/ChipSelect.tsx` - 기존 컴포넌트
- `dashboard-v2/src/features/tasks/selectors.ts` - CORE_ROLES 정의

---

**Created**: 2026-01-09
**Assignee**: 김은향
