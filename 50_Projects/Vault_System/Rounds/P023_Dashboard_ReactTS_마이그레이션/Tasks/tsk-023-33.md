---
entity_type: Task
entity_id: "tsk-023-33"
entity_name: "Dashboard - WYSIWYG Markdown Editor 공용 컴포넌트"
created: 2026-01-09
updated: 2026-01-09
status: done
closed: 2026-01-09

# === 계층 ===
parent_id: "prj-023"
project_id: "prj-023"
aliases: ["tsk-023-33"]

# === 관계 ===
outgoing_relations: []
validates: []
validated_by: []

# === Task 전용 ===
assignee: "김은향"
start_date: 2026-01-09
due: 2026-01-09
priority: high
estimated_hours: null
actual_hours: null

# === Task 유형 (dev Task 연동용) ===
type: dev
target_project: loop

# === 분류 ===
tags: ["dashboard", "editor", "tiptap", "wysiwyg"]
priority_flag: high
---

# Dashboard - WYSIWYG Markdown Editor 공용 컴포넌트

> Task ID: `tsk-023-33` | Project: `prj-023` | Status: done

## 목표

**완료 조건**:
1. MarkdownEditor 공용 컴포넌트 생성 (`src/components/MarkdownEditor/`)
2. 노션 스타일 WYSIWYG 기능 구현 (입력 즉시 렌더링)
3. 간단한 툴바 (B/I/리스트/체크박스/테이블/코드/인용)
4. 슬래시 메뉴 (`/` 입력 시 블록 선택)
5. 테이블 기능 (삽입/행열 추가/삭제)
6. TaskForm.tsx에 적용하여 기존 notes 편집 대체
7. 마크다운 형식으로 저장 (SSOT 호환)

---

## 상세 내용

### 배경

현재 TaskForm의 notes 필드는 textarea (Edit) ↔ HTML (Preview) 토글 방식.
노션처럼 입력하면서 바로 렌더링되는 WYSIWYG 에디터가 필요.
향후 Project, Program, Hypothesis 등 다른 엔티티에서도 재사용할 수 있도록 공용 컴포넌트로 분리.

### 작업 내용

**1. 의존성 설치**
- @tiptap/react, @tiptap/starter-kit, @tiptap/extension-placeholder
- @tiptap/extension-task-list, @tiptap/extension-task-item
- @tiptap/extension-table, @tiptap/extension-table-row/cell/header
- @tiptap/suggestion, tiptap-markdown, tippy.js, use-debounce

**2. 폴더 구조**
\`\`\`
dashboard-v2/src/components/MarkdownEditor/
├── index.ts               # exports
├── MarkdownEditor.tsx     # 메인 컴포넌트
├── MenuBar.tsx            # 툴바 (B/I/리스트/테이블)
├── SlashMenu.tsx          # 슬래시 커맨드 (/)
├── TableMenu.tsx          # 테이블 컨텍스트 메뉴
├── extensions.ts          # Tiptap 확장 설정
└── styles.css             # 스타일링
\`\`\`

---

## Tech Spec

### 4.1 WYSIWYG 마크다운
- \`## 제목\` 입력 → 즉시 h2로 렌더링
- \`- \` 입력 → 즉시 리스트로 변환
- \`**bold**\`, \`*italic*\` → 즉시 스타일 적용
- \`[]\` 또는 \`[ ]\` → 체크박스로 변환
- 코드 블록 (\`\`\`) 지원
- 저장 시 순수 마크다운 형식 유지 (SSOT 호환)

### 4.2 간단한 툴바 (MenuBar)
- **B** (Bold), *I* (Italic), ~~S~~ (Strike)
- 리스트 (bullet, numbered)
- 체크박스
- 코드, 인용
- 테이블 (삽입 버튼)
- 구분선

### 4.3 슬래시 메뉴 (/)
- \`/\` 입력 시 블록 선택 메뉴 표시
- 옵션: Heading 1/2/3, Bullet List, Numbered List, Checkbox, Code Block, Quote, Table, Divider
- 키보드로 선택 가능 (↑↓ + Enter)
- 노션 스타일 UX

### 4.4 테이블 기능
- \`/table\` → 3x3 기본 테이블 삽입
- 셀 선택 시 컨텍스트 메뉴 (행/열 추가/삭제, 헤더 토글)

---

## 체크리스트

- [x] 의존성 설치 (Tiptap + extensions)
- [x] MarkdownEditor.tsx 메인 컴포넌트 구현
- [x] MenuBar.tsx 툴바 구현
- [x] SlashMenu.tsx 슬래시 커맨드 구현
- [x] TableMenu.tsx 테이블 컨텍스트 메뉴 구현
- [x] extensions.ts Tiptap 확장 설정
- [x] styles.css 에디터 스타일링
- [x] TaskForm.tsx에 MarkdownEditor 적용
- [x] EntityDrawer Save 버튼 제거 (autosave만)
- [x] 빌드 및 테스트

---

## Notes

### 작업 로그

#### 2026-01-09 02:30

**개요**: Tiptap 기반 WYSIWYG Markdown Editor 공용 컴포넌트 구현 완료

**변경사항**:
- 개발: src/components/MarkdownEditor/ 폴더 생성 (7개 파일)
  - MarkdownEditor.tsx - 메인 컴포넌트 (debounce, controlled value)
  - MenuBar.tsx - 툴바 (B/I/Strike/Lists/Table/Code)
  - SlashMenu.tsx - 슬래시 커맨드 메뉴
  - TableMenu.tsx - 테이블 컨텍스트 메뉴
  - extensions.ts - Tiptap 확장 설정
  - styles.css - 에디터 스타일
  - index.ts - exports
- 수정: TaskForm.tsx - MarkdownEditor 적용, textarea/preview 토글 제거
- 수정: EntityDrawer.tsx - Save 버튼 제거 (autosave만 사용)
- 개선: forwardRef/useImperativeHandle 제거 (불필요해짐)

**핵심 코드**:
- MarkdownEditor: 300ms debounce + blur시 flush로 데이터 손실 방지
- isProgrammaticUpdate flag로 save loop 방지
- tiptap-markdown으로 마크다운 형식 유지

**결과**: ✅ 빌드 성공 (번들 +1.04MB)

**Codex Review**:
- Phase 2: 7개 아키텍처 이슈 식별
- Phase 5: 4개 HIGH 버그 발견 → 모두 수정됨
- Phase 6: 재검증 통과

---

## 참고 문서

- [[prj-023]] - 소속 Project
- Plan file: \`/Users/gim-eunhyang/.claude/plans/wobbly-scribbling-harp.md\`

---

**Created**: 2026-01-09
**Assignee**: 김은향
**Closed**: 2026-01-09
