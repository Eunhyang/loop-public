---
entity_type: Task
entity_id: tsk-023-42
entity_name: Dashboard - ProjectForm View 모드 리팩토링
created: 2026-01-09
updated: 2026-01-09
status: todo
project_id: prj-023
assignee: 김은향
type: dev
priority: medium
start_date: null
due: null
validates: []
links: []
notes: ""
tags:
- task
- dashboard
- projectform
- refactoring
- view-mode
---
# Dashboard - ProjectForm View 모드 리팩토링

> Task ID: `tsk-023-42` | Project: [[prj-023]] | Status: todo

## Summary

ProjectForm의 view 모드를 TaskForm 패턴에 맞춰 리팩토링하여 Tasks, Description 등 모든 섹션이 read-only로 표시되도록 수정

---

## Tech Spec

### 문제
- **현재**: view 모드가 별도 early return으로 분리되어 Tasks, Description, Track Link 누락
- **원인**: TaskForm과 다른 아키텍처 패턴 사용
- **영향**: view 모드에서 정보 부족

### 해결 방안
TaskForm의 `isReadOnly` 패턴 적용 (공통 모듈 불필요)

### 수정 파일
- `public/dashboard-v2/src/features/projects/components/ProjectForm.tsx`

### 아키텍처 변경

**Before (현재 구조)**:
```
ProjectForm
├── mode === 'view' → early return (별도 UI, 기능 제한)
├── mode === 'edit' → 전체 기능 (Tasks, Description 포함)
└── mode === 'create' → 생성 폼
```

**After (목표 구조)**:
```
ProjectForm
├── mode === 'create' → 생성 폼
└── mode !== 'create' → 통합 UI
    └── isReadOnly = (mode === 'view')
        ├── 읽기 전용: span, disabled 컨트롤
        └── 편집 가능: input, select, textarea
```

---

## isReadOnly 필드별 동작 명세 (Codex 피드백 반영)

| 필드 | isReadOnly=true (view) | isReadOnly=false (edit) |
|------|------------------------|-------------------------|
| Title | `<h2>` 텍스트 | `<input>` 편집 가능 |
| Status | `<span>` 배지 | `<select>` 선택 가능 |
| Owner | `<span>` 텍스트 | `<ChipSelectExpand>` |
| Priority | `<span>` 배지 | `<select>` 선택 가능 |
| Track | `<span>` (클릭 시 Track drawer) | `<select>` 선택 가능 |
| Program | `<span>` 텍스트 | `<select>` 선택 가능 |
| Tasks 섹션 | 표시 + 클릭 시 Task drawer 열기만 | 동일 |
| Hypothesis | `<p>` 텍스트 | `<textarea>` 편집 가능 |
| Description | `<MarkdownEditor readOnly>` | `<MarkdownEditor>` 편집 가능 |

### Tasks 섹션 상호작용 (view 모드)
- **허용**: Task 클릭 → Task drawer 열기 (읽기 전용)
- **금지**: 드래그 재정렬, 완료 토글, 인라인 편집

### MarkdownEditor readOnly 동작
- 툴바: 숨김
- 드래그/드롭: 비활성화
- 이미지 붙여넣기: 비활성화
- 링크: 클릭 가능 (새 탭, `rel="noopener noreferrer"`)

### 버튼/액션 처리 (view 모드)
- **Save 버튼**: 해당 없음 (autosave 패턴)
- **Delete 버튼**: EntityDrawer footer에서 `mode !== 'edit'`일 때 숨김 (이미 구현됨)

---

## Todo (Implementation Steps)

### Step 1: isReadOnly 플래그 추가
```tsx
// line 24 근처에 추가
const isReadOnly = mode === 'view';
```

### Step 2: View 모드 early return 제거
- **삭제**: lines 121-208 (view 모드 별도 블록 전체)

### Step 3: Edit 모드 로딩 조건 수정
```tsx
// Before
if (mode === 'edit') {
    if (isLoadingProject || !project) { ... }
}

// After - view/edit 통합
if (mode !== 'create') {
    if (isLoadingProject || !project) {
        return <Loading />;
    }
}
```

### Step 4: Edit 모드 조건 변경 및 isReadOnly 분기 적용
- `if (mode === 'edit')` → `if (mode !== 'create')`
- 각 필드에 isReadOnly 조건부 렌더링 적용 (위 표 참조)

### Step 5: Tasks 섹션 항상 표시
- 기존 Edit 모드의 Tasks 섹션 (lines 378-455) 유지
- view 모드에서도 동일하게 표시
- Task 클릭 시 `openEntityDrawer({ type: 'task', mode: 'view', id })` 호출

### Step 6: MarkdownEditor readOnly prop 활용
```tsx
<MarkdownEditor
    value={(project as any)._body || ''}
    onChange={(markdown) => !isReadOnly && handleUpdate('body', markdown)}
    readOnly={isReadOnly}
    minHeight="200px"
    placeholder="프로젝트 설명을 작성하세요..."
/>
```

---

## Loading/Error/Empty 상태 처리

| 상태 | view 모드 동작 |
|------|---------------|
| Loading | "Loading..." 스피너 표시 (기존 edit 동일) |
| Error (project not found) | "Project not found" 메시지 |
| Tasks 없음 | "No tasks in this project" 플레이스홀더 (기존 edit 동일) |
| Description 비어있음 | 빈 MarkdownEditor (readOnly, placeholder 없음) |

---

## Expected Changes

| 섹션 | Before (view) | After (view) |
|------|---------------|--------------|
| 기본 정보 | O | O |
| Tasks 섹션 | X | O (클릭 → drawer 열기) |
| Hypothesis | O (읽기) | O (읽기) |
| Description | X | O (읽기) |
| Track Link | X | O (클릭 → drawer 열기) |

### 예상 코드 변경량
- 삭제: ~90 lines (view 모드 early return 블록)
- 추가/수정: ~30 lines (isReadOnly 조건부 렌더링)
- 순 변경: -60 lines (코드 감소)

---

## Verification

1. **빌드 확인**
   ```bash
   cd public/dashboard-v2 && npm run build
   ```

2. **수동 테스트**
   - Dashboard에서 Project를 view 모드로 열기
   - Tasks 섹션 표시 확인
   - Task 클릭 시 Task drawer 열리는지 확인 (view 모드로)
   - Description 표시 확인 (편집 불가, 링크 클릭 가능)
   - Track Link 클릭 동작 확인

3. **모드별 동작 확인**
   - `mode='create'`: 기존대로 생성 폼
   - `mode='edit'`: 기존대로 편집 가능, Delete 버튼 표시
   - `mode='view'`: 모든 섹션 읽기 전용, Delete 버튼 숨김

4. **엣지 케이스**
   - 빈 Tasks 목록에서 플레이스홀더 표시 확인
   - 빈 Description에서 빈 영역 표시 확인
   - Loading 상태에서 스피너 표시 확인

---

## Codex Review Summary

**Critical Issues Found**: 0 (모두 명세 보완으로 해결)

**Suggestions Incorporated**:
1. 필드별 isReadOnly 동작 명세 추가
2. Tasks 섹션 허용/금지 상호작용 정의
3. MarkdownEditor readOnly 상세 동작 정의
4. Loading/Error/Empty 상태 처리 명시
5. 버튼/액션 처리 (Delete 숨김) 명시
