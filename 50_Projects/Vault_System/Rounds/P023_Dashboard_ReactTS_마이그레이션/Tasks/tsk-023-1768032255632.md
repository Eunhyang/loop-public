---
entity_type: Task
entity_id: tsk-023-1768032255632
entity_name: Dashboard - Favorites 기능 확장 (Task + Project + Program)
created: '2026-01-10'
updated: '2026-01-10'
status: done
project_id: prj-023
parent_id: prj-023
assignee: 김은향
priority: medium
start_date: '2026-01-10'
due: '2026-01-10'
aliases:
- tsk-023-1768032255632
tags:
- favorites
- drawer
type: dev
target_project: loop
notes: "# Dashboard - Favorites 기능 확장 (Task + Project + Program)\n\n## 설명\n\n현재 Task만\
  \ 지원하는 즐겨찾기 기능을 Project, Program까지 확장하고, DrawerShell 헤더에 즐겨찾기 버튼을 추가한다.\n\n---\n\
  \n## Notes\n\n### PRD - Favorites 기능 확장 (Task + Project + Program)\n\nSummary\n\n\
  현재 Dashboard의 즐겨찾기 기능은 Task 엔티티만 지원하고 있다. 이 태스크에서는 다음을 구현한다:\n\n1. **Entity Type\
  \ 확장**: Task, Project, Program 3가지 엔티티 타입 지원\n2. **Storage Schema 업그레이드**: v1(taskIds)\
  \ → v2(entityIds by type) 마이그레이션\n3. **DrawerShell 통합**: 모든 Drawer 헤더에 즐겨찾기 별 버튼\
  \ 추가\n4. **FavoritesStrip 확장**: 엔티티 타입별 색상 구분 표시\n\n---\n\n### Tech Spec\n\nArchitecture\n\
  \n```\nfeatures/favorites/\n├── types.ts                  # EntityType 타입 추가\n├──\
  \ constants.ts              # SCHEMA_VERSION 2 업그레이드\n├── store/\n│   └── favoritesStore.ts\
  \     # v1→v2 마이그레이션 + type별 관리\n├── hooks/\n│   └── useFavorites.ts       # entityType\
  \ 파라미터 추가\n├── components/\n│   ├── FavoriteStarButton.tsx  # entityId + entityType\
  \ props\n│   ├── FavoriteCard.tsx        # entity + entityType props\n│   └── FavoritesStrip.tsx\
  \      # 3가지 type 표시\n└── index.ts                  # EntityType export\n\ncomponents/common/\n\
  └── DrawerShell.tsx           # FavoriteStarButton 통합\n```\n\nData Schema\n\n**Before\
  \ (v1)**:\n\n```typescript\ninterface FavoritesStorage {\n  _schemaVersion: number;\n\
  \  taskIds: string[];\n}\n```\n\n**After (v2)**:\n\n```typescript\ntype EntityType\
  \ = 'task' | 'project' | 'program';\n\ninterface FavoritesStorage {\n  _schemaVersion:\
  \ number;\n  entityIds: {\n    task: string[];\n    project: string[];\n    program:\
  \ string[];\n  };\n}\n```\n\nEntity Type별 색상 (Notion 스타일)\n\n| Entity Type | Star\
  \ Color | Badge/Border |\n| --- | --- | --- |\n| Task | Amber (#FCD34D) | amber-100\
  \ border |\n| Project | Blue (#60A5FA) | blue-100 border |\n| Program | Purple (#A78BFA)\
  \ | purple-100 border |\n\nComponents to Modify\n\n| 파일 | 변경 내용 |\n| --- | --- |\n\
  | `features/favorites/types.ts` | EntityType 추가, entityIds 구조 변경 |\n| `features/favorites/constants.ts`\
  \ | SCHEMA_VERSION 2로 업그레이드 |\n| `features/favorites/store/favoritesStore.ts` |\
  \ entity type별 관리 + v1→v2 마이그레이션 |\n| `features/favorites/hooks/useFavorites.ts`\
  \ | entityType 파라미터 추가 |\n| `features/favorites/components/FavoriteStarButton.tsx`\
  \ | entityId + entityType props |\n| `features/favorites/components/FavoriteCard.tsx`\
  \ | entity + entityType props, 색상 분기 |\n| `features/favorites/components/FavoritesStrip.tsx`\
  \ | 3가지 entity type 표시, 색상 구분 |\n| `features/favorites/index.ts` | EntityType export\
  \ 추가 |\n| `components/common/DrawerShell.tsx` | FavoriteStarButton 추가 + props 확장\
  \ |\n\n---\n\n### Implementation Steps\n\nStep 1: types.ts 수정\n\n- [ ] `EntityType`\
  \ 타입 정의 추가 (`'task' | 'project' | 'program'`)\n\n- [ ] `FavoritesStorage` 인터페이스\
  \ 변경 (`taskIds` → `entityIds`)\n\nStep 2: constants.ts 수정\n\n- [ ] `FAVORITES_SCHEMA_VERSION`\
  \ 1 → 2 변경\n\n- [ ] `MAX_FAVORITES_PER_TYPE` 상수 추가 (타입별 최대 20개)\n\nStep 3: favoritesStore.ts\
  \ 수정\n\n- [ ] `migrateV1toV2()` 마이그레이션 함수 구현\n\n- [ ] `toggleFavorite(taskId)` →\
  \ `toggleFavorite(entityId, entityType)` 시그니처 변경\n\n- [ ] `isFavorited(taskId)`\
  \ → `isFavorited(entityId, entityType)` 시그니처 변경\n\n- [ ] `pruneFavorites(validTaskIds)`\
  \ → `pruneFavorites(validIds, entityType)` 시그니처 변경\n\n- [ ] `getSnapshot()` → `getSnapshot(entityType)`\
  \ 시그니처 변경\n\n- [ ] 앱 초기화 시 자동 마이그레이션 로직 추가\n\nStep 4: useFavorites.ts 수정\n\n- [\
  \ ] `UseFavoritesReturn` 인터페이스 업데이트\n\n- [ ] 모든 함수에 `entityType` 파라미터 추가\n\nStep\
  \ 5: FavoriteStarButton.tsx 수정\n\n- [ ] Props에 `entityType` 추가 (`taskId` → `entityId`)\n\
  \n- [ ] 클릭 핸들러에서 `entityType` 전달\n\nStep 6: FavoriteCard.tsx 수정\n\n- [ ] Props에\
  \ `entity`, `entityType` 추가\n\n- [ ] 타입별 색상 매핑 (`colorMap`) 구현\n\n- [ ] 아이콘/스타일\
  \ 분기 처리\n\nStep 7: FavoritesStrip.tsx 수정\n\n- [ ] Props에 `tasks`, `projects`, `programs`\
  \ 추가\n\n- [ ] `onTaskClick` → `onEntityClick(entityId, entityType)` 변경\n\n- [ ]\
  \ 렌더링 순서: Program → Project → Task\n\n- [ ] 타입별 색상/아이콘 구분\n\nStep 8: index.ts export\
  \ 업데이트\n\n- [ ] `EntityType` export 추가\n\nStep 9: DrawerShell.tsx 수정\n\n- [ ] Props에\
  \ `entityId`, `entityType` 추가\n\n- [ ] 헤더에 `FavoriteStarButton` 추가 (Expand 버튼 왼쪽)\n\
  \n---\n\n### Verification / Testing\n\n1\\. localStorage 마이그레이션 테스트\n\n```javascript\n\
  // 테스트 전: v1 데이터 설정\nlocalStorage.setItem('loop_favorites', JSON.stringify({\n \
  \ _schemaVersion: 1,\n  taskIds: ['tsk-023-01', 'tsk-023-02']\n}));\n\n// 페이지 새로고침\
  \ 후 확인\nconst result = JSON.parse(localStorage.getItem('loop_favorites'));\nconsole.log(result);\n\
  // Expected: {\n//   _schemaVersion: 2,\n//   entityIds: {\n//     task: ['tsk-023-01',\
  \ 'tsk-023-02'],\n//     project: [],\n//     program: []\n//   }\n// }\n```\n\n\
  2\\. Drawer 즐겨찾기 동작 확인\n\n- [ ] Task Drawer 열기 → 헤더 ★ 버튼 클릭 → amber 색상으로 변경 확인\n\
  \n- [ ] Project Drawer 열기 → 헤더 ★ 버튼 클릭 → blue 색상으로 변경 확인\n\n- [ ] Program Drawer\
  \ 열기 → 헤더 ★ 버튼 클릭 → purple 색상으로 변경 확인\n\n- [ ] 각 타입이 별도 배열에 저장되는지 확인\n\n3\\. FavoritesStrip\
  \ 표시 확인\n\n- [ ] Program → Project → Task 순서로 표시되는지 확인\n\n- [ ] 각 타입별 색상이 올바르게 적용되는지\
  \ 확인\n\n- [ ] 엔티티 클릭 시 해당 Drawer가 열리는지 확인\n\n4\\. localStorage 최종 확인\n\n```javascript\n\
  JSON.parse(localStorage.getItem('loop_favorites'))\n// Expected: {\n//   _schemaVersion:\
  \ 2,\n//   entityIds: {\n//     task: [...],\n//     project: [...],\n//     program:\
  \ [...]\n//   }\n// }\n```\n\n---\n\n### 예상 소요\n\n- 파일 수정: 9개\n- 예상 작업 시간: 2-3시간\n\
  \n---\n\n## 참고\n\n- Plan 파일: `~/.claude/plans/smooth-skipping-balloon.md`\n- 기존\
  \ Favorites 구현: `features/favorites/`\n- DrawerShell 컴포넌트: `components/common/DrawerShell.tsx`"
---
# Dashboard - Favorites 기능 확장 (Task + Project + Program)

## 설명

현재 Task만 지원하는 즐겨찾기 기능을 Project, Program까지 확장하고, DrawerShell 헤더에 즐겨찾기 버튼을 추가한다.

---

## Notes

### PRD - Favorites 기능 확장 (Task + Project + Program)

#### Summary

현재 Dashboard의 즐겨찾기 기능은 Task 엔티티만 지원하고 있다. 이 태스크에서는 다음을 구현한다:

1. **Entity Type 확장**: Task, Project, Program 3가지 엔티티 타입 지원
2. **Storage Schema 업그레이드**: v1(taskIds) → v2(entityIds by type) 마이그레이션
3. **DrawerShell 통합**: 모든 Drawer 헤더에 즐겨찾기 별 버튼 추가
4. **FavoritesStrip 확장**: 엔티티 타입별 색상 구분 표시

---

### Tech Spec

#### Architecture

```
features/favorites/
├── types.ts                  # EntityType 타입 추가
├── constants.ts              # SCHEMA_VERSION 2 업그레이드
├── store/
│   └── favoritesStore.ts     # v1→v2 마이그레이션 + type별 관리
├── hooks/
│   └── useFavorites.ts       # entityType 파라미터 추가
├── components/
│   ├── FavoriteStarButton.tsx  # entityId + entityType props
│   ├── FavoriteCard.tsx        # entity + entityType props
│   └── FavoritesStrip.tsx      # 3가지 type 표시
└── index.ts                  # EntityType export

components/common/
└── DrawerShell.tsx           # FavoriteStarButton 통합
```

#### Data Schema

**Before (v1)**:
```typescript
interface FavoritesStorage {
  _schemaVersion: number;
  taskIds: string[];
}
```

**After (v2)**:
```typescript
type EntityType = 'task' | 'project' | 'program';

interface FavoritesStorage {
  _schemaVersion: number;
  entityIds: {
    task: string[];
    project: string[];
    program: string[];
  };
}
```

#### Entity Type별 색상 (Notion 스타일)

| Entity Type | Star Color | Badge/Border |
|-------------|------------|--------------|
| Task | Amber (#FCD34D) | amber-100 border |
| Project | Blue (#60A5FA) | blue-100 border |
| Program | Purple (#A78BFA) | purple-100 border |

#### Components to Modify

| 파일 | 변경 내용 |
|------|----------|
| `features/favorites/types.ts` | EntityType 추가, entityIds 구조 변경 |
| `features/favorites/constants.ts` | SCHEMA_VERSION 2로 업그레이드 |
| `features/favorites/store/favoritesStore.ts` | entity type별 관리 + v1→v2 마이그레이션 |
| `features/favorites/hooks/useFavorites.ts` | entityType 파라미터 추가 |
| `features/favorites/components/FavoriteStarButton.tsx` | entityId + entityType props |
| `features/favorites/components/FavoriteCard.tsx` | entity + entityType props, 색상 분기 |
| `features/favorites/components/FavoritesStrip.tsx` | 3가지 entity type 표시, 색상 구분 |
| `features/favorites/index.ts` | EntityType export 추가 |
| `components/common/DrawerShell.tsx` | FavoriteStarButton 추가 + props 확장 |

---

### Implementation Steps

#### Step 1: types.ts 수정
- [ ] `EntityType` 타입 정의 추가 (`'task' | 'project' | 'program'`)
- [ ] `FavoritesStorage` 인터페이스 변경 (`taskIds` → `entityIds`)

#### Step 2: constants.ts 수정
- [ ] `FAVORITES_SCHEMA_VERSION` 1 → 2 변경
- [ ] `MAX_FAVORITES_PER_TYPE` 상수 추가 (타입별 최대 20개)

#### Step 3: favoritesStore.ts 수정
- [ ] `migrateV1toV2()` 마이그레이션 함수 구현
- [ ] `toggleFavorite(taskId)` → `toggleFavorite(entityId, entityType)` 시그니처 변경
- [ ] `isFavorited(taskId)` → `isFavorited(entityId, entityType)` 시그니처 변경
- [ ] `pruneFavorites(validTaskIds)` → `pruneFavorites(validIds, entityType)` 시그니처 변경
- [ ] `getSnapshot()` → `getSnapshot(entityType)` 시그니처 변경
- [ ] 앱 초기화 시 자동 마이그레이션 로직 추가

#### Step 4: useFavorites.ts 수정
- [ ] `UseFavoritesReturn` 인터페이스 업데이트
- [ ] 모든 함수에 `entityType` 파라미터 추가

#### Step 5: FavoriteStarButton.tsx 수정
- [ ] Props에 `entityType` 추가 (`taskId` → `entityId`)
- [ ] 클릭 핸들러에서 `entityType` 전달

#### Step 6: FavoriteCard.tsx 수정
- [ ] Props에 `entity`, `entityType` 추가
- [ ] 타입별 색상 매핑 (`colorMap`) 구현
- [ ] 아이콘/스타일 분기 처리

#### Step 7: FavoritesStrip.tsx 수정
- [ ] Props에 `tasks`, `projects`, `programs` 추가
- [ ] `onTaskClick` → `onEntityClick(entityId, entityType)` 변경
- [ ] 렌더링 순서: Program → Project → Task
- [ ] 타입별 색상/아이콘 구분

#### Step 8: index.ts export 업데이트
- [ ] `EntityType` export 추가

#### Step 9: DrawerShell.tsx 수정
- [ ] Props에 `entityId`, `entityType` 추가
- [ ] 헤더에 `FavoriteStarButton` 추가 (Expand 버튼 왼쪽)

---

### Verification / Testing

#### 1. localStorage 마이그레이션 테스트

```javascript
// 테스트 전: v1 데이터 설정
localStorage.setItem('loop_favorites', JSON.stringify({
  _schemaVersion: 1,
  taskIds: ['tsk-023-01', 'tsk-023-02']
}));

// 페이지 새로고침 후 확인
const result = JSON.parse(localStorage.getItem('loop_favorites'));
console.log(result);
// Expected: {
//   _schemaVersion: 2,
//   entityIds: {
//     task: ['tsk-023-01', 'tsk-023-02'],
//     project: [],
//     program: []
//   }
// }
```

#### 2. Drawer 즐겨찾기 동작 확인

- [ ] Task Drawer 열기 → 헤더 ★ 버튼 클릭 → amber 색상으로 변경 확인
- [ ] Project Drawer 열기 → 헤더 ★ 버튼 클릭 → blue 색상으로 변경 확인
- [ ] Program Drawer 열기 → 헤더 ★ 버튼 클릭 → purple 색상으로 변경 확인
- [ ] 각 타입이 별도 배열에 저장되는지 확인

#### 3. FavoritesStrip 표시 확인

- [ ] Program → Project → Task 순서로 표시되는지 확인
- [ ] 각 타입별 색상이 올바르게 적용되는지 확인
- [ ] 엔티티 클릭 시 해당 Drawer가 열리는지 확인

#### 4. localStorage 최종 확인

```javascript
JSON.parse(localStorage.getItem('loop_favorites'))
// Expected: {
//   _schemaVersion: 2,
//   entityIds: {
//     task: [...],
//     project: [...],
//     program: [...]
//   }
// }
```

---

### 예상 소요

- 파일 수정: 9개
- 예상 작업 시간: 2-3시간

---

## 참고

- Plan 파일: `~/.claude/plans/smooth-skipping-balloon.md`
- 기존 Favorites 구현: `features/favorites/`
- DrawerShell 컴포넌트: `components/common/DrawerShell.tsx`
