---
entity_type: Task
entity_id: tsk-023-1768156139268
entity_name: Schema - Collaboration Fields 공통 모듈화
created: '2026-01-12'
updated: '2026-01-16'
status: done
parent_id: prj-023
project_id: prj-023
aliases:
- tsk-023-1768156139268
outgoing_relations: []
validates: []
validated_by: []
assignee: 김은향
start_date: '2026-01-12'
due: '2026-01-12'
priority: high
estimated_hours: null
actual_hours: null
type: dev
target_project: loop
tags:
- schema
- collaboration
- refactoring
priority_flag: high
closed: null
notes: "# Schema - Collaboration Fields 공통 모듈화\n\n> Task ID: `tsk-023-1768156139268`\
  \ | Project: `prj-023` | Status: doing\n\n## PRD (from Plan Mode - User Approved)\n\
  \n> **Task**: prj-023에서 발견된 문제 해결 - Task에만 있는 협업 필드들을 모든 엔티티가 사용할 수 있도록 공통 모듈로 분리\n\
  \n---\n\n## 현황 분석\n\n### 현재 스키마 구조 (schema_constants.yaml)\n\n```yaml\nknown_fields:\n\
  \  all:  # 모든 엔티티 공통\n    - entity_type, entity_id, entity_name, created, updated,\
  \ status, parent_id, aliases...\n\n  Project:\n    - links  # 정의만 있고 템플릿에서 미사용\n\
  \n  Task:\n    - notes  # Task 전용\n    - links  # Task 전용\n```\n\n### 문제점\n\n| 필드\
  \ | Project | Task | 다른 엔티티 | 문제 |\n| --- | --- | --- | --- | --- |\n| `notes` |\
  \ X | O | X | Task만 사용 가능 |\n| `links` | 정의만 | O | X | 중복 정의, 실제 사용 안 함 |\n| `attachments`\
  \ | X | X | X | 스키마 미정의 |\n\n---\n\n## 설계: Collaboration Fields 공통 모듈\n\n### 목표\
  \ 구조\n\n```yaml\n# schema_constants.yaml v5.5\n\n# === 신규 섹션 ===\ncollaboration_fields:\n\
  \  - notes         # 단일 텍스트 (마크다운)\n  - links         # [{label, url}]\n  - attachments\
  \   # [{name, path, type, uploaded}]\n\nknown_fields:\n  all:\n    # 기존 공통 필드...\n\
  \    # === 협업 필드 통합 (모든 엔티티 사용 가능) ===\n    - notes\n    - links\n    - attachments\n\
  \n  Project:\n    # links 제거 (all로 이동)\n\n  Task:\n    # notes, links 제거 (all로 이동)\n\
  \nfield_structures:\n  # 기존 links 구조 유지\n  links:\n    fields:\n      - label: string\n\
  \      - url: string\n\n  # === 신규: attachments 구조 ===\n  attachments:\n    fields:\n\
  \      - name: string       # 파일명\n      - path: string       # 상대 경로 또는 URL\n \
  \     - type: string       # image | document | video | other\n      - uploaded:\
  \ date     # 업로드일\n```\n\n---\n\n## 구현 계획\n\n### Step 1: 스키마 수정 (schema_constants.yaml)\n\
  \n1. `collaboration_fields` 섹션 추가\n2. `known_fields.all`에 notes, links, attachments\
  \ 추가\n3. `known_fields.Project`에서 `links` 제거\n4. `known_fields.Task`에서 `notes`,\
  \ `links` 제거\n5. `field_structures.attachments` 구조 정의 추가\n6. `schema_version` →\
  \ `5.5` 업데이트\n\n### Step 2: 템플릿 수정\n\n- `template_project.md`: 협업 필드 추가\n- `template_task.md`:\
  \ 협업 필드 추가\n- `template_hypothesis.md`: 협업 필드 추가\n\n### Step 3: API 모델 수정 (entities.py)\n\
  \n- `Attachment` 클래스 추가\n- TaskCreate/TaskUpdate에 attachments 필드 추가\n- ProjectUpdate에\
  \ attachments 필드 추가\n\n---\n\n## Notes\n\n### Execution Log\n\n(작업 진행 중)"
links: []
attachments: []
---
# Schema - Collaboration Fields 공통 모듈화

> Task ID: `tsk-023-1768156139268` | Project: `prj-023` | Status: doing

## PRD (from Plan Mode - User Approved)

> **Task**: prj-023에서 발견된 문제 해결 - Task에만 있는 협업 필드들을 모든 엔티티가 사용할 수 있도록 공통 모듈로 분리

---

## 현황 분석

### 현재 스키마 구조 (schema_constants.yaml)
```yaml
known_fields:
  all:  # 모든 엔티티 공통
    - entity_type, entity_id, entity_name, created, updated, status, parent_id, aliases...

  Project:
    - links  # 정의만 있고 템플릿에서 미사용

  Task:
    - notes  # Task 전용
    - links  # Task 전용
```

### 문제점
| 필드 | Project | Task | 다른 엔티티 | 문제 |
|------|---------|------|-------------|------|
| `notes` | X | O | X | Task만 사용 가능 |
| `links` | 정의만 | O | X | 중복 정의, 실제 사용 안 함 |
| `attachments` | X | X | X | 스키마 미정의 |

---

## 설계: Collaboration Fields 공통 모듈

### 목표 구조
```yaml
# schema_constants.yaml v5.5

# === 신규 섹션 ===
collaboration_fields:
  - notes         # 단일 텍스트 (마크다운)
  - links         # [{label, url}]
  - attachments   # [{name, path, type, uploaded}]

known_fields:
  all:
    # 기존 공통 필드...
    # === 협업 필드 통합 (모든 엔티티 사용 가능) ===
    - notes
    - links
    - attachments

  Project:
    # links 제거 (all로 이동)

  Task:
    # notes, links 제거 (all로 이동)

field_structures:
  # 기존 links 구조 유지
  links:
    fields:
      - label: string
      - url: string

  # === 신규: attachments 구조 ===
  attachments:
    fields:
      - name: string       # 파일명
      - path: string       # 상대 경로 또는 URL
      - type: string       # image | document | video | other
      - uploaded: date     # 업로드일
```

---

## 구현 계획

### Step 1: 스키마 수정 (schema_constants.yaml)
1. `collaboration_fields` 섹션 추가
2. `known_fields.all`에 notes, links, attachments 추가
3. `known_fields.Project`에서 `links` 제거
4. `known_fields.Task`에서 `notes`, `links` 제거
5. `field_structures.attachments` 구조 정의 추가
6. `schema_version` → `5.5` 업데이트

### Step 2: 템플릿 수정
- `template_project.md`: 협업 필드 추가
- `template_task.md`: 협업 필드 추가
- `template_hypothesis.md`: 협업 필드 추가

### Step 3: API 모델 수정 (entities.py)
- `Attachment` 클래스 추가
- TaskCreate/TaskUpdate에 attachments 필드 추가
- ProjectUpdate에 attachments 필드 추가

---

## Notes

### Execution Log

(작업 진행 중)
