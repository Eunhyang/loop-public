---
entity_type: Task
entity_id: "tsk-023-1768156139268"
entity_name: "Schema - Collaboration Fields 공통 모듈화"
created: "2026-01-12"
updated: "2026-01-12"
status: doing

# === 계층 ===
parent_id: prj-023
project_id: prj-023
aliases:
  - tsk-023-1768156139268

# === 관계 ===
outgoing_relations: []
validates: []
validated_by: []

# === Task 정보 ===
assignee: "김은향"
start_date: "2026-01-12"
due: null
priority: high
estimated_hours: null
actual_hours: null

# === Task 유형 ===
type: dev
target_project: loop

# === 분류 ===
tags:
  - schema
  - collaboration
  - refactoring
priority_flag: high

# === 상태 ===
closed: null
notes: null
links: []
attachments: []
---

# Schema - Collaboration Fields 공통 모듈화

> Task ID: `tsk-023-1768156139268` | Project: `prj-023` | Status: doing

## PRD (from Plan Mode - User Approved)

> **Task**: prj-023에서 발견된 문제 해결 - Task에만 있는 협업 필드들을 모든 엔티티가 사용할 수 있도록 공통 모듈로 분리

---

## 현황 분석

### 현재 스키마 구조 (schema_constants.yaml)
```yaml
known_fields:
  all:  # 모든 엔티티 공통
    - entity_type, entity_id, entity_name, created, updated, status, parent_id, aliases...

  Project:
    - links  # 정의만 있고 템플릿에서 미사용

  Task:
    - notes  # Task 전용
    - links  # Task 전용
```

### 문제점
| 필드 | Project | Task | 다른 엔티티 | 문제 |
|------|---------|------|-------------|------|
| `notes` | X | O | X | Task만 사용 가능 |
| `links` | 정의만 | O | X | 중복 정의, 실제 사용 안 함 |
| `attachments` | X | X | X | 스키마 미정의 |

---

## 설계: Collaboration Fields 공통 모듈

### 목표 구조
```yaml
# schema_constants.yaml v5.5

# === 신규 섹션 ===
collaboration_fields:
  - notes         # 단일 텍스트 (마크다운)
  - links         # [{label, url}]
  - attachments   # [{name, path, type, uploaded}]

known_fields:
  all:
    # 기존 공통 필드...
    # === 협업 필드 통합 (모든 엔티티 사용 가능) ===
    - notes
    - links
    - attachments

  Project:
    # links 제거 (all로 이동)

  Task:
    # notes, links 제거 (all로 이동)

field_structures:
  # 기존 links 구조 유지
  links:
    fields:
      - label: string
      - url: string

  # === 신규: attachments 구조 ===
  attachments:
    fields:
      - name: string       # 파일명
      - path: string       # 상대 경로 또는 URL
      - type: string       # image | document | video | other
      - uploaded: date     # 업로드일
```

---

## 구현 계획

### Step 1: 스키마 수정 (schema_constants.yaml)
1. `collaboration_fields` 섹션 추가
2. `known_fields.all`에 notes, links, attachments 추가
3. `known_fields.Project`에서 `links` 제거
4. `known_fields.Task`에서 `notes`, `links` 제거
5. `field_structures.attachments` 구조 정의 추가
6. `schema_version` → `5.5` 업데이트

### Step 2: 템플릿 수정
- `template_project.md`: 협업 필드 추가
- `template_task.md`: 협업 필드 추가
- `template_hypothesis.md`: 협업 필드 추가

### Step 3: API 모델 수정 (entities.py)
- `Attachment` 클래스 추가
- TaskCreate/TaskUpdate에 attachments 필드 추가
- ProjectUpdate에 attachments 필드 추가

---

## Notes

### Execution Log

(작업 진행 중)
