---
entity_type: Task
entity_id: "tsk-023-14"
entity_name: "Dashboard - Command Palette (Cmd+P)"
created: 2026-01-08
updated: 2026-01-08
status: doing

# === 계층 ===
parent_id: "prj-023"
project_id: "prj-023"
aliases: ["tsk-023-14"]

# === 관계 ===
outgoing_relations: []
validates: []
validated_by: []

# === Task 전용 ===
assignee: "김은향"
start_date: 2026-01-08
due: 2026-01-08
priority: high
estimated_hours: null
actual_hours: null

# === Task 유형 (dev Task 연동용) ===
type: dev
target_project: loop

# === 분류 ===
tags: ["dashboard", "command-palette", "keyboard-shortcut", "search"]
priority_flag: high
---

# Dashboard - Command Palette (Cmd+P)

> Task ID: `tsk-023-14` | Project: `prj-023` | Status: doing

## 목표

**완료 조건**:
1. Cmd+P (또는 Cmd+K) 단축키로 Command Palette 열기
2. 6개 엔티티 타입 검색 가능 (Task, Project, Program, Track, Condition, Hypothesis)
3. Command mode (`>` prefix)로 명령어 검색 가능
4. 키보드 네비게이션 (↑↓, Enter, ESC) 작동
5. 한글 입력 상태에서도 단축키 작동 (IME 호환)

---

## 상세 내용

### 배경

레거시 대시보드(`_dashboard/`)에 구현된 Cmd+P 엔티티 검색 기능을 v2 대시보드(React+TS)에도 구현 필요. Notion 스타일의 Command Palette로 빠른 엔티티 접근 제공.

### 작업 내용

1. **UiContext 확장** (`src/contexts/UiContext.tsx`)
   - `isCommandPaletteOpen`, `openCommandPalette()`, `closeCommandPalette()` 추가

2. **useKeyboardShortcuts 확장** (`src/hooks/useKeyboardShortcuts.ts`)
   - Cmd+K / Cmd+P 단축키 추가 (IME 호환: `e.code` 사용)
   - ESC 우선순위에 CommandPalette 추가

3. **CommandPalette 컴포넌트 생성** (`src/components/common/CommandPalette/index.tsx`)
   - 오버레이 + 모달 구조 (Tailwind)
   - 검색 입력창 (autoFocus)
   - 결과 리스트 (아이콘, 제목, 메타, 뱃지)
   - 카테고리별 그룹핑
   - 푸터 (키보드 힌트)

4. **검색 로직 훅** (`src/components/common/CommandPalette/useCommandSearch.ts`)
   - `useDashboardInit()` 데이터 활용
   - 6개 엔티티 타입 검색
   - Command mode (`>` prefix)
   - 결과 제한 (Task 5개, Project 5개, 나머지 3개씩)
   - 키보드 네비게이션 (selectedIndex, ArrowUp/Down, Enter)

5. **AppLayout 통합** (`src/components/layout/AppLayout.tsx`)
   - CommandPalette 컴포넌트 렌더링

---

## 체크리스트

- [ ] UiContext에 CommandPalette 상태 추가
- [ ] useKeyboardShortcuts에 Cmd+P/K 단축키 추가
- [ ] CommandPalette 컴포넌트 생성
- [ ] useCommandSearch 훅 생성
- [ ] AppLayout에 CommandPalette 렌더링
- [ ] 테스트: 단축키 작동 확인
- [ ] 테스트: 엔티티 검색 확인
- [ ] 테스트: Command mode 확인
- [ ] 테스트: 키보드 네비게이션 확인

---

## Notes

### Tech Spec

#### 검색 대상 필드

| Entity | 검색 필드 | Max Results |
|--------|----------|-------------|
| Task | name, id, assignee, status, priority, project_id | 5 |
| Project | name, id, owner, status, priority, program_id | 5 |
| Program | name, id, status, owner | 3 |
| Track | name, id | 3 |
| Condition | name, id, status | 3 |
| Hypothesis | name, id, status | 3 |

#### Command Mode 명령어

- `> New Task` → EntityDrawer 열기 (task create 모드)
- `> New Project` → EntityDrawer 열기 (project create 모드)
- `> View Kanban` → /kanban 이동
- `> View Calendar` → /calendar 이동
- `> View Graph` → /graph 이동
- `> View Pending` → /pending 이동

#### 선택 시 동작

- Task → EntityDrawer 열기 (task edit 모드)
- Project → EntityDrawer 열기 (project edit 모드) 또는 /projects/:id 이동
- Program → /program 이동
- Track/Condition/Hypothesis → URL 필터 적용

#### File Changes

| Action | File |
|--------|------|
| EDIT | `src/contexts/UiContext.tsx` |
| EDIT | `src/hooks/useKeyboardShortcuts.ts` |
| CREATE | `src/components/common/CommandPalette/index.tsx` |
| CREATE | `src/components/common/CommandPalette/useCommandSearch.ts` |
| EDIT | `src/components/layout/AppLayout.tsx` |

### Todo

- [ ] Step 1: UiContext 확장
- [ ] Step 2: useKeyboardShortcuts 확장
- [ ] Step 3: CommandPalette 컴포넌트 생성
- [ ] Step 4: useCommandSearch 훅 생성
- [ ] Step 5: AppLayout 통합
- [ ] Step 6: 테스트 및 검증

### 작업 로그
<!--
작업 완료 시 아래 형식으로 기록 (workthrough 스킬 자동 생성)

#### YYYY-MM-DD HH:MM
**개요**: 2-3문장 요약

**변경사항**:
- 개발:
- 수정:
- 개선:

**핵심 코드**: (필요시)

**결과**: ✅ 빌드 성공 / ❌ 실패

**다음 단계**:
-->


---

## 참고 문서

- [[prj-023]] - Dashboard React+TS 마이그레이션 프로젝트
- [[_dashboard/js/components/quick-search.js]] - 레거시 Command Palette 구현

---

**Created**: 2026-01-08
**Assignee**: 김은향
**Due**: 2026-01-08
