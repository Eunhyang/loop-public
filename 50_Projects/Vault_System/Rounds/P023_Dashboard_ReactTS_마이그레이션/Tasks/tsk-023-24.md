---
entity_type: Task
entity_id: "tsk-023-24"
entity_name: "Pending - Workflow/Run 필터 기능"
created: 2026-01-08
updated: 2026-01-08
status: doing

# === 계층 ===
parent_id: "prj-023"
project_id: "prj-023"
aliases: ["tsk-023-24"]

# === 관계 ===
outgoing_relations: []
validates: []
validated_by: []

# === Task 전용 ===
assignee: "김은향"
start_date: 2026-01-08
due: 2026-01-08
priority: medium
estimated_hours: null
actual_hours: null

# === Task 유형 (dev Task 연동용) ===
type: dev
target_project: loop

# === 분류 ===
tags: ["dashboard", "pending", "filter", "react"]
priority_flag: medium
---

# Pending - Workflow/Run 필터 기능

> Task ID: `tsk-023-24` | Project: `prj-023` | Status: doing

## 목표

**완료 조건**:
1. Pending 페이지에서 Workflow 드롭다운으로 source_workflow 필터링 가능
2. Pending 페이지에서 Run ID 드롭다운으로 run_id 필터링 가능
3. Delete Filtered 버튼으로 필터된 리뷰 일괄 삭제 가능
4. ReviewCard에 workflow/run_id/AUTO-SYNTH 뱃지 표시

---

## 상세 내용

### 배경

레거시 대시보드 `_dashboard/js/components/pending-panel.js`에 구현된 workflow/run 필터 기능을 React 대시보드(dashboard-v2)로 마이그레이션.

**레거시 기능**:
- `filterWorkflow`, `filterRunId` 상태 관리
- `updateFilterDropdowns()` - 드롭다운 옵션 업데이트
- `getFilteredReviews(status)` - 필터 적용된 리뷰 반환
- `deleteFiltered()` - 필터된 리뷰 일괄 삭제
- ReviewCard에 workflow/run_id 뱃지, AUTO-SYNTH 뱃지

**백엔드 API 상태**:
- `DELETE /api/pending/batch` 이미 존재 (source_workflow, run_id, status 필터 지원)
- `GET /api/pending` 쿼리 파라미터 지원 (source_workflow, run_id)

### 작업 내용

1. **ReviewCard 개선** - run_id 뱃지, AUTO-SYNTH 뱃지 추가
2. **WorkflowFilters 컴포넌트** - 드롭다운 2개 + Delete Filtered 버튼
3. **usePendingFilters 훅** - 필터 상태 관리 + 필터링 로직
4. **API 클라이언트** - deleteBatch 함수 추가
5. **PendingPage 통합** - 컴포넌트 조립

---

## 체크리스트

- [ ] ReviewCard.tsx 수정 (run_id, AUTO-SYNTH 뱃지)
- [ ] WorkflowFilters.tsx 생성
- [ ] usePendingFilters.ts 훅 생성
- [ ] api.ts에 deleteBatch 추가
- [ ] PendingPage 통합
- [ ] 빌드 확인

---

## Notes

### Tech Spec

```
파일 변경 목록:
├── src/features/pending/components/ReviewCard.tsx (수정)
├── src/features/pending/components/WorkflowFilters.tsx (신규)
├── src/features/pending/components/index.ts (수정)
├── src/features/pending/hooks/usePendingFilters.ts (신규)
├── src/features/pending/api.ts (수정)
├── src/features/pending/queries/index.ts (수정)
└── src/pages/Pending/index.tsx (수정)
```

### Todo
- [ ] Step 1: ReviewCard 개선
- [ ] Step 2: WorkflowFilters 컴포넌트 생성
- [ ] Step 3: usePendingFilters 훅 생성
- [ ] Step 4: API 클라이언트 추가
- [ ] Step 5: PendingPage 통합

### Codex Review Summary (2026-01-08)

**Critical Issues Found**: 0
**Suggestions**: 8

#### Edge Cases to Handle:
1. **Empty filter state**: Delete Filtered 버튼은 필터가 없을 때 비활성화 (레거시와 동일)
2. **Confirmation dialog**: 일괄 삭제 전 confirm() 필수 (레거시 구현 참조)
3. **Loading state**: Delete 중 버튼 비활성화로 중복 클릭 방지

#### UX Clarifications (레거시 동작 따름):
- Workflow/Run ID: 단일 선택 드롭다운 (status는 탭으로 이미 분리됨)
- 드롭다운 옵션: 현재 리뷰 데이터에서 동적 추출 (서버 호출 없음)
- Run ID 표시: 24자 초과 시 truncate (레거시: `substring(0, 24) + '...'`)
- AUTO-SYNTH 뱃지: `source_workflow === 'retro-synth'` 조건

#### Technical Decisions:
- 필터 상태: URL params 아닌 로컬 state (탭 전환 시 초기화)
- Query invalidation: deleteBatch 후 usePendingReviews refetch
- Error handling: catch + toast (기존 패턴 따름)

### 작업 로그
<!--
작업 완료 시 아래 형식으로 기록 (workthrough 스킬 자동 생성)

#### YYYY-MM-DD HH:MM
**개요**: 2-3문장 요약

**변경사항**:
- 개발:
- 수정:
- 개선:

**핵심 코드**: (필요시)

**결과**: ✅ 빌드 성공 / ❌ 실패

**다음 단계**:
-->


---

## 참고 문서

- [[prj-023]] - 소속 Project
- `_dashboard/js/components/pending-panel.js` - 레거시 구현 참조
- `/Users/gim-eunhyang/.claude/plans/hidden-cuddling-cascade.md` - Plan Mode 계획

---

**Created**: 2026-01-08
**Assignee**: 김은향
**Due**: 2026-01-08
