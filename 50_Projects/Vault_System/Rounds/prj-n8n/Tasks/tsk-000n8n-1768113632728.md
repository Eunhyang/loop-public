---
entity_type: Task
entity_id: tsk-000n8n-1768113632728
entity_name: n8n - Auto-Apply 단순화
created: '2026-01-11'
updated: '2026-01-12'
status: todo
project_id: prj-n8n
parent_id: prj-n8n
assignee: 김은향
priority: medium
start_date: '2026-01-11'
due: '2026-01-11'
aliases:
- tsk-000n8n-1768113632728
tags: []
type: dev
notes: "# n8n - Auto-Apply 단순화\n\n## 설명\n\nEntity Validator auto-apply 기능을 confidence\
  \ threshold 기반에서 승인 필요 필드 목록 방식으로 단순화합니다.\n\n## 수정 파일\n\n### api/services/auto_apply.py\n\
  \n**변경 전**: `never_auto_apply` 목록 (7개 필드) **변경 후**: `approval_required` 목록 (9개 필드)\n\
  \n```yaml\napproval_required:\n  - validates\n  - validated_by\n  - expected_impact\n\
  \  - realized_impact\n  - conditions_3y\n  - condition_contributes\n  - evidence_links\n\
  \  - primary_hypothesis_id\n  - program_id  # 추가\n```\n\n**should_auto_apply 함수**:\
  \ 단순화\n\n- 승인 필요 목록에 있으면 pending\n- 아니면 무조건 auto_apply\n- confidence 무시\n\n## 배포\n\
  \n```bash\n/deploy-api deploy\n```\n\n## 검증\n\n```bash\ncurl -X POST \"$LOOP_API_URL/api/ai/infer/task_schema\"\
  \ \\\n  -H \"Authorization: Bearer $LOOP_API_TOKEN\" \\\n  -H \"Content-Type: application/json\"\
  \ \\\n  -d '{\n    \"task_id\": \"tsk-018-04\",\n    \"mode\": \"auto_apply\",\n\
  \    \"issues\": [\"missing_assignee\", \"missing_due\"],\n    \"create_pending\"\
  : true\n  }'\n\n# 기대: assignee, due 모두 auto_applied\n```\n\n## 체크리스트\n\n- [ ] api/services/auto_apply.py\
  \ 수정\n\n- [ ] /deploy-api deploy\n\n- [ ] 테스트 검증\n\n## 참고\n\nPlan: Auto-Apply 단순화\
  \ (/Users/gim-eunhyang/.claude/plans/fancy-prancing-pike.md)"
---
# n8n - Auto-Apply 단순화

## 설명

Entity Validator auto-apply 기능을 confidence threshold 기반에서 승인 필요 필드 목록 방식으로 단순화합니다.

## 수정 파일

### api/services/auto_apply.py

**변경 전**: `never_auto_apply` 목록 (7개 필드)
**변경 후**: `approval_required` 목록 (9개 필드)

```yaml
approval_required:
  - validates
  - validated_by
  - expected_impact
  - realized_impact
  - conditions_3y
  - condition_contributes
  - evidence_links
  - primary_hypothesis_id
  - program_id  # 추가
```

**should_auto_apply 함수**: 단순화
- 승인 필요 목록에 있으면 pending
- 아니면 무조건 auto_apply
- confidence 무시

## 배포

```bash
/deploy-api deploy
```

## 검증

```bash
curl -X POST "$LOOP_API_URL/api/ai/infer/task_schema" \
  -H "Authorization: Bearer $LOOP_API_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "task_id": "tsk-018-04",
    "mode": "auto_apply",
    "issues": ["missing_assignee", "missing_due"],
    "create_pending": true
  }'

# 기대: assignee, due 모두 auto_applied
```

## 체크리스트

- [ ] api/services/auto_apply.py 수정
- [ ] /deploy-api deploy
- [ ] 테스트 검증

## 참고

Plan: Auto-Apply 단순화 (/Users/gim-eunhyang/.claude/plans/fancy-prancing-pike.md)
