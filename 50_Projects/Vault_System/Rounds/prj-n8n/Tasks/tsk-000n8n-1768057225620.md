---
entity_type: Task
entity_id: tsk-000n8n-1768057225620
entity_name: n8n - Entity Validator Auto-Apply 기능
created: '2026-01-11'
updated: '2026-01-13'
status: done
closed: '2026-01-11'
project_id: prj-n8n
parent_id: prj-n8n
assignee: 김은향
priority: high
start_date: '2026-01-11'
due: '2026-01-11'
aliases:
- tsk-000n8n-1768057225620
tags: []
type: dev
notes: Entity Validator n8n 워크플로우에서 LLM 제안을 자동 적용. approval_required 목록 기반으로 단순화.
---
# n8n - Entity Validator Auto-Apply 기능

## 설명

Entity Validator n8n 워크플로우에서 LLM 제안을 자동 적용하는 기능.
기존 confidence 기반 threshold 방식에서 `approval_required` 목록 기반으로 단순화.

## 구현 내용

### 핵심 변경: `api/services/auto_apply.py`

**Before (confidence threshold 방식)**:
- `never_auto_apply`, `deterministic_fields`, `field_thresholds` 등 복잡한 설정
- confidence 값에 따라 auto_apply 여부 결정

**After (approval_required 목록 방식)**:
```python
AUTO_APPLY_CONFIG = {
    "enabled": True,  # KILL SWITCH
    "approval_required": [
        "validates",
        "validated_by",
        "expected_impact",
        "realized_impact",
        "conditions_3y",
        "condition_contributes",
        "evidence_links",
        "primary_hypothesis_id",
        "program_id",
    ],
}
```

**로직**:
- `approval_required` 목록에 있는 필드 → pending (사람 승인 필요)
- 나머지 모든 필드 → auto_apply (즉시 적용)
- confidence 값은 하위 호환성용으로만 유지, 실제로 사용 안함

### 적용 대상 필드 예시
| 필드 | 결과 |
|------|------|
| `due`, `priority`, `assignee`, `status` | auto_apply |
| `validates`, `expected_impact`, `program_id` | pending |

## 체크리스트

- [x] AUTO_APPLY_CONFIG 수정 (approval_required 목록)
- [x] should_auto_apply 함수 단순화
- [x] MCP 서버 배포
- [x] 테스트 및 검증

## 참고

- 관련 계획: tsk-n8n-23
- 파일: `api/services/auto_apply.py`
