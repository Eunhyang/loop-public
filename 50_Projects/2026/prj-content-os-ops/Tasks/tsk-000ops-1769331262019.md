---
entity_type: Task
entity_id: tsk-000ops-1769331262019
entity_name: Content-OS - Explorer 자동저장 및 Keywords 한글화
created: '2026-01-25'
updated: '2026-01-25'
status: done
project_id: prj-content-os-ops
parent_id: prj-content-os-ops
assignee: 김은향
priority: medium
tags: []
type: dev
aliases:
- tsk-000ops-1769331262019
start_date: '2026-01-25'
due: '2026-01-25'
---

# Content-OS - Explorer 자동저장 및 Keywords 한글화

## Notes

### Summary
Explorer 검색 결과 자동 저장 기능 구현 및 Keywords 페이지 UI 한글화 완료.

### Changes Made
- `types/content-os.ts`: `SavedSearch` 타입 추가
- `explorer/hooks.ts`: `useSavedSearches` hook 추가
- `explorer/components/SearchPanel.tsx`: 기록 버튼 → 새로고침 버튼, 저장된 검색 항상 표시
- `explorer/components/ExplorerView.tsx`: 검색 완료 시 자동 저장, 저장된 검색 선택 시 결과 표시
- `pages/ContentOS/Keywords/index.tsx`: 헤더 영역 삭제
- `features/content-os/keywords/components/KeywordsTable.tsx`: 전체 UI 텍스트 한글화

### Commits
- `6f213377a`: feat(content-os): Explorer 검색 결과 자동 저장 기능
- `41b8f74a8`: feat(content-os): Keywords 페이지 UI 한글화

### Plan

# Content-OS Explorer 검색 결과 자동 저장 기능

## 요구사항

- 검색 시 **자동 저장** (impact 기준 상위 100개)
- "기록" 버튼 삭제 → **새로고침 버튼(↻)으로 교체**
- 저장된 검색 목록 **토글 없이 항상 표시**
- 각 검색어에 **x 버튼**으로 삭제
- 저장된 검색 클릭 시 저장된 결과 표시

---

## UI 구조

```
┌─────────────────────────────────────────────────────┐
│ [검색어 입력]                      [검색] [↻]       │
├─────────────────────────────────────────────────────┤
│ 폭식 후 죄책감 (87개) ✕                            │
│ 다이어트 운동 (100개) ✕                            │
│ 홈트레이닝 (95개) ✕                                │
└─────────────────────────────────────────────────────┘
```

---

## 버튼 동작

| 버튼 | 동작 |
|------|------|
| **검색** | 검색 실행 → 결과 표시 → 자동 저장 |
| **↻ (새로고침)** | 현재 검색어로 재검색 → 결과 갱신 → 자동 저장 |
| **저장된 검색 클릭** | 저장된 결과 100개 바로 표시 |
| **✕** | 해당 검색 기록 삭제 |

---

## 변경 파일

| 파일 | 변경 내용 |
|------|----------|
| `types/content-os.ts` | `SavedSearch` 타입 추가 |
| `explorer/hooks.ts` | `useSavedSearches` hook 추가 |
| `explorer/components/SearchPanel.tsx` | "기록" 버튼 → 새로고침 버튼, 저장된 검색 항상 표시 |
| `explorer/components/ExplorerView.tsx` | 검색 완료 시 자동 저장, 저장된 검색 선택 시 결과 표시 |

---

## 1. 타입 정의 (`types/content-os.ts`)

```typescript
export interface SavedSearch {
  id: string;               // unique ID (timestamp 기반)
  query: string;            // 검색어
  timestamp: number;        // 저장 시간
  videos: ProcessedVideo[]; // impact 상위 100개
}
```

---

## 2. Hook 추가 (`explorer/hooks.ts`)

### `useSavedSearches`

```typescript
export function useSavedSearches() {
  const [searches, setSearches] = useLocalStorage<SavedSearch[]>('saved-searches', []);

  const save = (query: string, videos: ProcessedVideo[]) => {
    const trimmed = query.trim();
    if (!trimmed || videos.length === 0) return;

    // impact 기준 상위 100개만 저장
    const top100 = [...videos]
      .sort((a, b) => (b.impactScore ?? 0) - (a.impactScore ?? 0))
      .slice(0, 100);

    const newSearch: SavedSearch = {
      id: `${Date.now()}`,
      query: trimmed,
      timestamp: Date.now(),
      videos: top100,
    };

    // 같은 쿼리 있으면 교체, 없으면 추가
    setSearches((prev) => {
      const filtered = prev.filter((s) => s.query !== trimmed);
      return [newSearch, ...filtered].slice(0, 20); // 최대 20개
    });
  };

  const remove = (id: string) => {
    setSearches((prev) => prev.filter((s) => s.id !== id));
  };

  const get = (id: string) => searches.find((s) => s.id === id);

  return { searches, save, remove, get };
}
```

---

## 3. SearchPanel UI 변경

### 변경 사항
- "기록" 버튼 삭제
- 새로고침 버튼(↻) 추가
- 저장된 검색 목록 항상 표시 (토글 제거)

### Props 변경

```typescript
interface Props {
  search: string;
  onSearchChange: (value: string) => void;
  onSubmit: () => void;
  onRefresh: () => void;  // 새로고침
  disabled?: boolean;
  // 저장된 검색 관련
  savedSearches: SavedSearch[];
  onSelectSaved: (saved: SavedSearch) => void;
  onRemoveSaved: (id: string) => void;
}
```

### JSX 구조

```tsx
<div className="flex flex-col gap-2 ...">
  <div className="flex gap-2">
    <input ... />
    <button onClick={onSubmit}>검색</button>
    <button onClick={onRefresh}>↻</button>  {/* 기록 → 새로고침 */}
  </div>

  {/* 토글 없이 항상 표시 */}
  {savedSearches.length > 0 && (
    <div className="flex flex-wrap gap-2">
      {savedSearches.map((s) => (
        <button key={s.id} onClick={() => onSelectSaved(s)}>
          {s.query} ({s.videos.length}개)
          <span onClick={(e) => { e.stopPropagation(); onRemoveSaved(s.id); }}>✕</span>
        </button>
      ))}
    </div>
  )}
</div>
```

---

## 4. ExplorerView 로직 변경

### 상태 추가

```typescript
const [viewMode, setViewMode] = useState<'live' | 'saved'>('live');
const [selectedSavedId, setSelectedSavedId] = useState<string | null>(null);
const savedSearches = useSavedSearches();
```

### 검색 완료 시 자동 저장

```typescript
// searchQuery 완료 시 자동 저장
const prevQueryRef = useRef<string>('');
useEffect(() => {
  if (
    !searchQuery.isLoading &&
    searchQuery.data?.videos &&
    filters.search.trim() &&
    filters.search !== prevQueryRef.current
  ) {
    savedSearches.save(filters.search, sourceVideos);
    prevQueryRef.current = filters.search;
  }
}, [searchQuery.data, searchQuery.isLoading, filters.search]);
```

### 표시할 videos 결정

```typescript
const displayVideos = useMemo(() => {
  if (viewMode === 'saved' && selectedSavedId) {
    const saved = savedSearches.get(selectedSavedId);
    return saved?.videos ?? [];
  }
  return sorted; // 기존 실시간 결과
}, [viewMode, selectedSavedId, sorted]);
```

### 저장된 검색 선택 핸들러

```typescript
const handleSelectSaved = (saved: SavedSearch) => {
  setSelectedSavedId(saved.id);
  setViewMode('saved');
  setFilters((prev) => ({ ...prev, search: saved.query }));
};

const handleRefresh = () => {
  setViewMode('live');
  setSelectedSavedId(null);
  // 기존 검색 로직 트리거 (filters.search로 재검색)
};
```

---

## 5. 동작 흐름

1. **검색 실행** → API 호출 → 결과 표시 → **자동 저장** (impact 상위 100개)
2. **저장된 검색 클릭** → `viewMode='saved'` → 저장된 100개 결과 표시
3. **↻ 클릭** → 현재 검색어로 재검색 → 결과 갱신 → 자동 저장
4. **✕ 클릭** → 해당 검색 기록 삭제

---

## 검증 방법

1. `npm run build` 통과 확인
2. 로컬에서 테스트:
   - 검색 → 자동 저장 확인 (localStorage `content-os:saved-searches`)
   - 저장된 검색 목록 항상 표시 확인
   - 저장된 검색 클릭 → 결과 100개 표시
   - ↻ → 재검색 후 갱신
   - ✕ → 삭제 확인
   - 페이지 새로고침 후 저장된 검색 유지 확인
