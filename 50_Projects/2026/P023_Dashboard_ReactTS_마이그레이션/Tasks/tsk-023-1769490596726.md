---
entity_type: Task
entity_id: tsk-023-1769490596726
entity_name: Feedback Board - YouTube 댓글 수집 및 LLM 분류 구현
created: '2026-01-27'
updated: '2026-01-27'
status: done
project_id: prj-023
parent_id: prj-023
assignee: 김은향
priority: medium
tags: []
type: dev
aliases:
- tsk-023-1769490596726
start_date: '2026-01-27'
due: '2026-01-27'
---

# Feedback Board - YouTube 댓글 수집 및 LLM 분류 구현

## Notes

### Summary
YouTube 댓글을 수집하고 LLM으로 분류하여 3-Column Kanban Board로 표시하는 User Feedback Board 기능 구현 완료.

### Changes Made
**Backend (API)**
- `api/models/feedback_models.py` - Pydantic 모델 (Feedback 엔티티, Enums)
- `api/services/feedback_service.py` - YouTube 댓글 수집 + GPT-4o-mini 분류 + Firestore CRUD
- `api/routers/content_os/feedback.py` - REST API 엔드포인트

**Frontend (Dashboard)**
- `dashboard-v2/src/features/feedback/` - Feature 폴더 생성
  - `types.ts` - TypeScript 타입
  - `api.ts` - API 호출
  - `queries.ts` - React Query hooks
  - `index.ts` - exports
  - `components/FeedbackBoard.tsx` - 3-Column 칸반 보드
  - `components/FeedbackColumn.tsx` - Droppable 컬럼
  - `components/FeedbackCard.tsx` - 피드백 카드
  - `components/FeedbackDetail.tsx` - 상세 다이얼로그
  - `components/FeedbackFilters.tsx` - 필터 UI
- `dashboard-v2/src/pages/Feedback/index.tsx` - 페이지 컴포넌트
- `dashboard-v2/src/queries/keys.ts` - feedbackKeys 추가
- `dashboard-v2/src/routes/index.tsx` - /feedback 라우트 추가
- `dashboard-v2/src/components/layout/Header.tsx` - 네비게이션 링크 추가

**API Endpoints**
| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | `/api/content-os/feedback` | 목록 조회 |
| GET | `/api/content-os/feedback/{id}` | 상세 조회 |
| GET | `/api/content-os/feedback/stats` | 통계 |
| PATCH | `/api/content-os/feedback/{id}` | 수정 |
| DELETE | `/api/content-os/feedback/{id}` | 삭제 |
| POST | `/api/content-os/feedback/collect` | 수집 트리거 |

### Plan

# User Feedback Board 구현 계획

> **Target**: prj-023 (Dashboard v2)
> **Goal**: YouTube 댓글 + iOS/Android 리뷰를 수집, LLM 분류, 3컬럼 칸반 보드로 표시

---

## 1. Architecture Overview

```
[Sources]                    [Collect]              [Process]            [Store]        [UI]
YouTube Comments  ─────┐
App Store Reviews ─────┼──► n8n Workflow ──► LLM Classification ──► Firestore ◄──► Dashboard
Play Store Reviews ────┘    (Daily 06:00)     (GPT-4o-mini)
```

---

## 2. Data Model

### Feedback Entity (Firestore: `contentos_feedback`)

```yaml
id: fdb-{source}-{timestamp}
source: youtube | appstore | playstore
sourceId: string              # 원본 댓글/리뷰 ID
category: app | coaching | content | uncategorized
sentiment: positive | neutral | negative
priority: high | medium | low
status: inbox | reviewed | actioned | archived

# 원본 데이터
author: string
text: string
textSnippet: string           # 150자 미리보기
rating?: number               # 앱 리뷰 별점 (1-5)
likeCount?: number            # YouTube 좋아요
videoId?: string
videoTitle?: string
appVersion?: string

# LLM 분류
classificationReason: string
isFiltered: boolean           # 비속어/무의미 필터링
filterReason?: string

# 메타
collectedAt: timestamp
publishedAt: timestamp
reviewedAt?: timestamp
actionNote?: string
```

---

## 3. API Endpoints

| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | `/api/content-os/feedback` | 목록 (카테고리, 상태 필터) |
| GET | `/api/content-os/feedback/{id}` | 상세 |
| PATCH | `/api/content-os/feedback/{id}` | 상태/카테고리 변경 |
| POST | `/api/content-os/feedback/collect` | 수동 수집 트리거 |
| GET | `/api/content-os/feedback/stats` | 통계 |

---

## 4. Implementation Phases

### Phase 1: Backend Foundation
**Files to create/modify:**
- `api/services/feedback_service.py` (NEW) - 수집 + LLM 분류
- `api/routers/content_os/feedback.py` (NEW) - REST API
- `api/models/feedback_models.py` (NEW) - Pydantic 모델

**Tasks:**
1. Firestore collection 설계 (`contentos_feedback`)
2. FeedbackService 구현 (CRUD)
3. YouTube 댓글 수집 로직 (기존 `youtube_service.py` 확장)
4. LLM 분류 프롬프트 작성 (`LLMService` 활용)

### Phase 2: iOS/Android Integration
**Files to create:**
- `api/services/appstore_service.py` (NEW)
- `api/services/playstore_service.py` (NEW)

**Tasks:**
1. App Store Connect API 연동 (JWT 인증)
2. Google Play Developer API 연동 (Service Account)
3. 환경변수 설정

**Required ENV:**
```bash
APPSTORE_KEY_ID=
APPSTORE_ISSUER_ID=
APPSTORE_PRIVATE_KEY=
APPSTORE_APP_ID=
PLAYSTORE_PACKAGE_NAME=
```

### Phase 3: n8n Workflow
**Files to create:**
- `n8n_workflows/feedback_collector.json` (NEW)

**Workflow:**
- Schedule: 매일 06:00 KST
- Nodes: YouTube → AppStore → PlayStore → LLM → Firestore → Discord

### Phase 4: Dashboard UI
**Files to create:**
```
dashboard-v2/src/features/feedback/
├── api.ts
├── queries.ts
├── types.ts
├── selectors.ts
├── index.ts
└── components/
    ├── FeedbackBoard.tsx     # 3컬럼 칸반
    ├── FeedbackColumn.tsx
    ├── FeedbackCard.tsx
    ├── FeedbackDetail.tsx
    └── FeedbackFilters.tsx

dashboard-v2/src/pages/Feedback.tsx  # 페이지 컴포넌트
```

**Modify:**
- `src/queries/keys.ts` - feedbackKeys 추가
- `src/routes/index.tsx:49` - 라우트 추가 `{ path: 'feedback', element: <FeedbackPage /> }`
- `src/components/layout/Header.tsx:122` - nav에 Feedback 링크 추가

---

## 5. LLM Classification Prompt

```
당신은 유저 피드백 분류 전문가입니다.
다음 피드백을 분석하여 JSON으로 응답하세요.

피드백: "${text}"
출처: ${source}

응답 형식:
{
  "category": "app" | "coaching" | "content",
  "sentiment": "positive" | "neutral" | "negative",
  "priority": "high" | "medium" | "low",
  "is_filtered": boolean,
  "filter_reason": "비속어" | "무의미" | null,
  "classification_reason": "분류 근거"
}

분류 기준:
- app: 앱 기능, 버그, UI/UX, 결제, 알림
- coaching: 코칭 프로그램, 운동 컨텐츠, 루틴
- content: 유튜브 영상 피드백, 썸네일, 제목

필터링 기준:
- 비속어, 욕설 포함
- 의미 없는 짧은 댓글 ("ㅋㅋ", "ㅎㅎ")
- 건설적 피드백 없는 비난
```

---

## 6. Tech Decisions

| 항목 | 선택 | 근거 |
|------|------|------|
| LLM | GPT-4o-mini | 비용 효율적 ($0.001/피드백), 분류 정확도 충분 |
| 저장소 | Firestore | 기존 Content OS 인프라 재사용 |
| 칸반 | @hello-pangea/dnd | 이미 Tasks에서 사용 중 |
| 수집 스케줄 | n8n | 기존 워크플로우 패턴 |

---

## 7. Verification

### 테스트 시나리오
1. **수동 수집**: `/api/content-os/feedback/collect` 호출 → 데이터 저장 확인
2. **LLM 분류**: 테스트 댓글로 분류 정확도 확인
3. **칸반 UI**: 드래그&드롭으로 카테고리 변경
4. **n8n**: 워크플로우 수동 실행 → Discord 알림

### 로컬 개발
```bash
# API 서버
cd ~/dev/loop/code
poetry run uvicorn api.main:app --host 127.0.0.1 --port 8081 --reload

# Dashboard
cd ~/dev/loop/code/dashboard-v2
npm run dev
```

---

## 8. Dependencies

### Backend (pyproject.toml)
```toml
pyjwt = "^2.8.0"              # App Store Connect JWT
cryptography = "^42.0.0"      # ES256 signing
```

### Frontend
- 기존 패키지로 충분 (@hello-pangea/dnd 이미 설치됨)

---

## 9. Decisions

- **UI 위치**: Loop Dashboard 메인 네비게이션에 "Feedback" 탭 추가 (`/v2/feedback`)
  - Kanban | Calendar | Strategy | Graph | Review | **Feedback**
- **1차 구현**: YouTube 댓글 먼저 구현
- **2차 구현**: iOS/Android 앱 리뷰 (API 키 확보 후)
