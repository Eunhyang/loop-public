---
entity_type: Task
entity_id: tsk-023-1768826648077
entity_name: API - file-read 디렉토리 지원 추가
created: '2026-01-19'
updated: '2026-01-19'
status: done
project_id: prj-023
parent_id: prj-023
assignee: 김은향
priority: medium
start_date: '2026-01-19'
due: '2026-01-19'
aliases:
- tsk-023-1768826648077
tags: []
type: dev
---

# API - file-read 디렉토리 지원 추가

## 설명

ChatGPT에서 file-read API로 디렉토리 경로 요청 시 빈 응답 반환되는 문제 해결.

## Notes

### Summary
file-read API에 디렉토리 경로 지원 추가. 디렉토리 요청 시 하위 .md 파일들을 자동으로 수집하여 반환.

### Changes Made
- `api/routers/mcp_composite.py`: file_read 함수 수정
  - `max_files_per_dir` 파라미터 추가 (기본 20, 최대 50)
  - `is_dir()` 체크 후 `rglob("*.md")`로 하위 파일 수집
  - 제외 패턴(template, 숨김파일 등) 체크 유지
- 커밋: `ffb689a95` - Feat: Add directory support to file-read API

### Plan
```markdown
# Plan: file_read API 디렉토리 지원 추가

## 문제
- ChatGPT에서 `file_read` API로 디렉토리 경로 요청 시 빈 응답 반환
- 원인: `is_dir()` 체크 없이 `read_text()` 시도 → 예외 → 빈 결과

## 해결책
디렉토리 경로 요청 시 하위 .md 파일들을 자동으로 수집하여 반환

## 수정 파일
- `code/api/routers/mcp_composite.py` (라인 449-528, `file_read` 함수)

## 변경 내용
if file_path.is_dir():
    md_files = list(file_path.rglob("*.md"))[:max_files_per_dir]
    for md_file in md_files:
        # 제외 패턴 체크 후 frontmatter, body 추출
        results.append(FileContent(...))
else:
    # 기존 단일 파일 처리 로직

## 추가 파라미터
- `max_files_per_dir`: 디렉토리당 최대 파일 수 (기본 20)
```

## 체크리스트

- [x] 디렉토리 지원 로직 구현
- [x] 로컬 테스트 완료
- [x] main 머지 완료

## 참고

- 테스트: `curl "http://localhost:8091/api/mcp/file-read?paths=20_Strategy/Products"` → 8개 파일 반환

## 짧은 회고
