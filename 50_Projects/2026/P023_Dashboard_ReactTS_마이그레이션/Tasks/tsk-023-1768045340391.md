---
entity_type: Task
entity_id: tsk-023-1768045340391
entity_name: Dashboard - Comment Discord 알림 내용 표시 및 링크 수정
created: '2026-01-10'
updated: '2026-01-10'
status: done
closed: '2026-01-10'
project_id: prj-023
parent_id: prj-023
assignee: 김은향
priority: medium
start_date: '2026-01-10'
due: '2026-01-10'
aliases:
- tsk-023-1768045340391
tags: []
type: dev
---

# Dashboard - Comment Discord 알림 내용 표시 및 링크 수정

## 설명

Discord 알림에서 댓글 내용이 표시되지 않고, @mention이 실제 핑을 트리거하는 문제를 해결합니다.

## 구현 내용

### 1. Discord @mention 이스케이프 함수 추가
- `api/services/notification_service.py`에 `escape_discord_mentions()` 추가
- @everyone, @here 뿐만 아니라 모든 @ 멘션 이스케이프
- Zero-width space (`\u200b`) 사용하여 시각적 외관 유지하면서 핑 방지

### 2. 댓글 내용 표시
- `send_entity_created_notification()`에서 Comment 타입일 때 내용을 description에 표시
- 내용 이스케이프 → 300자 제한 순서로 처리 (부분 멘션 방지)
- 빈 내용에 대한 가드 추가

### 3. Codex 리뷰 피드백 적용
- Regex에서 명시적 `\u200b` 사용 (일관성)
- 이스케이프를 truncate 전에 실행 (경계 문제 방지)
- None/빈 문자열 체크 추가

## 체크리스트

- [x] Discord @mention 이스케이프 함수 구현
- [x] 댓글 내용 Discord 알림에 표시
- [x] 링크가 올바른 엔티티 상세 페이지로 연결되는지 확인
- [x] Codex 코드 리뷰 통과
- [x] Python 문법 검증 통과

## 참고

- Codex 리뷰: 이스케이프 순서, regex 명시성, null 가드
- Zero-width space: U+200B
- 관련 파일: `api/services/notification_service.py`, `api/routers/comments.py`
