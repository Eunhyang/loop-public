---
entity_type: Task
entity_id: tsk-023-1768890869239
entity_name: API - SSOT vault separation (public/exec 분리)
created: '2026-01-20'
updated: '2026-01-20'
status: done
project_id: prj-023
parent_id: prj-023
assignee: 김은향
priority: medium
start_date: '2026-01-20'
due: '2026-01-20'
aliases:
- tsk-023-1768890869239
tags: []
type: dev
---

# API - SSOT vault separation (public/exec 분리)

## 설명

API에서 Project/Task 생성 시 vault 파라미터가 무시되어 항상 public vault에 생성되던 SSOT 위반 문제 수정.

## 체크리스트

- [x] Model 변경: TaskCreate, ProjectCreate에 vault 필드 추가
- [x] projects.py: vault별 디렉토리/ID 생성 분기
- [x] tasks.py: vault별 ID 생성 분기
- [x] batch.py: vault 파라미터 전달
- [x] main 머지 및 push

## Notes

### Summary
API에서 `vault: "exec"` 파라미터로 Project/Task 생성 시 exec vault에 올바르게 저장되도록 SSOT 분리 구현.

### Changes Made
- `api/models/entities.py`: TaskCreate, ProjectCreate에 vault 필드 추가 (+4 lines)
- `api/routers/projects.py`: vault별 디렉토리/ID 생성 분기 (+29 lines)
  - exec: `prj-exec-{hash6}` 형식, `exec/50_Projects/{year}/` 경로
  - public: 기존 `prj-{num}` 형식
- `api/routers/tasks.py`: vault별 ID 생성 분기 (+25 lines)
  - exec: `tsk-exec-{hash6}-{epoch13}` 형식
  - public: 기존 `tsk-{project}-{seq}` 형식
- `api/routers/batch.py`: vault 파라미터 전달 (+8 lines)

### Commit
`803ceec23` - feat(api): SSOT vault separation for Project/Task creation

## 짧은 회고

워크트리로 분리 작업 후 main 머지하는 플로우가 깔끔하게 진행됨.
