---
entity_type: Task
entity_id: tsk-023-1768494638451
entity_name: Dashboard - ProjectForm Edit footer 통합
created: '2026-01-16'
updated: '2026-01-16'
status: done
closed: '2026-01-16'
project_id: prj-023
parent_id: prj-023
assignee: 김은향
priority: medium
start_date: '2026-01-16'
due: '2026-01-16'
aliases:
- tsk-023-1768494638451
tags: []
type: dev
---

# Dashboard - ProjectForm Edit footer 통합

## 설명

ProjectForm Edit 모드에서 footer UI 통합 및 Track/Track Contributes 시각적 구분.

### 문제
1. **Footer 분리**: ProjectForm과 EntityDrawer에서 각각 footer를 렌더링하여 중복/불일치 발생
2. **Track 색상 미구분**: Track(parent_id)과 Track Contributes가 동일한 색상으로 구분 불가

### 해결 방향 (prj-023 아키텍처 준수)
- **원칙 B: Form = features 소유** → Save/Delete/Close 로직을 ProjectForm 안에 유지
- EntityDrawer는 project edit 시 footer 렌더링 비활성화

## Tech Spec

**Architecture Compliance:**
- Parent Project: prj-023 (Dashboard v2)
- 규칙: Drawer 표준 2.4 - Form = features 소유

**File Structure:**
```
src/components/layout/EntityDrawer.tsx     # footer 비활성화 (project edit)
src/features/projects/components/ProjectForm.tsx  # footer 통합
src/features/impact/components/TrackContributionEditor.tsx  # 색상 변경 (optional)
```

**Implementation Details:**

1. **EntityDrawer.tsx** - renderFooter() 수정
   - `type === 'project' && mode === 'edit'` 일 때 `return undefined`
   - 기존 task/program footer 로직 유지

2. **ProjectForm.tsx** - footer 통합
   - 기존 Save 버튼 footer에 Delete/Close 버튼 추가
   - handleDelete 함수 추가 (deleteProject mutation 사용)
   - 스타일: 기존 EntityDrawer footer와 동일하게 유지

3. **Track 색상 구분** (Optional)
   - Track (parent_id): 노란색 (trackColor) 유지
   - Track Contributes: 다른 색상 적용 고려

**Edge Cases:**
- Delete 시 confirm dialog 필수 (associated tasks 경고)
- Save 버튼 disabled 상태 정확히 유지 (hasChanges 기반)
- Close 클릭 시 unsaved changes 경고 없음 (현재 동작 유지)

## 체크리스트

- [ ] EntityDrawer.tsx - project edit 시 footer 비활성화
- [ ] ProjectForm.tsx - Delete 버튼 추가 (좌측)
- [ ] ProjectForm.tsx - Close 버튼 추가 (우측)
- [ ] ProjectForm.tsx - handleDelete 함수 구현
- [ ] Track vs Track Contributes 색상 구분 검토
- [ ] `npm run build` 통과 확인
- [ ] Edit 모드 footer UI 동작 검증

## 작업 로그

#### 2026-01-16 00:39
**개요**: ProjectForm Edit footer 통합 구현 완료

**변경사항**:
- EntityDrawer: project edit 모드에서 footer 렌더링 비활성화 (원칙 B: Form = features 소유)
- ProjectForm: Delete/Close 버튼 추가, handleDelete 함수 구현
- Mutation pending 상태 관리: isSaving, isDeleting 추가로 동시 mutation 방지
- TypeScript 타입 안전성 개선: error 타입을 any → unknown으로 변경

**파일 변경**:
- `dashboard-v2/src/components/layout/EntityDrawer.tsx`: renderFooter() 수정 - project edit 시 undefined 반환
- `dashboard-v2/src/features/projects/components/ProjectForm.tsx`:
  - useDeleteProject hook import
  - handleDelete 함수 추가 (confirm dialog + mutation)
  - Footer에 Delete/Close 버튼 추가
  - 모든 버튼에 disabled 상태 추가 (isSaving || isDeleting)
  - Loading 텍스트 표시 ('Saving...', 'Deleting...')

**Codex 리뷰**: ✅ 2회 통과
- 1차: 동시 mutation, UI 동기화 이슈 발견 → 수정
- 2차: TypeScript error 타입 안전성 이슈 → 수정
- 최종: 모든 이슈 해결 확인

**결과**: ✅ 빌드 성공, 배포 완료 (https://mcp.sosilab.synology.me/v2/)

**커밋**:
- `58b374193` feat(dashboard): ProjectForm Edit footer 통합
- `fffc36f05` fix(dashboard): Add mutation pending states and improve error handling
- `70c61b6b2` fix(dashboard): Improve TypeScript error type safety
- `7596c23c3` fix(content-os): Update isLoading to isPending (pre-existing build error fix)

## 참고

- Plan file: `~/.claude/plans/glittery-wobbling-horizon.md`
- prj-023 Architecture Rules: Drawer 표준 섹션 2.4
