---
entity_type: Task
entity_id: tsk-023-1768027776050
entity_name: Dashboard - Favorites 기능 구현
created: '2026-01-10'
updated: '2026-01-21'
status: done
project_id: prj-023
parent_id: prj-023
assignee: 김은향
priority: medium
start_date: '2026-01-10'
due: '2026-01-10'
aliases:
- tsk-023-1768027776050
tags: []
type: dev
target_project: loop
notes: "# Dashboard - Favorites 기능 구현\n\n## 설명\n\nKanban 대시보드에 사용자별 즐겨찾기 기능 추가. 필터\
  \ 영역 하단에 가로로 즐겨찾기 태스크 표시.\n\n---\n\n## Notes\n\n### PRD - Favorites Feature Implementation\n\
  \nOverview\n\nKanban 대시보드에 사용자별 즐겨찾기 기능 추가. 필터 영역 하단에 가로로 즐겨찾기 태스크 표시.\n\n---\n\n\
  ### Tech Spec\n\nTech Stack\n\n- React 19 + TypeScript\n- useSyncExternalStore (기존\
  \ localFilterStore 패턴 따름)\n- localStorage (`loop_favorites` key)\n\nFile Structure\n\
  \n```\nsrc/features/favorites/\n├── index.ts                    # Public exports\n\
  ├── types.ts                    # FavoritesStorage interface\n├── store/\n│   └──\
  \ favoritesStore.ts       # useSyncExternalStore 기반 store\n├── hooks/\n│   └── useFavorites.ts\
  \         # React hook wrapper\n├── components/\n│   ├── FavoritesStrip.tsx    \
  \  # 가로 스트립 컴포넌트\n│   ├── FavoriteCard.tsx        # 개별 카드 (스타 + 이름)\n│   └── FavoriteStarButton.tsx\
  \  # 재사용 스타 버튼\n└── constants.ts                # FAVORITES_STORAGE_KEY, MAX_FAVORITES\n\
  ```\n\nlocalStorage Schema\n\n```typescript\n// Key: 'loop_favorites'\ninterface\
  \ FavoritesStorage {\n  _schemaVersion: number;\n  taskIds: string[];  // ordered\
  \ by addition time\n}\n\n// Example:\n{\n  \"_schemaVersion\": 1,\n  \"taskIds\"\
  : [\"tsk-022-01\", \"tsk-019-03\"]\n}\n```\n\n- 최대 20개 즐겨찾기 제한\n- Schema version으로\
  \ 향후 마이그레이션 지원\n\nComponents\n\n1\\. FavoritesStrip\n\n- **위치**: TaskFilterBar 바로\
  \ 아래 (line 108-109 사이)\n- **스타일**: glass-moderate, 가로 스크롤 가능\n- **Empty state**:\
  \ 즐겨찾기 없으면 숨김\n\n```tsx\n<div className=\"glass-moderate border-b border-white/5\
  \ px-4 py-2 mb-2\">\n  <div className=\"flex items-center gap-2 overflow-x-auto\
  \ scrollbar-hide\">\n    <span className=\"text-xs font-semibold text-gray-400 uppercase\
  \ tracking-wider shrink-0\">\n      Favorites\n    </span>\n    {favorites.map(task\
  \ => <FavoriteCard key={task.entity_id} task={task} />)}\n  </div>\n</div>\n```\n\
  \n2\\. FavoriteCard\n\n- Notion 스타일 미니 카드\n- 클릭 시 TaskDrawer 열기\n- X 버튼으로 즐겨찾기 해제\n\
  \n```tsx\n<button className=\"flex items-center gap-1.5 px-2.5 py-1 text-xs bg-white\
  \ border border-zinc-200\n                   rounded-md hover:bg-zinc-50 transition-all\
  \ group max-w-[180px]\">\n  <StarIcon className=\"w-3 h-3 text-amber-400 fill-amber-400\
  \ shrink-0\" />\n  <span className=\"truncate text-zinc-700\">{task.entity_name}</span>\n\
  \  <XIcon className=\"w-3 h-3 text-zinc-400 opacity-0 group-hover:opacity-100 shrink-0\"\
  \ />\n</button>\n```\n\n3\\. FavoriteStarButton\n\n- **위치**: TaskCard 상단 우측 (hover\
  \ 시 표시)\n- 토글로 즐겨찾기 추가/제거\n\n```tsx\n// TaskCard.tsx에 추가 (line 60 근처)\n<div className=\"\
  flex flex-col gap-1 mb-2\">\n  <div className=\"flex justify-between items-start\"\
  >\n    <span className=\"text-[10px] text-zinc-400 font-mono truncate\">{task.entity_id}</span>\n\
  \    <FavoriteStarButton taskId={task.entity_id} size=\"sm\" />\n  </div>\n  <h3\
  \ className=\"...\">{task.entity_name}</h3>\n</div>\n```\n\nStore Implementation\n\
  \nfavoritesStore.ts\n\n```typescript\n// useSyncExternalStore 패턴 (localFilterStore.ts\
  \ 참고)\nconst FAVORITES_STORAGE_KEY = 'loop_favorites';\nconst FAVORITES_SCHEMA_VERSION\
  \ = 1;\nconst MAX_FAVORITES = 20;\n\nlet state: string[] = loadFromStorage();\n\
  let listeners: Set<() => void> = new Set();\n\nexport function getSnapshot(): string[]\
  \ { return state; }\nexport function getServerSnapshot(): string[] { return [];\
  \ }\nexport function subscribe(listener: () => void): () => void { ... }\nexport\
  \ function addFavorite(taskId: string): void { ... }\nexport function removeFavorite(taskId:\
  \ string): void { ... }\nexport function toggleFavorite(taskId: string): void {\
  \ ... }\n```\n\nuseFavorites.ts\n\n```typescript\nexport const useFavorites = ()\
  \ => {\n  const favoriteIds = useSyncExternalStore(subscribe, getSnapshot, getServerSnapshot);\n\
  \n  return {\n    favoriteIds,\n    toggleFavorite: useCallback((id: string) =>\
  \ storeToggleFavorite(id), []),\n    isFavorited: useCallback((id: string) => favoriteIds.includes(id),\
  \ [favoriteIds]),\n  };\n};\n```\n\nIntegration Points\n\n1\\. KanbanPage/index.tsx\
  \ (line 108-109)\n\n```tsx\n<TaskFilterBar ... />\n<FavoritesStrip tasks={data.tasks}\
  \ />  {/* NEW */}\n<KanbanBoard ... />\n```\n\n2\\. TaskCard.tsx (line 60-68)\n\n\
  ```tsx\n// Task ID 영역에 스타 버튼 추가\n<div className=\"flex justify-between items-start\"\
  >\n  <span className=\"text-[10px] text-zinc-400 font-mono truncate\">{task.entity_id}</span>\n\
  \  <FavoriteStarButton taskId={task.entity_id} />\n</div>\n```\n\nCritical Files\
  \ to Modify\n\n| File | Action |\n| --- | --- |\n| `src/features/favorites/*` |\
  \ NEW - 전체 feature 폴더 생성 |\n| `src/pages/Kanban/index.tsx:108` | FavoritesStrip\
  \ 추가 |\n| `src/features/tasks/components/Kanban/TaskCard.tsx:60` | FavoriteStarButton\
  \ 추가 |\n\n---\n\n### Implementation Sequence\n\n1. **Phase 1: Store Layer** - favoritesStore.ts,\
  \ useFavorites.ts, types.ts\n2. **Phase 2: Components** - FavoriteStarButton, FavoriteCard,\
  \ FavoritesStrip\n3. **Phase 3: Integration** - TaskCard, KanbanPage 수정\n4. **Phase\
  \ 4: Polish** - animations, edge cases\n\n---\n\n### Edge Cases\n\n- 삭제된 태스크: FavoritesStrip에서\
  \ tasks 배열과 비교하여 자동 필터링\n- 최대 개수 초과: 20개 제한, 초과 시 toast 알림\n- SSR: getServerSnapshot()\
  \ 빈 배열 반환\n\n---\n\n### Todo Checklist\n\n- [ ] **Phase 1: Store Layer**\n\n  -\
  \ [ ] `src/features/favorites/types.ts` - FavoritesStorage interface 정의\n\n  - [\
  \ ] `src/features/favorites/constants.ts` - FAVORITES_STORAGE_KEY, MAX_FAVORITES\
  \ 상수\n\n  - [ ] `src/features/favorites/store/favoritesStore.ts` - useSyncExternalStore\
  \ 기반 store\n\n  - [ ] `src/features/favorites/hooks/useFavorites.ts` - React hook\
  \ wrapper\n\n- [ ] **Phase 2: Components**\n\n  - [ ] `src/features/favorites/components/FavoriteStarButton.tsx`\
  \ - 스타 토글 버튼\n\n  - [ ] `src/features/favorites/components/FavoriteCard.tsx` - 미니\
  \ 카드 컴포넌트\n\n  - [ ] `src/features/favorites/components/FavoritesStrip.tsx` - 가로\
  \ 스트립 컨테이너\n\n  - [ ] `src/features/favorites/index.ts` - Public exports\n\n- [\
  \ ] **Phase 3: Integration**\n\n  - [ ] `src/pages/Kanban/index.tsx` - FavoritesStrip\
  \ 추가 (line 108-109)\n\n  - [ ] `src/features/tasks/components/Kanban/TaskCard.tsx`\
  \ - FavoriteStarButton 추가 (line 60)\n\n- [ ] **Phase 4: Verification**\n\n  - [\
  \ ] `npm run build` - TypeScript 에러 없음\n\n  - [ ] 브라우저 테스트: 스타 버튼 → FavoritesStrip\
  \ 추가\n\n  - [ ] 브라우저 테스트: FavoritesStrip 카드 클릭 → TaskDrawer 열림\n\n  - [ ] 브라우저 테스트:\
  \ X 버튼 → 즐겨찾기 해제\n\n  - [ ] 브라우저 테스트: 페이지 새로고침 → localStorage 복원\n\n  - [ ] 개발자도구\
  \ localStorage 확인\n\n---\n\n## 참고\n\n- Plan 승인 파일: `~/.claude/plans/silly-honking-pond.md`\n\
  - 기존 localFilterStore 패턴 참고\n\n> > > > > > > 7a729e0"
---
# Dashboard - Favorites 기능 구현

## 설명

Kanban 대시보드에 사용자별 즐겨찾기 기능 추가. 필터 영역 하단에 가로로 즐겨찾기 태스크 표시.

---

## Notes

### PRD - Favorites Feature Implementation

#### Overview
Kanban 대시보드에 사용자별 즐겨찾기 기능 추가. 필터 영역 하단에 가로로 즐겨찾기 태스크 표시.

---

### Tech Spec

#### Tech Stack
- React 19 + TypeScript
- useSyncExternalStore (기존 localFilterStore 패턴 따름)
- localStorage (`loop_favorites` key)

#### File Structure

```
src/features/favorites/
├── index.ts                    # Public exports
├── types.ts                    # FavoritesStorage interface
├── store/
│   └── favoritesStore.ts       # useSyncExternalStore 기반 store
├── hooks/
│   └── useFavorites.ts         # React hook wrapper
├── components/
│   ├── FavoritesStrip.tsx      # 가로 스트립 컴포넌트
│   ├── FavoriteCard.tsx        # 개별 카드 (스타 + 이름)
│   └── FavoriteStarButton.tsx  # 재사용 스타 버튼
└── constants.ts                # FAVORITES_STORAGE_KEY, MAX_FAVORITES
```

#### localStorage Schema

```typescript
// Key: 'loop_favorites'
interface FavoritesStorage {
  _schemaVersion: number;
  taskIds: string[];  // ordered by addition time
}

// Example:
{
  "_schemaVersion": 1,
  "taskIds": ["tsk-022-01", "tsk-019-03"]
}
```

- 최대 20개 즐겨찾기 제한
- Schema version으로 향후 마이그레이션 지원

#### Components

##### 1. FavoritesStrip
- **위치**: TaskFilterBar 바로 아래 (line 108-109 사이)
- **스타일**: glass-moderate, 가로 스크롤 가능
- **Empty state**: 즐겨찾기 없으면 숨김

```tsx
<div className="glass-moderate border-b border-white/5 px-4 py-2 mb-2">
  <div className="flex items-center gap-2 overflow-x-auto scrollbar-hide">
    <span className="text-xs font-semibold text-gray-400 uppercase tracking-wider shrink-0">
      Favorites
    </span>
    {favorites.map(task => <FavoriteCard key={task.entity_id} task={task} />)}
  </div>
</div>
```

##### 2. FavoriteCard
- Notion 스타일 미니 카드
- 클릭 시 TaskDrawer 열기
- X 버튼으로 즐겨찾기 해제

```tsx
<button className="flex items-center gap-1.5 px-2.5 py-1 text-xs bg-white border border-zinc-200
                   rounded-md hover:bg-zinc-50 transition-all group max-w-[180px]">
  <StarIcon className="w-3 h-3 text-amber-400 fill-amber-400 shrink-0" />
  <span className="truncate text-zinc-700">{task.entity_name}</span>
  <XIcon className="w-3 h-3 text-zinc-400 opacity-0 group-hover:opacity-100 shrink-0" />
</button>
```

##### 3. FavoriteStarButton
- **위치**: TaskCard 상단 우측 (hover 시 표시)
- 토글로 즐겨찾기 추가/제거

```tsx
// TaskCard.tsx에 추가 (line 60 근처)
<div className="flex flex-col gap-1 mb-2">
  <div className="flex justify-between items-start">
    <span className="text-[10px] text-zinc-400 font-mono truncate">{task.entity_id}</span>
    <FavoriteStarButton taskId={task.entity_id} size="sm" />
  </div>
  <h3 className="...">{task.entity_name}</h3>
</div>
```

#### Store Implementation

##### favoritesStore.ts
```typescript
// useSyncExternalStore 패턴 (localFilterStore.ts 참고)
const FAVORITES_STORAGE_KEY = 'loop_favorites';
const FAVORITES_SCHEMA_VERSION = 1;
const MAX_FAVORITES = 20;

let state: string[] = loadFromStorage();
let listeners: Set<() => void> = new Set();

export function getSnapshot(): string[] { return state; }
export function getServerSnapshot(): string[] { return []; }
export function subscribe(listener: () => void): () => void { ... }
export function addFavorite(taskId: string): void { ... }
export function removeFavorite(taskId: string): void { ... }
export function toggleFavorite(taskId: string): void { ... }
```

##### useFavorites.ts
```typescript
export const useFavorites = () => {
  const favoriteIds = useSyncExternalStore(subscribe, getSnapshot, getServerSnapshot);

  return {
    favoriteIds,
    toggleFavorite: useCallback((id: string) => storeToggleFavorite(id), []),
    isFavorited: useCallback((id: string) => favoriteIds.includes(id), [favoriteIds]),
  };
};
```

#### Integration Points

##### 1. KanbanPage/index.tsx (line 108-109)
```tsx
<TaskFilterBar ... />
<FavoritesStrip tasks={data.tasks} />  {/* NEW */}
<KanbanBoard ... />
```

##### 2. TaskCard.tsx (line 60-68)
```tsx
// Task ID 영역에 스타 버튼 추가
<div className="flex justify-between items-start">
  <span className="text-[10px] text-zinc-400 font-mono truncate">{task.entity_id}</span>
  <FavoriteStarButton taskId={task.entity_id} />
</div>
```

#### Critical Files to Modify

| File | Action |
|------|--------|
| `src/features/favorites/*` | NEW - 전체 feature 폴더 생성 |
| `src/pages/Kanban/index.tsx:108` | FavoritesStrip 추가 |
| `src/features/tasks/components/Kanban/TaskCard.tsx:60` | FavoriteStarButton 추가 |

---

### Implementation Sequence

1. **Phase 1: Store Layer** - favoritesStore.ts, useFavorites.ts, types.ts
2. **Phase 2: Components** - FavoriteStarButton, FavoriteCard, FavoritesStrip
3. **Phase 3: Integration** - TaskCard, KanbanPage 수정
4. **Phase 4: Polish** - animations, edge cases

---

### Edge Cases

- 삭제된 태스크: FavoritesStrip에서 tasks 배열과 비교하여 자동 필터링
- 최대 개수 초과: 20개 제한, 초과 시 toast 알림
- SSR: getServerSnapshot() 빈 배열 반환

---

### Todo Checklist

- [ ] **Phase 1: Store Layer**
  - [ ] `src/features/favorites/types.ts` - FavoritesStorage interface 정의
  - [ ] `src/features/favorites/constants.ts` - FAVORITES_STORAGE_KEY, MAX_FAVORITES 상수
  - [ ] `src/features/favorites/store/favoritesStore.ts` - useSyncExternalStore 기반 store
  - [ ] `src/features/favorites/hooks/useFavorites.ts` - React hook wrapper

- [ ] **Phase 2: Components**
  - [ ] `src/features/favorites/components/FavoriteStarButton.tsx` - 스타 토글 버튼
  - [ ] `src/features/favorites/components/FavoriteCard.tsx` - 미니 카드 컴포넌트
  - [ ] `src/features/favorites/components/FavoritesStrip.tsx` - 가로 스트립 컨테이너
  - [ ] `src/features/favorites/index.ts` - Public exports

- [ ] **Phase 3: Integration**
  - [ ] `src/pages/Kanban/index.tsx` - FavoritesStrip 추가 (line 108-109)
  - [ ] `src/features/tasks/components/Kanban/TaskCard.tsx` - FavoriteStarButton 추가 (line 60)

- [ ] **Phase 4: Verification**
  - [ ] `npm run build` - TypeScript 에러 없음
  - [ ] 브라우저 테스트: 스타 버튼 → FavoritesStrip 추가
  - [ ] 브라우저 테스트: FavoritesStrip 카드 클릭 → TaskDrawer 열림
  - [ ] 브라우저 테스트: X 버튼 → 즐겨찾기 해제
  - [ ] 브라우저 테스트: 페이지 새로고침 → localStorage 복원
  - [ ] 개발자도구 localStorage 확인

---

## 참고

- Plan 승인 파일: `~/.claude/plans/silly-honking-pond.md`
- 기존 localFilterStore 패턴 참고
>>>>>>> 7a729e0
