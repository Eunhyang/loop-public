---
entity_type: Task
entity_id: tsk-mzjr8a-1769526428807
entity_name: 2주 코어 파일럿 - 다음날 회복(기본값)
created: '2026-01-28'
updated: '2026-01-28'
status: doing
project_id: prj-mzjr8a
parent_id: prj-mzjr8a
assignee: 김은향
priority: medium
start_date: '2026-01-28'
due: '2026-01-28'
notes: "# PRD v0.1A — 2주 코어 파일럿: 다음날 회복(기본값)\n\n## 0. 한 줄 요약\n\n폭식/과식 다음날 “회복 1분 루틴”을\
  \ 홈 기본값으로 노출해, 코어 유저의 **재방문 기본 행동(실행/완료/반복**)이 되는지 2주 안에 판정한다.\n\n---\n\n## 1. 목표(Goals)\n\
  \n- G1) 회복 카드가 코어 코호트에 안정적으로 도달한다(노출→시작).\n\n- G2) 회복 루틴이 실제로 완료된다(시작→완료).\n\n-\
  \ G3) 2주 내 반복 실행이 나온다(완료 2회 이상).\n\n- G4) 종료 시 Go/Iterate/Stop 결론을 만든다(1페이지 요약).\n\
  \n## 2. 비목표(Non-goals)\n\n- 바이럴/획득 상승 증명\n\n- 직전 알림/리셋 기능 구현(별도 PRD)\n\n- LoopOS\
  \ 학습 엔진 고도화\n\n---\n\n## 3. 대상(파일럿 코호트)\n\n❯ - 포만감 **8 이상** 기록 1회 이상\\\n(최근 24h)\n\
  \n- 어제 식사 기록에\\\n  **‘야식/간식/배달/폭식’ 태그**(있다면)\n- **2일 연속 저녁 기록하던 유저가 어제\\\n  저녁 누락**(지금\
  \ 너희 조건 A)\n\n---\n\n## 4. UX/화면(홈이 타이머 CTA인 구조 기준)\n\n### 원칙\n\n- 타이머 CTA를 침범하지\
  \ 않는다.\n\n- “작은 카드 1개”로만 추가(홈 상단 또는 타이머 버튼 위/아래).\n\n### 회복 카드\n\n- 카피(예시)\n\n \
  \ - “어제 무너졌다면, 오늘은 회복이 먼저.”\n\n- 버튼\n\n  - “회복 시작(1분)”\n\n- 플로우(최소)\n\n  - 카드 탭\
  \ → 1분 회복(텍스트/호흡/체크) → 완료 → 1탭 피드백(선택)\n\n---\n\n## 5. 기능 요구사항(FR)\n\n- FR1) 홈에서\
  \ 회복 카드 노출(코어 코호트)\n\n- FR2) 회복 시작/완료 가능(1분 콘텐츠)\n\n- FR3) 완료 후 1탭 피드백(선택)\n\n \
  \ - 옵션 A: helpful_yes/no\n\n  - 옵션 B: 갈망 전/후 1\\~5 (가능하면)\n\n---\n\n## 6. 계측/데이터(Amplitude\
  \ 최소)\n\n### 이벤트\n\n- recovery_card_viewed\n\n- recovery_started\n\n- recovery_completed\n\
  \n- (선택) recovery_helpful_selected\n\n### 파라미터(최소)\n\n- user_id, timestamp, platform,\
  \ app_version\n\n- cohort_type: warm/other\n\n- intervention_type: recovery_next_day\n\
  \n- (선택) helpful_yes/no, craving_before, craving_after\n\n### Ontology-lite(동결만)\n\
  \n- Event: recovery_card_viewed\n\n- ActionExecution: recovery_started/completed\n\
  \n- OutcomeMeasurement: helpful 또는 craving_delta\n\n---\n\n## 7. 판정 기준(2주)\n\n###\
  \ Gate 0: 도달\n\n- Warm cohort 중 recovery_card_viewed 도달률(참고지표)\n\n### Gate 1: 실행/체감\n\
  \n- recovery_started 대비 recovery_completed 완료율\n\n- helpful_yes 비율 ≥ 40% (표본: recovery_completed\
  \ 30회 이상이면 신뢰도 상승)\n\n### Gate 2: 반복\n\n- 2주 내 recovery_completed 2회 이상 유저 비율 ≥\
  \ 20% (회복 실행자 기준)\n\n### 결론\n\n- Go: Gate1 + Gate2 충족\n\n- Iterate: Gate1은 있으나 Gate2\
  \ 약함(노출/카피/플로우 수정 후 재시도)\n\n- Stop: Gate1 신호도 낮고 반복 없음(우선순위 하향)\n\n---\n\n## 8.\
  \ 롤아웃/운영(간단)\n\n- D0\\~D1: 카드/카피/이벤트 키 동결\n\n- D2\\~D5: 구현/QA/배포\n\n- D7: 중간 점검(버그/누락\
  \ 이벤트만)\n\n- D14: 최종 리포트(Go/Iterate/Stop)\n\n---\n\n## 9. QA 체크(최소)\n\n- 타이머 CTA/플로우\
  \ 방해 없음\n\n- started/completed 이벤트 누락 없음\n\n- 크래시/오류 없음"
tags: []
type: dev
links: []
aliases:
- tsk-mzjr8a-1769526428807
start_time: '15:00'
end_time: '16:00'
---
# 2주 코어 파일럿 - 다음날 회복(기본값) + 직전 60초 리셋

## 설명

## 체크리스트

### Phase 1: 기본 구조 생성
- [x] `lib/presentation/recovery_mission/constants/mission_options.dart` - RecoveryMission enum
- [x] `lib/presentation/recovery_mission/cubit/recovery_mission_state.dart` - State 클래스
- [x] `lib/presentation/recovery_mission/cubit/recovery_mission_cubit.dart` - HydratedCubit

### Phase 2: UI 위젯 생성
- [x] `lib/presentation/recovery_mission/widgets/mission_card.dart` - 미션 카드
- [x] `lib/presentation/recovery_mission/widgets/mission_complete_dialog.dart` - 완료 다이얼로그
- [x] `lib/presentation/recovery_mission/widgets/mission_progress_bar.dart` - 진행 상태 바
- [x] `lib/presentation/recovery_mission/page/mission_select_page.dart` - 미션 선택 페이지

### Phase 3: 기존 코드 연결
- [x] `lib/core/routes/app_router.dart` - `/mission-select` 라우트 추가
- [x] `lib/main.dart` - RecoveryMissionCubit Provider 등록
- [x] `lib/presentation/recovery_routine/widgets/completion_step.dart` - 버튼 동작 변경
- [x] `lib/presentation/today/page/today_page.dart` - MissionProgressBar 추가
- [x] `lib/presentation/diary/page/meal_diary_page.dart` - 자동완료 로직 추가

### 빌드 & 검증
- [x] `flutter build ios --simulator` 성공
- [ ] 회복 루틴 → 미션 선택 플로우 테스트
- [ ] 캘린더 탭 진행 상태 바 표시 확인
- [ ] 식사 일기 저장 시 mealWithTimer 자동완료 테스트

## 참고

### 신규 생성 파일 (7개)
| 파일 | 설명 |
|------|------|
| `constants/mission_options.dart` | RecoveryMission enum (mealWithTimer, lightWalk, warmBath) |
| `cubit/recovery_mission_state.dart` | 상태 클래스 (triggerCompleted, emotionCompleted, selectedMission, missionCompleted, skipped, completedDate, helpfulFeedback) |
| `cubit/recovery_mission_cubit.dart` | HydratedCubit - 자정 자동 초기화, 상태 영속화 |
| `page/mission_select_page.dart` | 미션 선택 페이지 UI |
| `widgets/mission_card.dart` | 선택 가능한 미션 카드 |
| `widgets/mission_progress_bar.dart` | [트리거✅]─[감정✅]─[미션⬜] 진행 상태 바 |
| `widgets/mission_complete_dialog.dart` | 완료 축하 + 피드백 수집 다이얼로그 |

### 핵심 로직
- **자동완료**: mealWithTimer 미션 선택 후 식사 일기 저장 시 자동 완료
- **자정 초기화**: completedDate가 오늘이 아니면 상태 리셋
- **HydratedBloc**: 앱 재시작 후에도 오늘 내 상태 유지

## 짧은 회고

2026-01-28: Recovery Mission 모듈 신규 구현 완료. 회복 루틴 완료 후 미션 선택 → 캘린더 탭 진행 상태 추적 → 자동완료 플로우 구축. 빌드 성공, UI 테스트 필요.
