# Field Requirements

Required and optional fields for each entity type.

## Task

### Required Fields

| Field | Description | Example |
|-------|-------------|---------|
| `entity_name` | Task name | "CoachOS 프로토타입 개발" |
| `project_id` | Parent project ID | "prj-003" |
| `assignee` | Person responsible (from members.yaml) | "김은향", "한명학", "임단", "미정" |

### Optional Fields

| Field | Description | Example | Default |
|-------|-------------|---------|---------|
| `parent_id` | Parent task ID (for subtasks) | "tsk-002-01" | null |
| `priority_flag` | Task priority | "critical", "high", "medium", "low" | "medium" |

### Forbidden Fields (역할 분리)

| Field | Reason |
|-------|--------|
| `validates` | ❌ Task는 전략 판단에 개입하지 않음. validates 관계는 Project만 가능. |

### Auto-Generated Fields

| Field | Description | Generated By |
|-------|-------------|--------------|
| `entity_id` | Unique task identifier | Auto-incremented (e.g., "tsk-005-03") |
| `entity_type` | Always "Task" | Fixed value |
| `created` | Creation date | Current date (YYYY-MM-DD) |
| `updated` | Last update date | Current date (YYYY-MM-DD) |
| `status` | Task status | Default: "planning" |

### Valid Status Values

- `planning` - Task is being planned
- `active` - Task is in progress
- `blocked` - Task is blocked by dependency
- `done` - Task is completed
- `failed` - Task could not be completed

## Project

### Required Fields

| Field | Description | Example |
|-------|-------------|---------|
| `entity_name` | Project name | "Ontology_v0.2" |
| `owner` | Project owner (from members.yaml) | "김은향", "한명학", "임단", "미정" |
| `parent_id` | Parent Track or Hypothesis ID | "trk-2" or "hyp-005" |
| `expected_impact` | **사전 선언 (A)** - 필수 | (아래 참조) |

### expected_impact (필수)

> **Project = 유일한 판정 단위. Impact 없는 프로젝트는 생성 불가.**

| Sub-Field | Description | Example |
|-----------|-------------|---------|
| `statement` | 성공 시 증명되는 것 | "와디즈에서 브랜드 스토리 중심 메시지가 전환을 만든다" |
| `metric` | 측정 지표 | "펀딩 달성률" |
| `target` | 목표값 | "200%" |

```yaml
expected_impact:
  statement: "와디즈에서 브랜드 스토리 중심 메시지가 전환을 만든다"
  metric: "펀딩 달성률"
  target: "200%"
```

### realized_impact (완료 시 필수)

> **status=done|failed일 때 반드시 기록해야 함**

| Sub-Field | Description | Example |
|-----------|-------------|---------|
| `outcome` | 판정 결과 | "supported" \| "rejected" \| "inconclusive" |
| `evidence` | 실제 결과/근거 | "펀딩률 320% 달성, 서포터 450명" |
| `updated` | 기록일 | "2025-01-15" |

```yaml
realized_impact:
  outcome: supported
  evidence: "펀딩률 320% 달성, 서포터 450명"
  updated: 2025-01-15
```

### Optional Fields

| Field | Description | Example | Default |
|-------|-------------|---------|---------|
| `priority_flag` | Project priority | "critical", "high", "medium", "low" | "medium" |
| `hypothesis_id` | 검증 대상 가설 ID | "hyp-003" | null |

### Auto-Generated Fields

| Field | Description | Generated By |
|-------|-------------|--------------|
| `entity_id` | Unique project identifier | Auto-incremented (e.g., "prj-008") |
| `entity_type` | Always "Project" | Fixed value |
| `created` | Creation date | Current date (YYYY-MM-DD) |
| `updated` | Last update date | Current date (YYYY-MM-DD) |
| `status` | Project status | Default: "planning" |

### Valid Status Values

- `planning` - Project is being planned
- `active` - Project is in progress
- `blocked` - Project is blocked by external factors
- `done` - Project is completed
- `failed` - Project was terminated

## Field Validation Notes

### entity_id Format

- Task: `tsk-NNN-NN` (e.g., `tsk-003-01`, `tsk-015-12`)
- Project: `prj-NNN` (e.g., `prj-005`, `prj-042`)

The validation script (`scripts/validate_schema.py`) enforces these patterns.

### parent_id Validation

- Must reference an existing entity_id
- Task parent_id can reference:
  - Another Task (for subtasks)
  - A Project (for top-level tasks)
- Project parent_id must reference:
  - A Track (e.g., "trk-2")
  - A Hypothesis (e.g., "hyp-005")

The orphan check script (`scripts/check_orphans.py`) verifies these references exist.

### Date Format

All dates must be in `YYYY-MM-DD` format (e.g., "2025-12-18").

---

## Hypothesis

### Required Fields

| Field | Description | Example |
|-------|-------------|---------|
| `entity_name` | 가설 이름 | "브랜드_스토리_전환_가설" |
| `hypothesis_question` | **질문 형태** ("?"로 끝나야 함) | "와디즈에서 브랜드 스토리 중심 메시지가 전환을 만드는가?" |
| `success_criteria` | 성공 판정 기준 | "펀딩률 200% 이상, 서포터 300명 이상" |
| `failure_criteria` | 실패 판정 기준 | "펀딩률 100% 미만" |

### validation 규칙

| Rule | Description |
|------|-------------|
| 질문 형태 강제 | `hypothesis_question`은 반드시 "?"로 끝나야 함 |
| 검증 기준 필수 | `success_criteria`와 `failure_criteria` 모두 필수 |
| 슬로건 금지 | "우리는 혁신적이다" 같은 선언문 ❌ |

```yaml
# 올바른 예시
hypothesis_question: "와디즈에서 브랜드 스토리 중심 메시지가 전환을 만드는가?"
success_criteria: "펀딩률 200% 이상, 서포터 300명 이상"
failure_criteria: "펀딩률 100% 미만"

# 잘못된 예시 ❌
hypothesis_question: "브랜드 스토리가 중요하다"  # 질문이 아님
hypothesis_text: "..."  # deprecated - 사용하지 마세요
```

### Optional Fields

| Field | Description | Example | Default |
|-------|-------------|---------|---------|
| `loop_layer` | Loop 레이어 분류 | ["emotional", "eating"] | [] |
| `parent_id` | 상위 가설 ID | "mh-3" | null |

---

## 역할 분리 규칙 (CRITICAL)

> **"레이어가 부족한 게 아니라 레이어의 책임이 흐려지는 것이 문제다"**

### 계층별 책임

| Layer | 역할 | validates 가능 | Impact 기록 |
|-------|------|---------------|-------------|
| **Hypothesis** | 질문 + 기준 정의 | ❌ (대상임) | ❌ |
| **Project** | 실험 단위 + 판정 | ✅ (유일) | ✅ (필수) |
| **Task** | 단순 실행 로그 | ❌ (금지) | ❌ |

### 위험 신호

이런 패턴이 보이면 역할이 섞인 것:
- ❌ Task에 validates 관계 설정
- ❌ Task에 "이 작업이 중요한 이유" 서술
- ❌ Project에 expected_impact 없이 작업만 나열
- ❌ Hypothesis가 "?"로 끝나지 않음