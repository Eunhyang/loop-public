{
  "run_id": "run-20251230-194522-7gnjpa",
  "timestamp": "2025-12-30T19:45:22.598773",
  "provider": "openai",
  "model": "",
  "prompt": "## Project 정보\n\n```json\n{\n  \"entity_type\": \"Project\",\n  \"entity_id\": \"prj-n8n\",\n  \"entity_name\": \"n8n Vault 자동화\",\n  \"created\": \"2025-12-27\",\n  \"updated\": \"2025-12-28\",\n  \"status\": \"active\",\n  \"program_id\": \"pgm-vault-system\",\n  \"cycle\": \"2025\",\n  \"owner\": \"김은향\",\n  \"budget\": null,\n  \"deadline\": null,\n  \"expected_impact\": {\n    \"tier\": \"enabling\",\n    \"impact_magnitude\": \"mid\",\n    \"confidence\": 0.7,\n    \"contributes\": [\n      {\n        \"to\": \"cond-e\",\n        \"weight\": 0.3,\n        \"description\": \"Vault 운영 효율화를 통한 조직 역량 강화\"\n      }\n    ]\n  },\n  \"realized_impact\": {\n    \"verdict\": null,\n    \"outcome\": null,\n    \"evidence_links\": [],\n    \"decided\": null\n  },\n  \"hypothesis_id\": null,\n  \"experiments\": [],\n  \"parent_id\": \"trk-2\",\n  \"conditions_3y\": [\n    \"cond-e\"\n  ],\n  \"aliases\": [\n    \"prj-n8n\",\n    \"prj-n8n-entity-autofill\",\n    \"n8n Vault 자동화\"\n  ],\n  \"outgoing_relations\": [],\n  \"validates\": [],\n  \"validated_by\": [],\n  \"tags\": [\n    \"project\",\n    \"vault-system\",\n    \"n8n\",\n    \"automation\",\n    \"llm\"\n  ],\n  \"priority_flag\": \"medium\",\n  \"_path\": \"50_Projects/Vault_System/Rounds/prj-n8n/Project_정의.md\",\n  \"_dir\": \"50_Projects/Vault_System/Rounds/prj-n8n\",\n  \"_body\": \"# n8n Vault 자동화\\n\\n> Project ID: `prj-n8n` | Program: `pgm-vault-system` | Status: active\\n\\n---\\n\\n## Project 목적\\n\\nn8n 워크플로우 엔진을 활용하여 LOOP Vault의 다양한 자동화 작업을 수행.\\n\\n---\\n\\n## 범위\\n\\n이 프로젝트에서 다루는 n8n 자동화 워크플로우:\\n\\n1. **Entity Auto-filler**: 빠진 필드 자동 추론 및 채우기\\n2. **Schema Validator**: 스키마 검증 자동화\\n3. **Notification**: 마감일 알림, 상태 변경 알림\\n4. **외부 연동**: (향후) 외부 서비스 연동\\n\\n---\\n\\n## 현재 워크플로우\\n\\n| 워크플로우 | 설명 | 상태 |\\n|-----------|------|------|\\n| Entity Validator/Autofiller | Task/Project 빠진 필드 LLM 추론 | 개발 중 |\\n| Impact Score Calculator | Project A/B Score 계산 | 계획 |\\n\\n---\\n\\n## 인프라\\n\\n- **n8n**: NAS Docker 배포 (port 5678)\\n- **LOOP API**: `https://mcp.sosilab.synology.me`\\n- **LLM**: OpenAI GPT-4\\n\\n---\\n\\n## Tasks\\n\\n| ID | Name | Status |\\n|----|------|--------|\\n| tsk-n8n-01 | n8n Docker 배포 파이프라인 | done |\\n| tsk-n8n-02 | 자동화 워크플로우 구축 | done |\\n| tsk-n8n-03 | Project Impact Score 자동화 | doing |\\n| tsk-n8n-04 | LLM 프롬프트 템플릿 개선 | todo |\\n| tsk-n8n-05 | API 비즈니스 로직 통합 | todo |\\n\\n---\\n\\n## 참고 문서\\n\\n- [[pgm-vault-system]] - 소속 Program\\n- [[trk-2]] - 소속 Track\\n- https://docs.n8n.io/ - n8n 공식 문서\\n\\n---\\n\\n**Created**: 2025-12-27\\n**Owner**: 김은향\"\n}\n```\n\n## 감지된 이슈\nmissing_validates, missing_primary_hypothesis_id, missing_condition_contributes\n\n---\n\n## 전략 컨텍스트\n\n### 3Y Conditions\n- cond-a: Condition_A_PMF\n- cond-b: Condition_B_Loop_Dataset\n- cond-c: Condition_C_Global_Data\n- cond-d: Condition_D_Runway\n- cond-e: Condition_E_Team\n\n### 12M Tracks\n- trk-1: Track_1_Product\n- trk-2: Track_2_Data\n- trk-3: Track_3_Content\n- trk-4: Track_4_Coaching\n- trk-5: Track_5_Partnership\n- trk-6: Track_6_Revenue\n\n### Hypotheses (최대 15개)\n- hyp-1-01: 천천히 먹기: 행동 변화\n- hyp-1-02: 지속사용\n- hyp-1-03: 행동 변화의 전환 연계\n- hyp-1-04: 효과 가시화가 결제를 올림\n- hyp-1-05: 앱 단독 vs 코칭 결합 효과\n- hyp-1-06: 세그먼트별 효과 차이\n- hyp-1-07: 온보딩이 이해→행동을 만든다\n- hyp-1-08: 유료 기능의 사용이 유지의 원인\n- hyp-1-09: 행동변화 지표 3종이 안정\n- hyp-1-10: 결제 전 가치 인지\n- hyp-1-11: 상품 메시지 2~3개로 수렴\n- hyp-2-01: 스키마 최소세트가 충분\n- hyp-2-02: 스키마 안정성\n- hyp-2-03: 데이터 누락률\n- hyp-2-04: 앱+코칭 데이터 결합 가능\n... (30 more)\n\n\n\n---\n\n## 요청\n\n위 Project의 누락된 필드를 제안해주세요.\n\n### 출력 형식 (JSON)\n\n{\n  \"suggested_fields\": {\n    \"owner\": \"김은향 또는 소상민\",\n    \"parent_id\": \"trk-N\",\n    \"conditions_3y\": [\"cond-X\"],\n    \"validates\": [\"hyp-X-XX\"],\n    \"primary_hypothesis_id\": \"hyp-X-XX\",\n    \"condition_contributes\": [\n      {\n        \"to\": \"cond-X\",\n        \"weight\": 0.0-1.0,\n        \"description\": \"기여 설명\"\n      }\n    ],\n    \"track_contributes\": [\n      {\n        \"to\": \"trk-N\",\n        \"weight\": 0.0-1.0,\n        \"description\": \"Secondary Track 기여 (선택사항)\"\n      }\n    ]\n  },\n  \"reasoning\": {\n    \"owner\": \"판단 근거\",\n    \"parent_id\": \"판단 근거\",\n    \"conditions_3y\": \"판단 근거\",\n    \"validates\": \"판단 근거\",\n    \"condition_contributes\": \"판단 근거\"\n  }\n}\n\n### 판단 기준\n\n**owner 선택:**\n- 김은향: 전략, 디자인, PM, 비즈니스 프로젝트\n- 소상민: 개발, 인프라, 기술 프로젝트\n\n**parent_id (Track) 선택:**\n- trk-1 ~ trk-6 중 프로젝트가 속하는 Track\n\n**conditions_3y 선택:**\n- cond-a: Product-Market Fit (제품-시장 적합성)\n- cond-b: Revenue Model (수익 모델)\n- cond-c: Scalability (확장성)\n- cond-d: Team (팀)\n- cond-e: Tech/Infrastructure (기술/인프라)\n\n**validates 선택 (선택사항):**\n- 이 프로젝트가 검증하려는 가설 ID 목록\n- 60_Hypotheses에서 관련 가설 선택\n- 가설이 없으면 빈 배열 []\n\n**primary_hypothesis_id 선택 (선택사항):**\n- validates 중 핵심 가설 1개\n- validates가 비어있으면 null\n\n**condition_contributes (필수):**\n- 각 Condition에 대한 기여도 (weight 합계 ≤ 1.0)\n- 최소 1개 이상의 Condition에 기여\n\n**track_contributes (선택):**\n- parent_id 외 추가 Track에 대한 기여\n- 없으면 빈 배열 []\n\n**⚠️ 금지 사항:**\n- validated_by 필드는 제안하지 마세요 (derived 필드)\n- realized_sum 필드는 제안하지 마세요 (derived 필드)\n- expected_impact, realized_impact는 이 엔드포인트에서 다루지 않음\n\nJSON만 반환하세요. Markdown 코드블록을 사용하지 마세요.",
  "system_prompt": "당신은 LOOP Vault Project 스키마 전문가입니다.\n\n## 역할\n- Project 엔티티의 누락된 필드를 제안합니다\n- 전략 컨텍스트(Track, Condition, Hypothesis)를 참조하여 적절한 값을 추론합니다\n- 모든 제안에 근거를 함께 제시합니다\n\n## 제약 (CRITICAL)\n1. **derived 필드 제안 금지**\n   - validated_by: Evidence에서 역인덱스 계산\n   - realized_sum: 하위 Project B 집계로 계산\n2. **enum 값은 정해진 목록에서만 선택**\n   - status: planning, active, paused, done, cancelled\n   - priority_flag: critical, high, medium, low\n3. **owner는 정해진 목록에서만 선택**: 김은향, 소상민\n4. **parent_id는 Track ID만 가능**: trk-1 ~ trk-6\n5. **conditions_3y는 1개 이상 필수**: cond-a ~ cond-e\n\n## Impact 관련 필드\n- expected_impact, realized_impact는 이 엔드포인트에서 다루지 않음\n- /api/ai/infer/project_impact, /api/ai/infer/evidence 사용\n\n## 출력 형식\n반드시 JSON 형식으로 출력하세요. Markdown 코드블록 없이 순수 JSON만 반환합니다.",
  "response": {
    "success": false,
    "content": null,
    "error": "OpenAI client not initialized. Check OPENAI_API_KEY."
  },
  "entity_context": {
    "entity_id": "prj-n8n",
    "entity_type": "Project",
    "action": "infer_project_schema"
  },
  "duration_ms": 0
}