# v0.1 ë™ê²° ì´ˆì•ˆ (Freeze Spec)

> **ëª©ì **: ì™„ë²½í•œ ì´í•´ê°€ ì•„ë‹Œ, **ë˜ëŒë¦´ ìˆ˜ ì—†ëŠ” ìµœì†Œ ê³ ì •**
>
> "ì´ ì •ë„ë©´ í‹€ë¦¬ë”ë¼ë„ ê³ ì¹  ìˆ˜ ìˆë‹¤" â€” ì´ ìƒíƒœê°€ ë™ê²°ì˜ ì˜¬ë°”ë¥¸ ìƒíƒœ

---

## 1. ì½”ì–´ 5ê°œ ì—”í‹°í‹° ì •ì˜

### ê°œìš” í…Œì´ë¸”

| ì—”í‹°í‹° | í•œì¤„ ì˜ë¯¸ | ID í•„ë“œëª… | í•„ìˆ˜ ì°¸ì¡° |
|--------|----------|----------|----------|
| **Event** | ì›ìì  ì‚¬ì‹¤ (ê´€ì°° ë°ì´í„°) | `eventId` | `episodeId` (0..1) |
| **Episode** | ë£¨í”„ ë‹¨ìœ„ ì»¨í…Œì´ë„ˆ | `episodeId` | ì—†ìŒ (ìµœìƒìœ„) |
| **LoopStateWindow** | ì‹œê°„ ìœˆë„ìš°ë³„ ìƒíƒœ ë²¡í„° | `stateWindowId` | `episodeId` (1) |
| **ActionExecution** | ê°œì… ì‹¤í–‰ íŠ¸ëœì­ì…˜ | `actionExecutionId` | `episodeId` (1) |
| **OutcomeMeasurement** | ê°œì… ê²°ê³¼ ì¸¡ì • | `outcomeId` | `actionExecutionId` (1) |

---

### 1.1 Event (ì›ì ì‚¬ì‹¤)

**ì˜ë¯¸**: ê´€ì°° ê¸°ë°˜ "ì›ìì  ì‚¬ì‹¤(fact)". ë‹¨ë…ìœ¼ë¡œëŠ” ìƒê´€ê´€ê³„ê¹Œì§€ë§Œ, ì¸ê³¼ëŠ” ì•„ë‹˜.

```
ì¸ê³¼ êµ¬ì¡°ì—ì„œì˜ ì—­í• : ì¸ê³¼ ì¬ë£Œ (Causal Material)
```

**ID ê·œì¹™**:
- ID í•„ë“œëª…: `eventId`
- í˜•ì‹: `event_{uuid}` ë˜ëŠ” ì‹œìŠ¤í…œë³„ ê³ ìœ  ID
- ë¶ˆë³€: ìƒì„± í›„ ë³€ê²½ ë¶ˆê°€

**ì°¸ì¡° ê·œì¹™**:
- `episodeId`: **0ê°œ ë˜ëŠ” 1ê°œ** í—ˆìš©
  - ì—†ìœ¼ë©´ â†’ "ë¯¸ë¶„ë¥˜ ì´ë²¤íŠ¸" (ë‚˜ì¤‘ì— Episodeì— í• ë‹¹ ê°€ëŠ¥)
  - ìˆìœ¼ë©´ â†’ í•´ë‹¹ Episodeì— ì†í•¨

**ì˜ˆì‹œ eventType**:
```
meal, satiety_check, emotion_tag, urge, binge,
sleep, pms, social, context_change
```

---

### 1.2 Episode (LoopInstance)

**ì˜ë¯¸**: "í•œ ë²ˆì˜ ë£¨í”„ ë‹¨ìœ„"ë¥¼ ë‹´ëŠ” ìƒìœ„ ì»¨í…Œì´ë„ˆ. 2-4ì‹œê°„ ìœ„í—˜ êµ¬ê°„, í­ì‹ ì „í›„ êµ¬ê°„, í•˜ë£¨ ì €ë… ë£¨í‹´ ë¸”ë¡ ë“±.

```
ì¸ê³¼ êµ¬ì¡°ì—ì„œì˜ ì—­í• : ê·¸ë£¹í•‘ ì»¨í…Œì´ë„ˆ (Grouping Container)
```

**ID ê·œì¹™**:
- ID í•„ë“œëª…: `episodeId`
- í˜•ì‹: `episode_{uuid}` ë˜ëŠ” ì‹œìŠ¤í…œë³„ ê³ ìœ  ID
- ë¶ˆë³€: ìƒì„± í›„ ë³€ê²½ ë¶ˆê°€

**ì°¸ì¡° ê·œì¹™**:
- ì°¸ì¡°í•˜ëŠ” ìƒìœ„ ì—”í‹°í‹° ì—†ìŒ (ìµœìƒìœ„ ì»¨í…Œì´ë„ˆ)
- Event, LoopStateWindow, ActionExecutionì´ ì´ Episodeë¥¼ ì°¸ì¡°

**ì˜ˆì‹œ episodeType**:
```
risk_window, meal_episode, binge_episode, daily_block
```

---

### 1.3 LoopStateWindow (ìƒíƒœ ë²¡í„° ìœˆë„ìš°)

**ì˜ë¯¸**: 30-60ë¶„(ë˜ëŠ” micro/meso/macro) ë‹¨ìœ„ì˜ "ìƒíƒœ ë²¡í„°" ê¸°ë¡. 5ëŒ€ ë£¨í”„ ìƒíƒœë¥¼ ë‹´ëŠ” êµ¬ì¡°í™”ëœ ìŠ¤ëƒ…ìƒ·.

```
ì¸ê³¼ êµ¬ì¡°ì—ì„œì˜ ì—­í• : ìƒíƒœ ê´€ì°° (State Observation)
```

**ID ê·œì¹™**:
- ID í•„ë“œëª…: `stateWindowId`
- í˜•ì‹: `window_{uuid}` ë˜ëŠ” ì‹œìŠ¤í…œë³„ ê³ ìœ  ID
- ë¶ˆë³€: ìƒì„± í›„ ë³€ê²½ ë¶ˆê°€

**ì°¸ì¡° ê·œì¹™**:
- `episodeId`: **ë°˜ë“œì‹œ 1ê°œ** í•„ìˆ˜
  - ëª¨ë“  LoopStateWindowëŠ” íŠ¹ì • Episodeì— ì†í•´ì•¼ í•¨

**stateVector êµ¬ì¡°** (5ëŒ€ ë£¨í”„):
```
emotional_state: valence, anxiety, emptiness ë“±
eating_state: hunger, fullness, mealRegularity ë“±
habit_state: contextTrigger, automaticity ë“±
reward_state: cravingLevel, highRewardExposure ë“±
nervous_state: arousal, shutdown ë“±
```

---

### 1.4 ActionExecution (ê°œì… ì‹¤í–‰ íŠ¸ëœì­ì…˜)

**ì˜ë¯¸**: ì½”ì¹˜/ì‹œìŠ¤í…œ/ì‚¬ìš©ìê°€ ì‹¤ì œë¡œ ì‹¤í–‰í•œ ë³€í™”(ì¤‘ì¬). ì¸ê³¼ì˜ "ìŠ¤ìœ„ì¹˜" ì—­í• .

```
ì¸ê³¼ êµ¬ì¡°ì—ì„œì˜ ì—­í• : ì¸ê³¼ ìŠ¤ìœ„ì¹˜ (Causal Switch)
```

**ID ê·œì¹™**:
- ID í•„ë“œëª…: `actionExecutionId`
- í˜•ì‹: `action_{uuid}` ë˜ëŠ” ì‹œìŠ¤í…œë³„ ê³ ìœ  ID
- ë¶ˆë³€: ìƒì„± í›„ ë³€ê²½ ë¶ˆê°€

**ì°¸ì¡° ê·œì¹™**:
- `episodeId`: **ë°˜ë“œì‹œ 1ê°œ** í•„ìˆ˜
  - ëª¨ë“  ActionExecutionì€ íŠ¹ì • Episode ë§¥ë½ì—ì„œ ì‹¤í–‰ë¨

**í•„ìˆ˜ ì†ì„±**:
```
actor: user | coach | system
parameters: ê°œì… íŒŒë¼ë¯¸í„° (duration, intensity ë“±)
startTime, endTime: ì‹¤í–‰ ì‹œê°„ ë²”ìœ„
target: targetLoopTypes[] ë˜ëŠ” targetEventType
adherence: performed | partial | skipped (+ optional score)
```

---

### 1.5 OutcomeMeasurement (ê²°ê³¼ ì¸¡ì •)

**ì˜ë¯¸**: ActionExecution ì´í›„ "ìœˆë„ìš° ê¸°ë°˜ìœ¼ë¡œ" ì¸¡ì •í•œ ê²°ê³¼ ê¸°ë¡. ì¸ê³¼ì˜ "ì¦ê±°".

```
ì¸ê³¼ êµ¬ì¡°ì—ì„œì˜ ì—­í• : ì¸ê³¼ ì¦ê±° (Causal Evidence)
```

**ID ê·œì¹™**:
- ID í•„ë“œëª…: `outcomeId`
- í˜•ì‹: `outcome_{uuid}` ë˜ëŠ” ì‹œìŠ¤í…œë³„ ê³ ìœ  ID
- ë¶ˆë³€: ìƒì„± í›„ ë³€ê²½ ë¶ˆê°€

**ì°¸ì¡° ê·œì¹™**:
- `actionExecutionId`: **ë°˜ë“œì‹œ 1ê°œ** í•„ìˆ˜
  - ëª¨ë“  OutcomeMeasurementëŠ” íŠ¹ì • ActionExecutionì˜ ê²°ê³¼ë¡œ ì¡´ì¬

**í•„ìˆ˜ window ê°’**:
```
next_2h: 2ì‹œê°„ ë‚´ ì¸¡ì •
next_meal: ë‹¤ìŒ ì‹ì‚¬ê¹Œì§€
today: ë‹¹ì¼ ë‚´
next_7d: 7ì¼ ë‚´
```

---

## 2. v0.1ì—ì„œ ì ˆëŒ€ ë°”ê¾¸ì§€ ì•Šì„ ê²ƒ (Immutable List)

### ğŸ”’ Type System (Rule A)

| í•­ëª© | ê³ ì • ë‚´ìš© | ê¸ˆì§€ ì‚¬í•­ |
|------|----------|----------|
| ì½”ì–´ íƒ€ì… ê°œìˆ˜ | 5ê°œ | ì‚­ì œ ë¶ˆê°€, ì˜ë¯¸ ë³€ê²½ ë¶ˆê°€ |
| íƒ€ì…ëª… | Event, Episode, LoopStateWindow, ActionExecution, OutcomeMeasurement | ì´ë¦„ ë³€ê²½ ë¶ˆê°€ |
| íƒ€ì… ê²½ê³„ | Type(ìŠ¤í‚¤ë§ˆ)ì™€ Instance(ê¸°ë¡) ë¶„ë¦¬ | í˜¼ìš© ë¶ˆê°€ |

### ğŸ”’ ID & Reference (Rule B)

| í•­ëª© | ê³ ì • ë‚´ìš© | ê¸ˆì§€ ì‚¬í•­ |
|------|----------|----------|
| ID í•„ë“œëª… | eventId, episodeId, stateWindowId, actionExecutionId, outcomeId | í•„ë“œëª… ë³€ê²½ ë¶ˆê°€ |
| ID ë¶ˆë³€ì„± | ìƒì„± í›„ ë³€ê²½ ë¶ˆê°€ | ID ì¬í• ë‹¹ ë¶ˆê°€ |
| Reference êµ¬ì¡° | episodeId, actionExecutionId ì°¸ì¡° ë°©ì‹ | ì°¸ì¡° ë°©í–¥ ë³€ê²½ ë¶ˆê°€ |
| Reference ì˜ë¯¸ | Eventâ†’Episode(0..1), ë‚˜ë¨¸ì§€â†’í•„ìˆ˜(1) | ì¹´ë””ë„ë¦¬í‹° ë³€ê²½ ë¶ˆê°€ |

### ğŸ”’ ê³µí†µ í•„ë“œ (All Entities)

```
id          # ê³ ìœ  ì‹ë³„ì (ë¶ˆë³€)
userId      # ì‚¬ìš©ì ID
createdAt   # ìƒì„± ì‹œê°
updatedAt   # ìˆ˜ì • ì‹œê°
source      # app | coach | system | import
specVersion # ì˜ˆ: "0.1"
```

**ìœ„ 6ê°œ í•„ë“œëŠ” ëª¨ë“  ì½”ì–´ ì—”í‹°í‹°ì— í•„ìˆ˜ì´ë©°, ì‚­ì œ/ì´ë¦„ë³€ê²½ ë¶ˆê°€**

### ğŸ”’ ì¸ê³¼ êµ¬ì¡° (Rule C)

| í•­ëª© | ê³ ì • ë‚´ìš© |
|------|----------|
| ActionExecution = íŠ¸ëœì­ì…˜ | ì¶”ì²œì´ ì•„ë‹Œ "ì‹¤í–‰ ê¸°ë¡" |
| OutcomeMeasurement = window í•„ìˆ˜ | ë°˜ë“œì‹œ ì¸¡ì • ìœˆë„ìš° í¬í•¨ |
| ì¸ê³¼ ì²´ì¸ | Event(ì¬ë£Œ) â†’ Action(ìŠ¤ìœ„ì¹˜) â†’ Outcome(ì¦ê±°) |

### ğŸ”’ ë²„ì „ ê·œì¹™ (Rule D)

| í•­ëª© | ê³ ì • ë‚´ìš© |
|------|----------|
| specVersion í•„ìˆ˜ | ëª¨ë“  ì—”í‹°í‹°ì— ë°˜ë“œì‹œ í¬í•¨ |
| í•˜ìœ„ í˜¸í™˜ì„± | v0.2+ì—ì„œ v0.1 ì˜ë¯¸ë¥¼ ê¹¨ë©´ ì•ˆ ë¨ |

---

## 3. v0.2ì—ì„œ ìŠ¹ê²©í•  ê²ƒ (Promotion Candidates)

### ğŸ“ˆ í™•ì • ìŠ¹ê²© í›„ë³´

| í•­ëª© | í˜„ì¬ (v0.1) | ìŠ¹ê²© í›„ (v0.2+) | ì´ìœ  |
|------|------------|----------------|------|
| **ActionType** | `actionName` (string) | ActionType Registry | í”„ë¡œí† ì½œ ë²„ì „, ì œì•½ì¡°ê±´, side effects ê´€ë¦¬ í•„ìš” |
| **MetricType** | `metricName` (string) | Metric Registry | ê³„ì‚°ì‹, ìœˆë„ìš° ì •ì˜, ì •ê·œí™” ê·œì¹™ í•„ìš” |
| **LinkType** | Reference í•„ë“œ (episodeId ë“±) | Link 1ê¸‰ ì—”í‹°í‹° | ê´€ê³„ ë©”íƒ€ë°ì´í„° (ì–¸ì œ, ì™œ, ëˆ„ê°€) í•„ìš” ì‹œ |

### ğŸ“ˆ ì¡°ê±´ë¶€ ìŠ¹ê²© í›„ë³´ (B2B ë‹¨ê³„)

| í•­ëª© | í˜„ì¬ (v0.1) | ìŠ¹ê²© í›„ | íŠ¸ë¦¬ê±° ì¡°ê±´ |
|------|------------|--------|------------|
| **Governance** | ì—†ìŒ | ìƒíƒœ ê´€ë¦¬ (active/experimental/deprecated) | ë‹¤ì¤‘ íŒ€ í˜‘ì—… ì‹œ |
| **Permission** | ì—†ìŒ | ì½ê¸°/ì“°ê¸°/ìŠ¹ì¸ ê¶Œí•œ ì²´ê³„ | ì—”í„°í”„ë¼ì´ì¦ˆ ê³ ê° ìš”ì²­ ì‹œ |
| **Audit Log** | ì—†ìŒ | ë³€ê²½ ì´ë ¥/ê°ì‚¬ ì›Œí¬í”Œë¡œìš° | ê·œì œ ì¤€ìˆ˜ í•„ìš” ì‹œ |

### ğŸ“ˆ ìŠ¹ê²© ê²½ë¡œ ìš”ì•½

```
v0.1 (í˜„ì¬)
  â””â”€ Reference (episodeId, actionExecutionId)
  â””â”€ actionName (string)
  â””â”€ metricName (string)

v0.2 (ìŠ¹ê²©)
  â””â”€ Reference â†’ LinkType/Link ì—”í‹°í‹°
  â””â”€ actionName â†’ ActionType Registry + rule-set
  â””â”€ metricName â†’ Metric Registry + computation def

v0.3+ (ê±°ë²„ë„ŒìŠ¤)
  â””â”€ Governance workflow
  â””â”€ Permission system
  â””â”€ Audit trail
```

---

## 4. ì°¸ì¡° ê·œì¹™ ë‹¤ì´ì–´ê·¸ë¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Episode (ìµœìƒìœ„)                         â”‚
â”‚                      episodeId: ep_001                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚              â”‚              â”‚
               â–¼              â–¼              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Event        â”‚  â”‚LoopState     â”‚  â”‚ ActionExecution    â”‚
â”‚ episodeId: ep_001â”‚  â”‚Window        â”‚  â”‚ episodeId: ep_001  â”‚
â”‚ (0..1, optional) â”‚  â”‚episodeId:    â”‚  â”‚ (1, í•„ìˆ˜)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ep_001        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚(1, í•„ìˆ˜)     â”‚            â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â–¼
                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                        â”‚OutcomeMeasurement  â”‚
                                        â”‚actionExecutionId:  â”‚
                                        â”‚act_001             â”‚
                                        â”‚(1, í•„ìˆ˜)           â”‚
                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ì°¸ì¡° ì¹´ë””ë„ë¦¬í‹° ì •ë¦¬**:
- Event â†’ Episode: **0..1** (ë¯¸ë¶„ë¥˜ í—ˆìš©)
- LoopStateWindow â†’ Episode: **1** (í•„ìˆ˜)
- ActionExecution â†’ Episode: **1** (í•„ìˆ˜)
- OutcomeMeasurement â†’ ActionExecution: **1** (í•„ìˆ˜)

---

## 5. v0.1 ì„±ê³µ ê¸°ì¤€ (ìµœì†Œ ì¡°ê±´)

> **ActionExecution 1ê±´ë§ˆë‹¤ OutcomeMeasurementê°€ window í¬í•¨ í˜•íƒœë¡œ ë¶™ëŠ” ê²ƒ**

ì´ê²ƒì´ v0.1ì˜ ìœ ì¼í•œ ì„±ê³µ ê¸°ì¤€ì´ë‹¤.

### ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] ActionExecution ìƒì„± ì‹œ episodeId í•„ìˆ˜ í™•ì¸
- [ ] ActionExecutionì— actor, parameters, target, adherence ê¸°ë¡
- [ ] OutcomeMeasurement ìƒì„± ì‹œ actionExecutionId í•„ìˆ˜ í™•ì¸
- [ ] OutcomeMeasurementì— window (next_2h/next_meal/today/next_7d) ê¸°ë¡
- [ ] ëª¨ë“  ì—”í‹°í‹°ì— specVersion: "0.1" ê¸°ë¡

---

## 6. ë™ê²° ì„ ì–¸

> **v0.1 ë™ê²°ì¼**: 2024-XX-XX (ì‹¤ì œ ë™ê²° ì‹œ ë‚ ì§œ ê¸°ì…)
>
> **ë™ê²° ë²”ìœ„**:
> - 5ê°œ ì½”ì–´ íƒ€ì…
> - ID/Reference ê·œì¹™
> - ê³µí†µ í•„ë“œ 6ê°œ
> - ì¸ê³¼ êµ¬ì¡° (Event-Action-Outcome)
>
> **í—ˆìš© ë³€ê²½**:
> - ìƒˆ í•„ë“œ ì¶”ê°€ (ê¸°ì¡´ ì˜ë¯¸ ìœ ì§€)
> - payload ë‚´ë¶€ êµ¬ì¡° í™•ì¥
> - ì„ íƒì  í•„ë“œ ì¶”ê°€
>
> **ê¸ˆì§€ ë³€ê²½**:
> - ì½”ì–´ íƒ€ì… ì‚­ì œ/ì´ë¦„ë³€ê²½
> - ID í•„ë“œëª… ë³€ê²½
> - Reference ì¹´ë””ë„ë¦¬í‹° ë³€ê²½
> - ê³µí†µ í•„ë“œ ì‚­ì œ
> - ì¸ê³¼ êµ¬ì¡° íŒŒê´´

---

## ê´€ë ¨ ë¬¸ì„œ

- [[Ontology-lite v0.1 (ILOS) â€” ê·œì¹™(4ì¡°ê±´) + ìµœì†Œ ì—”í‹°í‹° ìŠ¤í™]]
- [[Inner Loop OS ì •ì˜v1]]
- [[Event vs Episode vs LoopStateWindow ë¹„êµ (ì‹¤ì œ ë°ì´í„° ê¸°ë°˜)]]

---

#ontology/schema #version/v0-1 #status/active